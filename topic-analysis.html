<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.6 Topic analysis | Declaring and Diagnosing Research Designs</title>
  <meta name="description" content="describe the book" />
  <meta name="generator" content="bookdown  and GitBook 2.6.7" />

  <meta property="og:title" content="4.6 Topic analysis | Declaring and Diagnosing Research Designs" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="describe the book" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.6 Topic analysis | Declaring and Diagnosing Research Designs" />
  
  <meta name="twitter:description" content="describe the book" />
  

<meta name="author" content="Graeme Blair, Jasper Cooper, Alexander Coppock, and Macartan Humphreys" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="measuring-latent-variables.html">
<link rel="next" href="multilevel-regression-and-poststratification.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="https://hypothes.is/embed.js" async></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="headers/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Declaring and Diagnosing Research Designs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="part"><span><b>I Declaring and Diagnosing Research Designs</b></span></li>
<li class="chapter" data-level="2" data-path="what-is-a-design.html"><a href="what-is-a-design.html"><i class="fa fa-check"></i><b>2</b> What is a Design?</a><ul>
<li class="chapter" data-level="2.1" data-path="elements-of-a-research-design.html"><a href="elements-of-a-research-design.html"><i class="fa fa-check"></i><b>2.1</b> Elements of a Research Design</a></li>
<li class="chapter" data-level="2.2" data-path="using-diagnosands-to-evaluate-a-design.html"><a href="using-diagnosands-to-evaluate-a-design.html"><i class="fa fa-check"></i><b>2.2</b> Using diagnosands to evaluate a design</a></li>
<li class="chapter" data-level="2.3" data-path="what-is-a-complete-design-declaration.html"><a href="what-is-a-complete-design-declaration.html"><i class="fa fa-check"></i><b>2.3</b> What is a <em>Complete</em> Design Declaration?</a></li>
<li class="chapter" data-level="2.4" data-path="designs-as-concatenations-of-steps.html"><a href="designs-as-concatenations-of-steps.html"><i class="fa fa-check"></i><b>2.4</b> Designs as concatenations of steps</a></li>
<li class="chapter" data-level="2.5" data-path="designs-as-strategies.html"><a href="designs-as-strategies.html"><i class="fa fa-check"></i><b>2.5</b> Designs as <em>strategies</em></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="model-inquiry-data-strategy-answer-strategy.html"><a href="model-inquiry-data-strategy-answer-strategy.html"><i class="fa fa-check"></i><b>3</b> Model-Inquiry-Data-Strategy-Answer Strategy</a><ul>
<li class="chapter" data-level="3.1" data-path="model-steps.html"><a href="model-steps.html"><i class="fa fa-check"></i><b>3.1</b> Model steps</a><ul>
<li class="chapter" data-level="3.1.1" data-path="model-steps.html"><a href="model-steps.html#simple-data"><i class="fa fa-check"></i><b>3.1.1</b> Simple data</a></li>
<li class="chapter" data-level="3.1.2" data-path="model-steps.html"><a href="model-steps.html#hierarchical-data"><i class="fa fa-check"></i><b>3.1.2</b> Hierarchical data</a></li>
<li class="chapter" data-level="3.1.3" data-path="model-steps.html"><a href="model-steps.html#time-series-data"><i class="fa fa-check"></i><b>3.1.3</b> Time series data</a></li>
<li class="chapter" data-level="3.1.4" data-path="model-steps.html"><a href="model-steps.html#panel-data"><i class="fa fa-check"></i><b>3.1.4</b> Panel data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="inquiry-steps.html"><a href="inquiry-steps.html"><i class="fa fa-check"></i><b>3.2</b> Inquiry steps</a><ul>
<li class="chapter" data-level="3.2.1" data-path="inquiry-steps.html"><a href="inquiry-steps.html#potential-outcomes-metadata"><i class="fa fa-check"></i><b>3.2.1</b> Potential outcomes metadata</a></li>
<li class="chapter" data-level="3.2.2" data-path="inquiry-steps.html"><a href="inquiry-steps.html#potential-outcomes-functions"><i class="fa fa-check"></i><b>3.2.2</b> Potential outcomes functions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-steps.html"><a href="data-steps.html"><i class="fa fa-check"></i><b>3.3</b> Data steps</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data-steps.html"><a href="data-steps.html#simple-random-sampling"><i class="fa fa-check"></i><b>3.3.1</b> Simple random sampling</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-steps.html"><a href="data-steps.html#stratified-clustered-random-sampling"><i class="fa fa-check"></i><b>3.3.2</b> Stratified, clustered random sampling</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-steps.html"><a href="data-steps.html#arbitrary-sampling"><i class="fa fa-check"></i><b>3.3.3</b> Arbitrary sampling</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-steps.html"><a href="data-steps.html#simple-assignments"><i class="fa fa-check"></i><b>3.3.4</b> Simple assignments</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-steps.html"><a href="data-steps.html#block-clustered-assignments"><i class="fa fa-check"></i><b>3.3.5</b> Block clustered assignments</a></li>
<li class="chapter" data-level="3.3.6" data-path="data-steps.html"><a href="data-steps.html#randomization-workflow"><i class="fa fa-check"></i><b>3.3.6</b> Randomization workflow</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="answer-steps.html"><a href="answer-steps.html"><i class="fa fa-check"></i><b>3.4</b> Answer steps</a></li>
<li class="chapter" data-level="3.5" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html"><i class="fa fa-check"></i><b>3.5</b> Putting it all together</a></li>
<li class="chapter" data-level="3.6" data-path="diagnsosis.html"><a href="diagnsosis.html"><i class="fa fa-check"></i><b>3.6</b> Diagnsosis</a><ul>
<li class="chapter" data-level="3.6.1" data-path="diagnsosis.html"><a href="diagnsosis.html#standard-diagnosands"><i class="fa fa-check"></i><b>3.6.1</b> Standard diagnosands</a></li>
<li class="chapter" data-level="3.6.2" data-path="diagnsosis.html"><a href="diagnsosis.html#custom-diagnosands"><i class="fa fa-check"></i><b>3.6.2</b> Custom diagnosands</a></li>
<li class="chapter" data-level="3.6.3" data-path="diagnsosis.html"><a href="diagnsosis.html#is-a-diagnosand-part-of-a-design"><i class="fa fa-check"></i><b>3.6.3</b> Is a diagnosand part of a design?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Design Library</b></span></li>
<li class="chapter" data-level="4" data-path="observational-designs-for-descriptive-inference.html"><a href="observational-designs-for-descriptive-inference.html"><i class="fa fa-check"></i><b>4</b> Observational Designs for Descriptive Inference</a><ul>
<li class="chapter" data-level="4.1" data-path="simple-random-sampling-1.html"><a href="simple-random-sampling-1.html"><i class="fa fa-check"></i><b>4.1</b> Simple Random Sampling</a><ul>
<li class="chapter" data-level="4.1.1" data-path="simple-random-sampling-1.html"><a href="simple-random-sampling-1.html#design-declaration"><i class="fa fa-check"></i><b>4.1.1</b> Design Declaration</a></li>
<li class="chapter" data-level="4.1.2" data-path="simple-random-sampling-1.html"><a href="simple-random-sampling-1.html#takeaways"><i class="fa fa-check"></i><b>4.1.2</b> Takeaways</a></li>
<li class="chapter" data-level="4.1.3" data-path="simple-random-sampling-1.html"><a href="simple-random-sampling-1.html#exercises"><i class="fa fa-check"></i><b>4.1.3</b> Exercises</a></li>
<li class="chapter" data-level="4.1.4" data-path="simple-random-sampling-1.html"><a href="simple-random-sampling-1.html#design-inspector"><i class="fa fa-check"></i><b>4.1.4</b> Design Inspector</a></li>
<li class="chapter" data-level="4.1.5" data-path="simple-random-sampling-1.html"><a href="simple-random-sampling-1.html#references"><i class="fa fa-check"></i><b>4.1.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="stratified-clustered-random-sampling-1.html"><a href="stratified-clustered-random-sampling-1.html"><i class="fa fa-check"></i><b>4.2</b> Stratified clustered random sampling</a><ul>
<li class="chapter" data-level="4.2.1" data-path="stratified-clustered-random-sampling-1.html"><a href="stratified-clustered-random-sampling-1.html#design-declaration-1"><i class="fa fa-check"></i><b>4.2.1</b> Design Declaration</a></li>
<li class="chapter" data-level="4.2.2" data-path="stratified-clustered-random-sampling-1.html"><a href="stratified-clustered-random-sampling-1.html#takeaways-1"><i class="fa fa-check"></i><b>4.2.2</b> Takeaways</a></li>
<li class="chapter" data-level="4.2.3" data-path="stratified-clustered-random-sampling-1.html"><a href="stratified-clustered-random-sampling-1.html#references-1"><i class="fa fa-check"></i><b>4.2.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="respondent-driven-sampling.html"><a href="respondent-driven-sampling.html"><i class="fa fa-check"></i><b>4.3</b> Respondent driven sampling</a></li>
<li class="chapter" data-level="4.4" data-path="sample-re-sample.html"><a href="sample-re-sample.html"><i class="fa fa-check"></i><b>4.4</b> Sample re-sample</a></li>
<li class="chapter" data-level="4.5" data-path="measuring-latent-variables.html"><a href="measuring-latent-variables.html"><i class="fa fa-check"></i><b>4.5</b> Measuring latent variables</a></li>
<li class="chapter" data-level="4.6" data-path="topic-analysis.html"><a href="topic-analysis.html"><i class="fa fa-check"></i><b>4.6</b> Topic analysis</a><ul>
<li class="chapter" data-level="4.6.1" data-path="topic-analysis.html"><a href="topic-analysis.html#references-2"><i class="fa fa-check"></i><b>4.6.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="multilevel-regression-and-poststratification.html"><a href="multilevel-regression-and-poststratification.html"><i class="fa fa-check"></i><b>4.7</b> Multilevel regression and poststratification</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="experimental-designs-for-descriptive-inference.html"><a href="experimental-designs-for-descriptive-inference.html"><i class="fa fa-check"></i><b>5</b> Experimental Designs for Descriptive Inference</a><ul>
<li class="chapter" data-level="5.1" data-path="audit-experiments.html"><a href="audit-experiments.html"><i class="fa fa-check"></i><b>5.1</b> Audit experiments</a></li>
<li class="chapter" data-level="5.2" data-path="experiments-for-sensitive-questions.html"><a href="experiments-for-sensitive-questions.html"><i class="fa fa-check"></i><b>5.2</b> Experiments for sensitive questions</a><ul>
<li class="chapter" data-level="5.2.1" data-path="experiments-for-sensitive-questions.html"><a href="experiments-for-sensitive-questions.html#list-experiments"><i class="fa fa-check"></i><b>5.2.1</b> List experiments</a></li>
<li class="chapter" data-level="5.2.2" data-path="experiments-for-sensitive-questions.html"><a href="experiments-for-sensitive-questions.html#randomized-response-technique"><i class="fa fa-check"></i><b>5.2.2</b> Randomized response technique</a></li>
<li class="chapter" data-level="5.2.3" data-path="experiments-for-sensitive-questions.html"><a href="experiments-for-sensitive-questions.html#references-3"><i class="fa fa-check"></i><b>5.2.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="conjoint-experiments.html"><a href="conjoint-experiments.html"><i class="fa fa-check"></i><b>5.3</b> Conjoint experiments</a></li>
<li class="chapter" data-level="5.4" data-path="experimental-games.html"><a href="experimental-games.html"><i class="fa fa-check"></i><b>5.4</b> Experimental games</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="observational-designs-for-causal-inference.html"><a href="observational-designs-for-causal-inference.html"><i class="fa fa-check"></i><b>6</b> Observational Designs for causal inference</a><ul>
<li class="chapter" data-level="6.1" data-path="difference-in-differences.html"><a href="difference-in-differences.html"><i class="fa fa-check"></i><b>6.1</b> Difference in differences</a></li>
<li class="chapter" data-level="6.2" data-path="matching.html"><a href="matching.html"><i class="fa fa-check"></i><b>6.2</b> Matching</a></li>
<li class="chapter" data-level="6.3" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html"><i class="fa fa-check"></i><b>6.3</b> Regression Discontinuity</a><ul>
<li class="chapter" data-level="6.3.1" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#design-declaration-2"><i class="fa fa-check"></i><b>6.3.1</b> Design Declaration</a></li>
<li class="chapter" data-level="6.3.2" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#takeaways-2"><i class="fa fa-check"></i><b>6.3.2</b> Takeaways</a></li>
<li class="chapter" data-level="6.3.3" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#further-reading"><i class="fa fa-check"></i><b>6.3.3</b> Further Reading</a></li>
<li class="chapter" data-level="6.3.4" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#exercises-1"><i class="fa fa-check"></i><b>6.3.4</b> Exercises</a></li>
<li class="chapter" data-level="6.3.5" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#references-4"><i class="fa fa-check"></i><b>6.3.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="synthetic-controls.html"><a href="synthetic-controls.html"><i class="fa fa-check"></i><b>6.4</b> Synthetic controls</a><ul>
<li class="chapter" data-level="6.4.1" data-path="synthetic-controls.html"><a href="synthetic-controls.html#references-5"><i class="fa fa-check"></i><b>6.4.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="cross-national-time-series.html"><a href="cross-national-time-series.html"><i class="fa fa-check"></i><b>6.5</b> Cross national time series</a></li>
<li class="chapter" data-level="6.6" data-path="qualtitative-comparative-analysis.html"><a href="qualtitative-comparative-analysis.html"><i class="fa fa-check"></i><b>6.6</b> Qualtitative Comparative Analysis</a></li>
<li class="chapter" data-level="6.7" data-path="process-tracing.html"><a href="process-tracing.html"><i class="fa fa-check"></i><b>6.7</b> Process tracing</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="experimental-designs-for-causal-inference.html"><a href="experimental-designs-for-causal-inference.html"><i class="fa fa-check"></i><b>7</b> Experimental Designs for Causal Inference</a><ul>
<li class="chapter" data-level="7.1" data-path="multiarm-designs.html"><a href="multiarm-designs.html"><i class="fa fa-check"></i><b>7.1</b> Multiarm designs</a></li>
<li class="chapter" data-level="7.2" data-path="experiments-with-blocks-and-clusters.html"><a href="experiments-with-blocks-and-clusters.html"><i class="fa fa-check"></i><b>7.2</b> Experiments with blocks and clusters</a></li>
<li class="chapter" data-level="7.3" data-path="factorial-designs.html"><a href="factorial-designs.html"><i class="fa fa-check"></i><b>7.3</b> Factorial designs</a></li>
<li class="chapter" data-level="7.4" data-path="encouragement-designs.html"><a href="encouragement-designs.html"><i class="fa fa-check"></i><b>7.4</b> Encouragement designs</a><ul>
<li class="chapter" data-level="7.4.1" data-path="encouragement-designs.html"><a href="encouragement-designs.html#references-6"><i class="fa fa-check"></i><b>7.4.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="stepped-wedge-designs.html"><a href="stepped-wedge-designs.html"><i class="fa fa-check"></i><b>7.5</b> Stepped wedge designs</a></li>
<li class="chapter" data-level="7.6" data-path="crossover-designs.html"><a href="crossover-designs.html"><i class="fa fa-check"></i><b>7.6</b> Crossover designs</a></li>
<li class="chapter" data-level="7.7" data-path="parallel-design-for-mediation-effects.html"><a href="parallel-design-for-mediation-effects.html"><i class="fa fa-check"></i><b>7.7</b> Parallel design for mediation effects</a></li>
<li class="chapter" data-level="7.8" data-path="partial-population-design-for-spillover-analysis.html"><a href="partial-population-design-for-spillover-analysis.html"><i class="fa fa-check"></i><b>7.8</b> Partial population design for spillover analysis</a></li>
<li class="chapter" data-level="7.9" data-path="selective-trials.html"><a href="selective-trials.html"><i class="fa fa-check"></i><b>7.9</b> Selective trials</a></li>
<li class="chapter" data-level="7.10" data-path="adaptive-trials.html"><a href="adaptive-trials.html"><i class="fa fa-check"></i><b>7.10</b> Adaptive trials</a></li>
<li class="chapter" data-level="7.11" data-path="selective-trials-1.html"><a href="selective-trials-1.html"><i class="fa fa-check"></i><b>7.11</b> Selective trials</a><ul>
<li class="chapter" data-level="7.11.1" data-path="selective-trials-1.html"><a href="selective-trials-1.html#design-declaration-3"><i class="fa fa-check"></i><b>7.11.1</b> Design Declaration</a></li>
<li class="chapter" data-level="7.11.2" data-path="selective-trials-1.html"><a href="selective-trials-1.html#references-7"><i class="fa fa-check"></i><b>7.11.2</b> References</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Principles of Research Designs</b></span></li>
<li class="chapter" data-level="8" data-path="model-principles.html"><a href="model-principles.html"><i class="fa fa-check"></i><b>8</b> Model principles</a><ul>
<li class="chapter" data-level="8.1" data-path="generate-null-models.html"><a href="generate-null-models.html"><i class="fa fa-check"></i><b>8.1</b> Generate null models</a></li>
<li class="chapter" data-level="8.2" data-path="generality-makes-models-vulnerable.html"><a href="generality-makes-models-vulnerable.html"><i class="fa fa-check"></i><b>8.2</b> Generality makes models vulnerable</a></li>
<li class="chapter" data-level="8.3" data-path="specify-which-variables-are-manipulable.html"><a href="specify-which-variables-are-manipulable.html"><i class="fa fa-check"></i><b>8.3</b> Specify which variables are manipulable</a></li>
<li class="chapter" data-level="8.4" data-path="assign-over-vectors.html"><a href="assign-over-vectors.html"><i class="fa fa-check"></i><b>8.4</b> Assign over vectors</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="inquiry-principles.html"><a href="inquiry-principles.html"><i class="fa fa-check"></i><b>9</b> Inquiry principles</a><ul>
<li class="chapter" data-level="9.1" data-path="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html"><a href="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html"><i class="fa fa-check"></i><b>9.1</b> Some designs have badly posed questions but design diagnosis can alert you to the problem</a><ul>
<li class="chapter" data-level="9.1.1" data-path="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html"><a href="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html#a-design-with-sometimes-undefined-outcomes"><i class="fa fa-check"></i><b>9.1.1</b> A design with sometimes undefined outcomes</a></li>
<li class="chapter" data-level="9.1.2" data-path="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html"><a href="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html#what-we-find-from-diagnosis"><i class="fa fa-check"></i><b>9.1.2</b> What we find from diagnosis</a></li>
<li class="chapter" data-level="9.1.3" data-path="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html"><a href="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html#other-instances-of-this-problem"><i class="fa fa-check"></i><b>9.1.3</b> Other instances of this problem</a></li>
<li class="chapter" data-level="9.1.4" data-path="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html"><a href="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html#keep-thinking"><i class="fa fa-check"></i><b>9.1.4</b> Keep thinking</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="there-is-no-causation-without-manipulation.html"><a href="there-is-no-causation-without-manipulation.html"><i class="fa fa-check"></i><b>9.2</b> There is no causation without manipulation</a></li>
<li class="chapter" data-level="9.3" data-path="know-what-ate-averages-over.html"><a href="know-what-ate-averages-over.html"><i class="fa fa-check"></i><b>9.3</b> Know what ATE averages over</a></li>
<li class="chapter" data-level="9.4" data-path="know-what-is-local-in-a-late.html"><a href="know-what-is-local-in-a-late.html"><i class="fa fa-check"></i><b>9.4</b> Know what is local in a LATE</a></li>
<li class="chapter" data-level="9.5" data-path="know-when-sates-are-informative-for-pates.html"><a href="know-when-sates-are-informative-for-pates.html"><i class="fa fa-check"></i><b>9.5</b> Know when SATEs are informative for PATEs</a></li>
<li class="chapter" data-level="9.6" data-path="inquiry-strategies-before-inquiries-are-defined.html"><a href="inquiry-strategies-before-inquiries-are-defined.html"><i class="fa fa-check"></i><b>9.6</b> Inquiry strategies before inquiries are defined</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-principles.html"><a href="data-principles.html"><i class="fa fa-check"></i><b>10</b> Data Principles</a><ul>
<li class="chapter" data-level="10.1" data-path="why-systematic-data-collection-is-not-random-sampling.html"><a href="why-systematic-data-collection-is-not-random-sampling.html"><i class="fa fa-check"></i><b>10.1</b> Why systematic data collection is not random sampling</a></li>
<li class="chapter" data-level="10.2" data-path="keep-treatment-and-control-groups-parallel.html"><a href="keep-treatment-and-control-groups-parallel.html"><i class="fa fa-check"></i><b>10.2</b> Keep treatment and control groups parallel</a></li>
<li class="chapter" data-level="10.3" data-path="how-blocking-improves-precision.html"><a href="how-blocking-improves-precision.html"><i class="fa fa-check"></i><b>10.3</b> How blocking improves precision</a></li>
<li class="chapter" data-level="10.4" data-path="how-clusters-reduce-precision.html"><a href="how-clusters-reduce-precision.html"><i class="fa fa-check"></i><b>10.4</b> How clusters reduce precision</a></li>
<li class="chapter" data-level="10.5" data-path="answer-strategies-matter-for-power.html"><a href="answer-strategies-matter-for-power.html"><i class="fa fa-check"></i><b>10.5</b> Answer strategies matter for power</a></li>
<li class="chapter" data-level="10.6" data-path="allocating-treatments-at-extremes-can-improve-precision.html"><a href="allocating-treatments-at-extremes-can-improve-precision.html"><i class="fa fa-check"></i><b>10.6</b> Allocating treatments at extremes can improve precision</a></li>
<li class="chapter" data-level="10.7" data-path="gains-from-multiple-measurements.html"><a href="gains-from-multiple-measurements.html"><i class="fa fa-check"></i><b>10.7</b> Gains from multiple measurements</a></li>
<li class="chapter" data-level="10.8" data-path="gains-from-continuous-measures.html"><a href="gains-from-continuous-measures.html"><i class="fa fa-check"></i><b>10.8</b> Gains from continuous measures</a></li>
<li class="chapter" data-level="10.9" data-path="factorial-designs-can-be-more-powerful-than-multiarm-designs.html"><a href="factorial-designs-can-be-more-powerful-than-multiarm-designs.html"><i class="fa fa-check"></i><b>10.9</b> Factorial designs can be more powerful than multiarm designs</a></li>
<li class="chapter" data-level="10.10" data-path="allocating-treatments-at-extremes-can-improve-precision-1.html"><a href="allocating-treatments-at-extremes-can-improve-precision-1.html"><i class="fa fa-check"></i><b>10.10</b> Allocating treatments at extremes can improve precision</a></li>
<li class="chapter" data-level="10.11" data-path="balance-tests-tests-the-null-of-randomization-not-the-null-of-balance.html"><a href="balance-tests-tests-the-null-of-randomization-not-the-null-of-balance.html"><i class="fa fa-check"></i><b>10.11</b> Balance tests tests the null of randomization, not the null of balance</a></li>
<li class="chapter" data-level="10.12" data-path="assess-imbalance-on-substantive-rather-than-statistical-grounds.html"><a href="assess-imbalance-on-substantive-rather-than-statistical-grounds.html"><i class="fa fa-check"></i><b>10.12</b> Assess imbalance on substantive rather than statistical grounds</a></li>
<li class="chapter" data-level="10.13" data-path="the-dangers-of-the-big-stick.html"><a href="the-dangers-of-the-big-stick.html"><i class="fa fa-check"></i><b>10.13</b> The dangers of the big stick</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="answer-principles.html"><a href="answer-principles.html"><i class="fa fa-check"></i><b>11</b> Answer principles</a><ul>
<li class="chapter" data-level="11.1" data-path="use-controls-for-prognostic-pretreatment-covariates.html"><a href="use-controls-for-prognostic-pretreatment-covariates.html"><i class="fa fa-check"></i><b>11.1</b> Use controls for prognostic pretreatment covariates</a></li>
<li class="chapter" data-level="11.2" data-path="conditioning-on-post-treatment-variables-can-introduce-bias.html"><a href="conditioning-on-post-treatment-variables-can-introduce-bias.html"><i class="fa fa-check"></i><b>11.2</b> Conditioning on post treatment variables can introduce bias</a></li>
<li class="chapter" data-level="11.3" data-path="even-pretreatment-controls-can-introduce-bias-in-observational-analysis.html"><a href="even-pretreatment-controls-can-introduce-bias-in-observational-analysis.html"><i class="fa fa-check"></i><b>11.3</b> Even pretreatment controls can introduce bias in observational analysis</a></li>
<li class="chapter" data-level="11.4" data-path="heterogeneous-treatment-propensities-cannot-be-ignored.html"><a href="heterogeneous-treatment-propensities-cannot-be-ignored.html"><i class="fa fa-check"></i><b>11.4</b> Heterogeneous treatment propensities cannot be ignored</a></li>
<li class="chapter" data-level="11.5" data-path="the-source-of-uncertainty-matters-for-inference.html"><a href="the-source-of-uncertainty-matters-for-inference.html"><i class="fa fa-check"></i><b>11.5</b> The source of uncertainty matters for inference</a></li>
<li class="chapter" data-level="11.6" data-path="neyman-variance-is-conservative-for-sample-variance.html"><a href="neyman-variance-is-conservative-for-sample-variance.html"><i class="fa fa-check"></i><b>11.6</b> Neyman variance is conservative for sample variance</a></li>
<li class="chapter" data-level="11.7" data-path="cluster-standard-errors-at-the-level-of-treatment-assignment-for-the-sate.html"><a href="cluster-standard-errors-at-the-level-of-treatment-assignment-for-the-sate.html"><i class="fa fa-check"></i><b>11.7</b> Cluster standard errors at the level of treatment assignment for the SATE</a></li>
<li class="chapter" data-level="11.8" data-path="test-selection-should-take-account-of-both-validity-and-power.html"><a href="test-selection-should-take-account-of-both-validity-and-power.html"><i class="fa fa-check"></i><b>11.8</b> Test selection should take account of both validity and power</a></li>
<li class="chapter" data-level="11.9" data-path="randomization-does-not-justify-the-t-distribution.html"><a href="randomization-does-not-justify-the-t-distribution.html"><i class="fa fa-check"></i><b>11.9</b> Randomization does not justify the t-distribution</a></li>
<li class="chapter" data-level="11.10" data-path="you-can-check-whether-confidence-intervals-are-correct-given-the-model.html"><a href="you-can-check-whether-confidence-intervals-are-correct-given-the-model.html"><i class="fa fa-check"></i><b>11.10</b> You can check whether confidence intervals are correct, given the model</a></li>
<li class="chapter" data-level="11.11" data-path="no-evidence-of-an-effect-is-not-evidence-of-no-effect-except-for-bayesians.html"><a href="no-evidence-of-an-effect-is-not-evidence-of-no-effect-except-for-bayesians.html"><i class="fa fa-check"></i><b>11.11</b> No evidence of an effect is not evidence of no effect, except for Bayesians</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="cross-mida-principles.html"><a href="cross-mida-principles.html"><i class="fa fa-check"></i><b>12</b> Cross MIDA principles</a><ul>
<li class="chapter" data-level="12.1" data-path="as-ye-randomize-so-shall-ye-analyze.html"><a href="as-ye-randomize-so-shall-ye-analyze.html"><i class="fa fa-check"></i><b>12.1</b> As ye randomize so shall ye analyze</a></li>
<li class="chapter" data-level="12.2" data-path="selective-reporting-introduces-bias.html"><a href="selective-reporting-introduces-bias.html"><i class="fa fa-check"></i><b>12.2</b> Selective reporting introduces bias</a></li>
<li class="chapter" data-level="12.3" data-path="there-is-often-a-bias-variance-tradeoff.html"><a href="there-is-often-a-bias-variance-tradeoff.html"><i class="fa fa-check"></i><b>12.3</b> There is often a bias-variance tradeoff</a></li>
<li class="chapter" data-level="12.4" data-path="spillovers-are-a-design-challenge.html"><a href="spillovers-are-a-design-challenge.html"><i class="fa fa-check"></i><b>12.4</b> Spillovers are a design challenge</a></li>
<li class="chapter" data-level="12.5" data-path="identify-primary-questions.html"><a href="identify-primary-questions.html"><i class="fa fa-check"></i><b>12.5</b> Identify primary questions</a></li>
<li class="chapter" data-level="12.6" data-path="check-your-models.html"><a href="check-your-models.html"><i class="fa fa-check"></i><b>12.6</b> Check your models</a></li>
</ul></li>
<li class="part"><span><b>IV Putting Declared Designs to Use</b></span></li>
<li class="chapter" data-level="13" data-path="workflows.html"><a href="workflows.html"><i class="fa fa-check"></i><b>13</b> Workflows</a><ul>
<li class="chapter" data-level="13.1" data-path="design-development.html"><a href="design-development.html"><i class="fa fa-check"></i><b>13.1</b> Design development</a></li>
<li class="chapter" data-level="13.2" data-path="design-registration-and-reconciliation.html"><a href="design-registration-and-reconciliation.html"><i class="fa fa-check"></i><b>13.2</b> Design Registration and Reconciliation</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="critique.html"><a href="critique.html"><i class="fa fa-check"></i><b>14</b> Critique</a><ul>
<li class="chapter" data-level="14.1" data-path="new-principles-for-replication-and-critique.html"><a href="new-principles-for-replication-and-critique.html"><i class="fa fa-check"></i><b>14.1</b> New principles for replication and critique</a></li>
<li class="chapter" data-level="14.2" data-path="polemics.html"><a href="polemics.html"><i class="fa fa-check"></i><b>14.2</b> Polemics</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="community.html"><a href="community.html"><i class="fa fa-check"></i><b>15</b> Community</a><ul>
<li class="chapter" data-level="15.1" data-path="evaluating-and-supporting-research.html"><a href="evaluating-and-supporting-research.html"><i class="fa fa-check"></i><b>15.1</b> Evaluating and supporting research</a></li>
<li class="chapter" data-level="15.2" data-path="a-library-of-designs.html"><a href="a-library-of-designs.html"><i class="fa fa-check"></i><b>15.2</b> A library of designs</a></li>
<li class="chapter" data-level="15.3" data-path="ajr-example.html"><a href="ajr-example.html"><i class="fa fa-check"></i><b>15.3</b> AJR example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-8.html"><a href="references-8.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://declaredesign.org" target="blank">DeclareDesign</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Declaring and Diagnosing Research Designs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="topic-analysis" class="section level2">
<h2><span class="header-section-number">4.6</span> Topic analysis</h2>
<pre class="sourceCode r"><code class="sourceCode r">lda_tidy &lt;-<span class="st"> </span><span class="cf">function</span>(data, k, matrix) {
  tdm &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">word =</span> <span class="kw">as.character</span>(word)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">group_by</span>(document, word) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>count <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">cast_dtm</span>(document, word, n)
  fit &lt;-<span class="st"> </span><span class="kw">LDA</span>(<span class="dt">x =</span> tdm, <span class="dt">k =</span> k)
  <span class="kw">tidy</span>(fit, <span class="dt">matrix =</span> matrix) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">group_by</span>(topic) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">top_n</span>(<span class="dv">10</span>, beta) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">arrange</span>(<span class="op">-</span>beta) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">word_num =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">arrange</span>(topic, <span class="op">-</span>beta) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>beta) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">spread</span>(word_num, term) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">unite</span>(top_<span class="dv">10</span>_words, <span class="st">`</span><span class="dt">1</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">10</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">spread</span>(topic, top_<span class="dv">10</span>_words) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">rename</span>(<span class="dt">topic_1_top_10_words =</span> <span class="st">`</span><span class="dt">1</span><span class="st">`</span>, <span class="dt">topic_2_top_10_words =</span> <span class="st">`</span><span class="dt">2</span><span class="st">`</span>)
}

laws &lt;-<span class="st"> </span><span class="kw">gutenberg_download</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">17150</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(gutenberg_id) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">slice</span>(<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">unnest_tokens</span>(word, text) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">anti_join</span>(stop_words)

topic_probs &lt;-<span class="st"> </span>laws <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(gutenberg_id) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">topic_n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(gutenberg_id, word) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">topic_n =</span> <span class="kw">unique</span>(topic_n), <span class="dt">word_count =</span> <span class="kw">n</span>(),
            <span class="dt">word_prob =</span> word_count <span class="op">/</span><span class="st"> </span>topic_n) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ungroup
  
topic_probs &lt;-<span class="st"> </span>topic_probs <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">expand</span>(gutenberg_id, word) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">left_join</span>(topic_probs) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(gutenberg_id, word, word_prob) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>(gutenberg_id, word_prob) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">pr_topic_1 =</span> <span class="st">`</span><span class="dt">2</span><span class="st">`</span>,
         <span class="dt">pr_topic_2 =</span> <span class="st">`</span><span class="dt">17150</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pr_topic_1 =</span> <span class="kw">replace_na</span>(pr_topic_<span class="dv">1</span>, <span class="dv">0</span>),
         <span class="dt">pr_topic_2 =</span> <span class="kw">replace_na</span>(pr_topic_<span class="dv">2</span>, <span class="dv">0</span>))

corpus &lt;-<span class="st"> </span>topic_probs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(word)
topic_<span class="dv">1</span>_prob &lt;-<span class="st"> </span>topic_probs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(pr_topic_<span class="dv">1</span>)
topic_<span class="dv">2</span>_prob &lt;-<span class="st"> </span>topic_probs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(pr_topic_<span class="dv">2</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">N_documents &lt;-<span class="st"> </span><span class="dv">50</span>
N_topics    &lt;-<span class="st"> </span><span class="dv">2</span>

design &lt;-
<span class="st">  </span><span class="kw">declare_population</span>(
    <span class="dt">document =</span> <span class="kw">add_level</span>(
      <span class="dt">N =</span> <span class="dv">200</span>,
      
      <span class="co"># document length is drawn from a Poisson distribution</span>
      <span class="dt">N_words_per_document =</span> <span class="kw">rpois</span>(N, <span class="dt">lambda =</span> <span class="dv">500</span>),
      
      <span class="co"># draw topic proportion for each document from Dirichlet; save pr(topic1)</span>
      <span class="dt">theta_topic2 =</span>  <span class="kw">rdirichlet</span>(N, <span class="dt">alpha =</span> <span class="kw">rep</span>(<span class="dv">1</span>, N_topics))[, <span class="dv">2</span>]
    ),
    
    <span class="dt">words =</span> <span class="kw">add_level</span>(
      <span class="dt">N =</span> N_words_per_document,
      
      <span class="co"># draw topic (1 or 2) based on theta probabilities for the document</span>
      <span class="dt">topic =</span> <span class="kw">simple_ra</span>(N, <span class="dt">prob =</span> theta_topic2, <span class="dt">conditions =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>),
      
      <span class="dt">word =</span> <span class="kw">case_when</span>(
        topic <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="kw">simple_ra</span>(N, <span class="dt">prob_each =</span> topic_<span class="dv">1</span>_prob, <span class="dt">conditions =</span> corpus),
        topic <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="kw">simple_ra</span>(N, <span class="dt">prob_each =</span> topic_<span class="dv">2</span>_prob, <span class="dt">conditions =</span> corpus)
      )
    )
  ) <span class="op">+</span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">declare_estimator</span>(
    <span class="dt">handler =</span> <span class="kw">tidy_estimator</span>(lda_tidy), <span class="dt">k =</span> <span class="dv">2</span>, <span class="dt">matrix =</span> <span class="st">&quot;beta&quot;</span>,
    <span class="dt">label =</span> <span class="st">&quot;lda-topics&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">draw_data</span>(design)

document1 &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(document <span class="op">==</span><span class="st"> &quot;001&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(word) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">paste0</span>(<span class="dt">collapse =</span> <span class="st">&quot; &quot;</span>)
document2 &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(document <span class="op">==</span><span class="st"> &quot;002&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(word) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">paste0</span>(<span class="dt">collapse =</span> <span class="st">&quot; &quot;</span>)

<span class="kw">kable</span>(<span class="kw">cbind</span>(document1, document2), <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Document 1&quot;</span>, <span class="st">&quot;Document 2&quot;</span>))</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
Document 1
</th>
<th style="text-align:left;">
Document 2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
breach time wife enjoy department purchased _memoires 173 deed god subject borne section <em>see</em> money section property witnesses <em>tome probable 278 law dies account morrison 139 cultivation unreclaimed enjoy time children silver confronted cultivated field 197 constable business fixed time naval 275 machine father harboured portion quarrel fines lessee time lost mina life eyes annulment 227 disease section owner wine built possessed owner storage death migration respecting 179 monument boatman lifetime death owner seized accused child invalidated 144 respecting produce judge father’s reimbursement released sickness corn children poor marriage father’s breach house trial exceed sons scarcely bare horn district common ascertained time congress 141 1789 indictment 123 clark corn economical accused 275 feature brought establishment rear bonds 171 bronze unusual votary favor cuts house share <em>see</em> witness property process sixth committed mina gentleman carried plant deluge bring free husband 111 35 brought 2.5 <em>res husband resigns offense 148 jury mother’s 131 arising son press money passenger peaceably ravaged common fees 177 womb law free constitution life district retained life war <em>se</em> crops brawlers heap judge time local crop sentence husband militia deprived death section marriage seduced money regulated garden section arising morgan harvester common <em>see</em> constitution 148 house purchase field god accidental fines thereof 226 35 138 destroyed stolen daughter seed harboured gate hands passed section robbery carrying reserved impartial house dispute 218 master caused agreed 126 impression limited oxen public gentle acquired compensation also</em> section militia granted jury bring penal branding gentleman’s ripe months held maintenance <em>january</em> january 248 eye daughter land agent december unreasonable enumeration life half freedom charges rights sheep bail 127 125 default 164 owner punishments section 118 146 bridegroom impartial dowry sons cut 1791 boatman speech loss loss rules 11 concubine king’s gentleman woman woman return enjoy loss cultivation children marry conqueror 175 impartial 119 criminal lose security 1789 public owner constitution votary process offense 57 constitution greatly garden temple money respecting slave peaceably service 28 price hoe jilting corn worry city witnesses 201 consent handicraft 207 slave account house property lost <em>gur</em> infamous 15 reaper lines months share house causing memorandum death remission 168 1791 sell translation assistance 45 orchard land portion 44 assign shortly deprived liability leased hire judgement forces <em>see</em> silver time palace law 225 bore pay trial grievances wife iii arising construed illegal 17 owe neat granted marriage 9 law morgan twenty witnesses actual naval maidservant lost speech amendments enjoy soldier settlement god ratified price 170 oil house merchant respecting common translation wife blows marriage home 42 mothers oath house children owner intelligible 55 ten preserved also</em> field 129 48 unusual slave hired ox limb seated thy jury scandal 210 rights duties branding house runnel inheritance regulated wagon capital custom woman account hand house 16 widow 10 ten merchant remarkable complaint write gardener bill thereof wife retained 277 security foreign powers cultivated womb stands government section section leave law defense doctor fault injury pay limb militia indelible children bought slave seized wine mother delegated 175 ox rights _memoires brander 207 sheep king 152 bail daughter return 193 borne lost laws woman 40 produce prosecutions heavy mina people criminal master 170 supported 17 cultivator free agent mother release seated merchant implements 215
</td>
<td style="text-align:left;">
death miscarriage bill deed hands 190 prohibiting law person private describing ox unreasonable seized people common consent leave mother bail liberty lease public suits oath reserved controversy law time constitution quartered public united operations seized jury militia favor capital wife due united effects militia actual redress father’s verily nature owner 215 disparage common people delegated religion rights united crime redress arising law prescribed law disparage papers iv time manner issue time committed prescribed 127 witnesses required united accounts exercise government district service relationships infamous deny original criminal excessive unreasonable corn property field security compensation enjoy speech enjoy hand militia actual militia security house searched retained danger 128 common jeopardy explorations public speedy congress crime property exceed jury service drowning art iv controversy thereof wishes marriages dollars security deprived time slave construed jury ten badly establishment ii prohibited prohibited slave constitution witnesses violated delegated united trial bill ix law assemble criminal witnesses arising presentment unusual exercise thereof exceed militia woman 25 persons ratified gentleman ii time builder witness actual redress crime unreasonable process people ten law law trial constitution prohibiting freedom land law ox life 250 recaptured 137 defense danger jury accused seizures time mina criminal persons 180 houses security ten grievances mina excessive impartial wife exercise offense rules criminal confronted held defense divorced congress obtaining security seized people freedom people united bill powers held counsel service abridging united witnesses section bronze excessive affirmation petition establishment abridging supported free grand husband time ilu ii land peaceably construed dates persons militia rights trial bear fines affirmation infringed war affirmation militia prescribed nature war accused obtaining amendments 112 sentence life owner single delegated people dollars wife defense arms witnesses owner compensation actual concubine rights husband required witness person rights printed oath iii suits freedom suitor government time witnesses crime child bail forces answer powers arising houses person indictment 147 25 enjoy court liberty establishment bail borne militia deprived committed favor previously punishments free life forces law jury prosecutions code compensation poor 234 male constitution respecting redress danger house imposed peace people seizures inflicted public unreasonable district required viii 242 sought section person obtaining slave 223 money ii religion ur united jury government warrants grand deprived united witness government seizures law danger court exercise examined field public deed exceed retained dollars subject 25 property unusual owner committed people service people preserved disparage soldier examined common shepherd militia violated enjoy people ratified common petition bail constitution war people actual limb thereof amendments necessarily disparage persons disparage reserved naval committed servant housebreaking freighted reserved common prohibiting cruel 116 1791 grounds owner _per nature levy speech previously retained freedom cruel property establishment compelled people speech 25 twenty delegated people regulated religion redress searched rules prescribed property jury grievances naval owner common violated affirmation free offense sheep trial 141 person life land free disparage controversy infringed counsel defense nature service crime property people congress deny quartered person impartial jury law forces press people effects arms
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># diagnosis</span>

compare_word_lists &lt;-<span class="st"> </span><span class="cf">function</span>(list1, list2){
  list1 &lt;-<span class="st"> </span><span class="kw">str_split</span>(list1, <span class="st">&quot;_&quot;</span>)
  list2 &lt;-<span class="st"> </span><span class="kw">str_split</span>(list2, <span class="st">&quot;_&quot;</span>)[[<span class="dv">1</span>]]
  <span class="kw">sapply</span>(list1, <span class="cf">function</span>(x) <span class="kw">sum</span>(x <span class="op">%in%</span><span class="st"> </span>list2) <span class="op">==</span><span class="st"> </span><span class="kw">length</span>(list2))
}

topic_<span class="dv">1</span>_words &lt;-<span class="st"> </span>topic_probs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">top_n</span>(<span class="dv">3</span>, pr_topic_<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="op">-</span>pr_topic_<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(word) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">paste0</span>(<span class="dt">collapse =</span> <span class="st">&quot;_&quot;</span>)
topic_<span class="dv">2</span>_words &lt;-<span class="st"> </span>topic_probs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">top_n</span>(<span class="dv">3</span>, pr_topic_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="op">-</span>pr_topic_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(word) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">paste0</span>(<span class="dt">collapse =</span> <span class="st">&quot;_&quot;</span>)

diag &lt;-<span class="st"> </span><span class="kw">declare_diagnosands</span>(<span class="dt">in_topic_1 =</span> 
                              <span class="kw">mean</span>(<span class="kw">compare_word_lists</span>(topic_<span class="dv">1</span>_top_<span class="dv">10</span>_words, topic_<span class="dv">1</span>_words) <span class="op">|</span>
<span class="st">                                     </span><span class="kw">compare_word_lists</span>(topic_<span class="dv">2</span>_top_<span class="dv">10</span>_words, topic_<span class="dv">1</span>_words)),
                            <span class="dt">in_topic_2 =</span> 
                              <span class="kw">mean</span>(<span class="kw">compare_word_lists</span>(topic_<span class="dv">1</span>_top_<span class="dv">10</span>_words, topic_<span class="dv">2</span>_words) <span class="op">|</span>
<span class="st">                                     </span><span class="kw">compare_word_lists</span>(topic_<span class="dv">2</span>_top_<span class="dv">10</span>_words, topic_<span class="dv">2</span>_words)),
                            <span class="dt">in_either_topic =</span> 
                              <span class="kw">mean</span>(<span class="kw">compare_word_lists</span>(topic_<span class="dv">1</span>_top_<span class="dv">10</span>_words, topic_<span class="dv">1</span>_words) <span class="op">|</span>
<span class="st">                                     </span><span class="kw">compare_word_lists</span>(topic_<span class="dv">2</span>_top_<span class="dv">10</span>_words, topic_<span class="dv">1</span>_words) <span class="op">|</span>
<span class="st">                                     </span><span class="kw">compare_word_lists</span>(topic_<span class="dv">1</span>_top_<span class="dv">10</span>_words, topic_<span class="dv">2</span>_words) <span class="op">|</span>
<span class="st">                                     </span><span class="kw">compare_word_lists</span>(topic_<span class="dv">2</span>_top_<span class="dv">10</span>_words, topic_<span class="dv">2</span>_words )),
                            <span class="dt">in_both_topic =</span> 
                              <span class="kw">mean</span>( (<span class="kw">compare_word_lists</span>(topic_<span class="dv">1</span>_top_<span class="dv">10</span>_words, topic_<span class="dv">1</span>_words) <span class="op">|</span>
<span class="st">                                     </span><span class="kw">compare_word_lists</span>(topic_<span class="dv">1</span>_top_<span class="dv">10</span>_words, topic_<span class="dv">2</span>_words)) <span class="op">&amp;</span>
<span class="st">                                     </span><span class="kw">compare_word_lists</span>(topic_<span class="dv">2</span>_top_<span class="dv">10</span>_words, topic_<span class="dv">1</span>_words) <span class="op">|</span>
<span class="st">                                     </span><span class="kw">compare_word_lists</span>(topic_<span class="dv">2</span>_top_<span class="dv">10</span>_words, topic_<span class="dv">2</span>_words )),
                            <span class="dt">keep_defaults =</span> <span class="ot">FALSE</span>)</code></pre>
<!-- This chunk is set to `echo = TRUE` and `eval = do_diagnosis` -->
<pre class="sourceCode r"><code class="sourceCode r">diagnosis &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">diagnose_design</span>(design, <span class="dt">diagnosands =</span> diag, <span class="dt">sims =</span> <span class="dv">10</span>, <span class="dt">bootstrap_sims =</span> <span class="dv">10</span>)</code></pre>
<!-- Right after you do simulations, you want to save the simulations rds.  -->
<!-- Now all that simulating, saving, and loading is done, and we can use the simulations for whatever you want. -->
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">reshape_diagnosis</span>(diagnosis))</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
Design Label
</th>
<th style="text-align:left;">
Estimator Label
</th>
<th style="text-align:left;">
N Sims
</th>
<th style="text-align:left;">
In Topic 1
</th>
<th style="text-align:left;">
In Topic 2
</th>
<th style="text-align:left;">
In Either Topic
</th>
<th style="text-align:left;">
In Both Topic
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
design
</td>
<td style="text-align:left;">
lda-topics
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
0.90
</td>
<td style="text-align:left;">
0.60
</td>
<td style="text-align:left;">
0.90
</td>
<td style="text-align:left;">
0.70
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.10)
</td>
<td style="text-align:left;">
(0.12)
</td>
<td style="text-align:left;">
(0.10)
</td>
<td style="text-align:left;">
(0.14)
</td>
</tr>
</tbody>
</table>
<div id="references-2" class="section level3">
<h3><span class="header-section-number">4.6.1</span> References</h3>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="measuring-latent-variables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multilevel-regression-and-poststratification.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
