<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 18 Exercises | Research Design: Declare, Diagnose, Redesign</title>
<meta name="author" content="Graeme Blair, Jasper Cooper, Alexander Coppock, and Macartan Humphreys">
<!-- CSS --><!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.1.9000/tabs.js"></script><script src="libs/bs3compat-0.2.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://hypothes.is/embed.js" async></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Research Design: Declare, Diagnose, Redesign</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">Introduction</li>
<li><a class="" href="preamble.html"><span class="header-section-number">1</span> Preamble</a></li>
<li><a class="" href="improving-research-designs.html"><span class="header-section-number">2</span> Improving research designs</a></li>
<li><a class="" href="software-primer.html"><span class="header-section-number">3</span> Software primer</a></li>
<li><a class="" href="part-i-exercises.html"><span class="header-section-number">4</span> Part I Exercises</a></li>
<li class="book-part">Declaration, Diagnosis, Redesign</li>
<li><a class="" href="formalizing-mida.html"><span class="header-section-number">5</span> Formalizing MIDA</a></li>
<li><a class="" href="specifying-the-model.html"><span class="header-section-number">6</span> Specifying the model</a></li>
<li><a class="" href="defining-the-inquiry.html"><span class="header-section-number">7</span> Defining the inquiry</a></li>
<li><a class="" href="crafting-a-data-strategy.html"><span class="header-section-number">8</span> Crafting a data strategy</a></li>
<li><a class="" href="choosing-an-answer-strategy.html"><span class="header-section-number">9</span> Choosing an answer strategy</a></li>
<li><a class="" href="p2diagnosis.html"><span class="header-section-number">10</span> Diagnosis</a></li>
<li><a class="" href="redesign-1.html"><span class="header-section-number">11</span> Redesign</a></li>
<li><a class="" href="part-ii-exercises.html"><span class="header-section-number">12</span> Part II Exercises</a></li>
<li class="book-part">Design Library</li>
<li><a class="" href="design-library.html"><span class="header-section-number">13</span> Design Library</a></li>
<li><a class="" href="observational-designs-for-descriptive-inference.html"><span class="header-section-number">14</span> Observational designs for descriptive inference</a></li>
<li><a class="" href="experimental-designs-for-descriptive-inference.html"><span class="header-section-number">15</span> Experimental designs for descriptive inference</a></li>
<li><a class="" href="observational-designs-for-causal-inference.html"><span class="header-section-number">16</span> Observational designs for causal inference</a></li>
<li><a class="" href="experimental-designs-for-causal-inference.html"><span class="header-section-number">17</span> Experimental designs for causal inference</a></li>
<li><a class="active" href="exercises-6.html"><span class="header-section-number">18</span> Exercises</a></li>
<li><a class="" href="multi-study-designs.html"><span class="header-section-number">19</span> Multi-study designs</a></li>
<li><a class="" href="part-iii-exercises.html"><span class="header-section-number">20</span> Part III Exercises</a></li>
<li class="book-part">Research Design Lifecycle</li>
<li><a class="" href="research-design-lifecycle.html"><span class="header-section-number">21</span> Research Design Lifecycle</a></li>
<li><a class="" href="planning.html"><span class="header-section-number">22</span> Planning</a></li>
<li><a class="" href="ethical-review.html"><span class="header-section-number">23</span> Ethical Review</a></li>
<li><a class="" href="partners.html"><span class="header-section-number">24</span> Partners</a></li>
<li><a class="" href="funding.html"><span class="header-section-number">25</span> Funding</a></li>
<li><a class="" href="piloting.html"><span class="header-section-number">26</span> Piloting</a></li>
<li><a class="" href="implementation.html"><span class="header-section-number">27</span> Implementation</a></li>
<li><a class="" href="populated-preanalysis-plan.html"><span class="header-section-number">28</span> Populated Preanalysis Plan</a></li>
<li><a class="" href="reconciliation.html"><span class="header-section-number">29</span> Reconciliation</a></li>
<li><a class="" href="writing.html"><span class="header-section-number">30</span> Writing</a></li>
<li><a class="" href="publication.html"><span class="header-section-number">31</span> Publication</a></li>
<li><a class="" href="archiving.html"><span class="header-section-number">32</span> Archiving</a></li>
<li><a class="" href="reanalysis.html"><span class="header-section-number">33</span> Reanalysis</a></li>
<li><a class="" href="replication.html"><span class="header-section-number">34</span> Replication</a></li>
<li><a class="" href="resolving-disputes.html"><span class="header-section-number">35</span> Resolving Disputes</a></li>
<li><a class="" href="synthesis.html"><span class="header-section-number">36</span> Synthesis</a></li>
<li><a class="" href="part-iv-exercises.html"><span class="header-section-number">37</span> Part IV Exercises</a></li>
<li class="book-part">Epilogue</li>
<li><a class="" href="epilogue.html"><span class="header-section-number">38</span> Epilogue</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="glossary.html"><span class="header-section-number">39</span> Glossary</a></li>
<li><a class="" href="references-4.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="exercises-6" class="section level1">
<h1>
<span class="header-section-number">18</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-6"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li><p>Increase the saturation of the “low” condition from 0% to 25% and diagnose the design. Notice how this changes the mean saturation and direct effect estimands. Now set the saturations both equal to 25%. Explain why the two estimands do or do not change.</p></li>
<li><p>Setting the saturations back to their original values, remove the <code>ipw</code> from the estimator. What happens to the bias? Explain your answer.</p></li>
<li>In the potential outcomes declaration for <code>Y</code>, add an interaction between the high saturation condition and <code>Z</code>, and diagnose the design with the saturations set to their original values of 0 and .75.
<ol style="list-style-type: decimal">
<li>Why is the estimate of the ATE of the treatment biased whereas the estimate of the saturation effect is not?</li>
<li>Why can the researcher not simply estimate the interaction in this design?</li>
<li>Now increase the low saturation to 25% and add an interaction between <code>Z</code> and <code>S</code> to the estimator. Why does this make the design unbiased again?</li>
</ol>
</li>
</ul>
<div id="online-appendix-applied-example-2" class="section level3">
<h3>
<span class="header-section-number">18.0.1</span> Online Appendix Applied Example<a class="anchor" aria-label="anchor" href="#online-appendix-applied-example-2"><i class="fas fa-link"></i></a>
</h3>
<!-- make sure to rename the section title below -->
<p><span class="citation">Asunka et al. (<a href="references-4.html#ref-asunka2019">2019</a>)</span>, for example, wanted to know if the presence of election monitors at ballot stations would displace violence and fraud to other ballot stations. They randomized constituencies to low, medium, and high levels of saturation, and then randomized ballot stations to have election monitoring or not in low, medium, or high concentrations, depending on the randomized saturation. In the original study, the authors did not include a zero-saturation condition. Here, we declare a simplified version of their design in which a zero-saturation condition is included.</p>
<p>Main points to develop:</p>
<ul>
<li>Randomized saturation is great when you get the model right. Though, show how IPW reduces the power to detect main effect, especially if there’s no spillover.</li>
<li>Randomized saturation assumes a model that may be wrong. In particular, spillovers are restricted to containers. But this might not be correct.</li>
</ul>
</div>
<div id="design-declaration-4" class="section level3">
<h3>
<span class="header-section-number">18.0.2</span> Design Declaration<a class="anchor" aria-label="anchor" href="#design-declaration-4"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p><strong>M</strong>odel:
Potential outcomes are defined in terms of <code>S</code>—the saturation—and <code>Z</code>—whether or not a ballot station is treated. We model spillovers in two ways. In the first, the amount of spillover that affects a unit is determined by how many other units in its network are treated. In the second, the amount of spillover a unit receives is determined by whether that unit’s geographic neighbor is treated, irrespective of whether they share a network.</p></li>
<li><p><strong>I</strong>nquiry:
We want to know the effect of having high and medium levels of saturation versus low saturation in the control: <span class="math inline">\(E[Y_i(Z_i = 0, S_i = \text{high})-Y_i(Z_i = 0, S_i = \text{low})]\)</span> and <span class="math inline">\(E[Y_i(Z_i = 0, S_i = \text{medium})-Y_i(Z_i = 0, S_i = \text{low})]\)</span>. We also want to know the “direct effect”–e.g. what happens to those directly treated if we disregard spillovers. Here it is defined over potential outcomes that the experiment does not reveal, since no one is treated in low-saturation constituencies: <span class="math inline">\(E[Y_i(Z_i = 1, S_i = \text{low})-Y_i(Z_i = 0, S_i = \text{low})]\)</span>.</p></li>
<li><p><strong>D</strong>ata strategy: We assign entire groups of individual ballot stations to one of three saturations: low (0%), medium (50%), and high (75%). We then randomize individuals within groups to treatment or control in the proportions dictated by the saturation. Thus, the saturation is cluster-randomized, whereas treatment is block-randomized.</p></li>
<li><p><strong>A</strong>nswer strategy: We weight each individual by the inverse of the probability that they find themselves in the condition they’re in. To estimate spillovers, we run one regression comparing high and one regression comparing medium to low saturation control units. To estimate the direct effect, we run a regression of the outcome on the treatment indicatior on the full sample, controlling for saturation.</p></li>
</ul>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N_individuals</span> <span class="op">&lt;-</span> <span class="fl">60</span>
<span class="va">N_groups</span> <span class="op">&lt;-</span> <span class="fl">15</span>
<span class="va">G_per_saturation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>

<span class="va">design</span> <span class="op">&lt;-</span> 
  <span class="fu">declare_population</span><span class="op">(</span>N <span class="op">=</span> <span class="va">N_individuals</span>, X <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span>, U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, G <span class="op">=</span> <span class="fu">ntile</span><span class="op">(</span><span class="va">X</span>, <span class="va">N_groups</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_assignment</span><span class="op">(</span>assignment_variable <span class="op">=</span> <span class="st">"S"</span>, 
                     clusters <span class="op">=</span> <span class="va">G</span>, 
                     conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"low"</span>,<span class="st">"med"</span>,<span class="st">"high"</span><span class="op">)</span>,
                     m_each <span class="op">=</span> <span class="va">G_per_saturation</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_assignment</span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0</span>,
                     blocks <span class="op">=</span> <span class="va">G</span>,
                     assignment_variable <span class="op">=</span> <span class="st">"Z_S_low"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_assignment</span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">.5</span>,
                     blocks <span class="op">=</span> <span class="va">G</span>,
                     assignment_variable <span class="op">=</span> <span class="st">"Z_S_med"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_assignment</span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">.75</span>,
                     blocks <span class="op">=</span> <span class="va">G</span>,
                     assignment_variable <span class="op">=</span> <span class="st">"Z_S_high"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_step</span><span class="op">(</span>
    spillover_low <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ave.html">ave</a></span><span class="op">(</span><span class="va">Z_S_low</span>, <span class="va">G</span>, FUN <span class="op">=</span> <span class="va">sum</span><span class="op">)</span> <span class="op">*</span> <span class="fl">.1</span>,
    spillover_med <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ave.html">ave</a></span><span class="op">(</span><span class="va">Z_S_med</span>, <span class="va">G</span>, FUN <span class="op">=</span> <span class="va">sum</span><span class="op">)</span> <span class="op">*</span> <span class="fl">.1</span>,
    spillover_high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ave.html">ave</a></span><span class="op">(</span><span class="va">Z_S_high</span>, <span class="va">G</span>, FUN <span class="op">=</span> <span class="va">sum</span><span class="op">)</span> <span class="op">*</span> <span class="fl">.1</span>,
    handler <span class="op">=</span> <span class="va">fabricate</span>,
    label <span class="op">=</span> <span class="st">"spillover"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu">declare_potential_outcomes</span><span class="op">(</span>
    <span class="va">Y</span> <span class="op">~</span> <span class="va">Z</span> <span class="op">*</span> <span class="op">-</span><span class="fl">.20</span> <span class="op">+</span> <span class="va">U</span> <span class="op">+</span> 
      <span class="va">spillover_low</span> <span class="op">*</span> <span class="op">(</span><span class="va">S</span> <span class="op">==</span> <span class="st">"low"</span><span class="op">)</span> <span class="op">+</span> 
      <span class="va">spillover_med</span> <span class="op">*</span> <span class="op">(</span><span class="va">S</span> <span class="op">==</span> <span class="st">"med"</span><span class="op">)</span> <span class="op">+</span> 
      <span class="va">spillover_high</span> <span class="op">*</span> <span class="op">(</span><span class="va">S</span> <span class="op">==</span> <span class="st">"high"</span><span class="op">)</span>,
    conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, S <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"low"</span>,<span class="st">"med"</span>,<span class="st">"high"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimand</span><span class="op">(</span>high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y_Z_0_S_high</span> <span class="op">-</span> <span class="va">Y_Z_0_S_low</span><span class="op">)</span>,
                   med <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y_Z_0_S_med</span> <span class="op">-</span> <span class="va">Y_Z_0_S_low</span><span class="op">)</span>, 
                   ate_no_spill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y_Z_1_S_low</span> <span class="op">-</span> <span class="va">Y_Z_0_S_low</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_reveal</span><span class="op">(</span><span class="va">Z</span>,<span class="va">S</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_step</span><span class="op">(</span>
    w <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">S_cond_prob</span> <span class="op">*</span> <span class="op">(</span><span class="va">Z_S_low_cond_prob</span> <span class="op">*</span> <span class="op">(</span><span class="va">S</span> <span class="op">==</span> <span class="st">"low"</span><span class="op">)</span> <span class="op">+</span> 
                   <span class="va">Z_S_med_cond_prob</span> <span class="op">*</span> <span class="op">(</span><span class="va">S</span> <span class="op">==</span> <span class="st">"med"</span><span class="op">)</span> <span class="op">+</span> 
                   <span class="va">Z_S_high_cond_prob</span> <span class="op">*</span> <span class="op">(</span><span class="va">S</span> <span class="op">==</span> <span class="st">"high"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    handler <span class="op">=</span> <span class="va">fabricate</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_reveal</span><span class="op">(</span><span class="va">Y</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Z</span>, <span class="va">S</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimator</span><span class="op">(</span>model <span class="op">=</span> <span class="va">lm_robust</span>, 
                    formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">S</span>,
                    subset <span class="op">=</span> <span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">S</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"high"</span>,<span class="st">"low"</span><span class="op">)</span>, 
                    estimand <span class="op">=</span> <span class="st">"high"</span>,
                    weights <span class="op">=</span> <span class="va">w</span>,
                    label <span class="op">=</span> <span class="st">"high vs low"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimator</span><span class="op">(</span>model <span class="op">=</span> <span class="va">lm_robust</span>, 
                    formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">S</span>,
                    subset <span class="op">=</span> <span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">S</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"med"</span>,<span class="st">"low"</span><span class="op">)</span>, 
                    weights <span class="op">=</span> <span class="va">w</span>,
                    estimand <span class="op">=</span> <span class="st">"med"</span>,
                    label <span class="op">=</span> <span class="st">"med vs low"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimator</span><span class="op">(</span>model <span class="op">=</span> <span class="va">lm_robust</span>, 
                    formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">Z</span> <span class="op">+</span> <span class="va">S</span>,
                    term <span class="op">=</span> <span class="st">"Z"</span>, 
                    weights <span class="op">=</span> <span class="va">w</span>,
                    estimand <span class="op">=</span> <span class="st">"ate_no_spill"</span>,
                    label <span class="op">=</span> <span class="st">"main effect"</span><span class="op">)</span></code></pre></div>
<p>Here’s what our hypothetical country looks like:</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">draw_data</span><span class="op">(</span><span class="va">design</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">X</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_discrete</span><span class="op">(</span><span class="st">"Ballot station"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span><span class="st">"Latitude"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span><span class="st">"Longitude"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">N_individuals</span>,by <span class="op">=</span> <span class="va">N_individuals</span> <span class="op">/</span> <span class="va">N_groups</span><span class="op">)</span> <span class="op">-</span> <span class="fl">.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="book_files/figure-html/unnamed-chunk-371-1.png" width="100%"></div>
<p>Let’s diagnose</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu">diagnose_design</span><span class="op">(</span><span class="va">design</span>, sims <span class="op">=</span> <span class="va">sims</span><span class="op">)</span></code></pre></div>
<p>Our diagnosis shows this design does a pretty great job, under this model of spillovers:</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diagnosis</span> <span class="op">%&gt;%</span> <span class="fu">reshape_diagnosis</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
Design Label
</th>
<th style="text-align:left;">
Estimand Label
</th>
<th style="text-align:left;">
Estimator Label
</th>
<th style="text-align:left;">
Term
</th>
<th style="text-align:left;">
N Sims
</th>
<th style="text-align:left;">
Bias
</th>
<th style="text-align:left;">
RMSE
</th>
<th style="text-align:left;">
Power
</th>
<th style="text-align:left;">
Coverage
</th>
<th style="text-align:left;">
Mean Estimate
</th>
<th style="text-align:left;">
SD Estimate
</th>
<th style="text-align:left;">
Mean Se
</th>
<th style="text-align:left;">
Type S Rate
</th>
<th style="text-align:left;">
Mean Estimand
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
design
</td>
<td style="text-align:left;">
ate_no_spill
</td>
<td style="text-align:left;">
main effect
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:left;">
500
</td>
<td style="text-align:left;">
0.01
</td>
<td style="text-align:left;">
0.35
</td>
<td style="text-align:left;">
0.10
</td>
<td style="text-align:left;">
0.93
</td>
<td style="text-align:left;">
-0.19
</td>
<td style="text-align:left;">
0.35
</td>
<td style="text-align:left;">
0.33
</td>
<td style="text-align:left;">
0.08
</td>
<td style="text-align:left;">
-0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.00)
</td>
<td style="text-align:left;">
(0.04)
</td>
<td style="text-align:left;">
(0.00)
</td>
</tr>
<tr>
<td style="text-align:left;">
design
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high vs low
</td>
<td style="text-align:left;">
Shigh
</td>
<td style="text-align:left;">
500
</td>
<td style="text-align:left;">
-0.05
</td>
<td style="text-align:left;">
0.51
</td>
<td style="text-align:left;">
0.12
</td>
<td style="text-align:left;">
0.90
</td>
<td style="text-align:left;">
0.25
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.48
</td>
<td style="text-align:left;">
0.13
</td>
<td style="text-align:left;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.05)
</td>
<td style="text-align:left;">
(0.00)
</td>
</tr>
<tr>
<td style="text-align:left;">
design
</td>
<td style="text-align:left;">
med
</td>
<td style="text-align:left;">
med vs low
</td>
<td style="text-align:left;">
Smed
</td>
<td style="text-align:left;">
500
</td>
<td style="text-align:left;">
0.00
</td>
<td style="text-align:left;">
0.39
</td>
<td style="text-align:left;">
0.09
</td>
<td style="text-align:left;">
0.93
</td>
<td style="text-align:left;">
0.20
</td>
<td style="text-align:left;">
0.39
</td>
<td style="text-align:left;">
0.38
</td>
<td style="text-align:left;">
0.04
</td>
<td style="text-align:left;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.00)
</td>
<td style="text-align:left;">
(0.03)
</td>
<td style="text-align:left;">
(0.00)
</td>
</tr>
</tbody>
</table></div>
<ul>
<li><p>It’s particularly nice, since we’re able to estimate the direct effect (whose constitutive POs we never observe) by partialling out spillovers.</p></li>
<li><p>Show here: power tradeoffs for main effects versus spillovers, in terms of
proportion of sample allocated to the “low” versus other conditions</p></li>
<li><p>and also in terms of IPW (equivalent sample size with everyone in the .5 condition)</p></li>
</ul>
<p>Now, we consider a model of spillovers in which fraud is displaced latitudinally,
from one neighbor to the next. Say, because there are roads traveling north and
fraudsters disregard boundaries (in reality, they are unlikely to do so).</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">distal_design</span> <span class="op">&lt;-</span> <span class="fu">replace_step</span><span class="op">(</span>design <span class="op">=</span> <span class="va">design</span>, step <span class="op">=</span> <span class="st">"spillover"</span>,
                              new_step <span class="op">=</span> <span class="fu">declare_step</span><span class="op">(</span>next_neighbor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">N</span>,<span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
                                                      spillover_low <span class="op">=</span> <span class="va">Z_S_low</span><span class="op">[</span><span class="va">next_neighbor</span><span class="op">]</span>,
                                                      spillover_med <span class="op">=</span> <span class="va">Z_S_med</span><span class="op">[</span><span class="va">next_neighbor</span><span class="op">]</span>,
                                                      spillover_high <span class="op">=</span> <span class="va">Z_S_high</span><span class="op">[</span><span class="va">next_neighbor</span><span class="op">]</span>,
                                                      handler <span class="op">=</span> <span class="va">fabricate</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">distal_diagnosis</span> <span class="op">&lt;-</span> <span class="fu">diagnose_design</span><span class="op">(</span><span class="va">distal_design</span>, sims <span class="op">=</span> <span class="va">sims</span><span class="op">)</span></code></pre></div>
<ul>
<li>When there are next-neighbor spillovers that ignore boundaries, the estimator is biased again</li>
</ul>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">distal_diagnosis</span> <span class="op">%&gt;%</span> <span class="fu">reshape_diagnosis</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
Design Label
</th>
<th style="text-align:left;">
Estimand Label
</th>
<th style="text-align:left;">
Estimator Label
</th>
<th style="text-align:left;">
Term
</th>
<th style="text-align:left;">
N Sims
</th>
<th style="text-align:left;">
Bias
</th>
<th style="text-align:left;">
RMSE
</th>
<th style="text-align:left;">
Power
</th>
<th style="text-align:left;">
Coverage
</th>
<th style="text-align:left;">
Mean Estimate
</th>
<th style="text-align:left;">
SD Estimate
</th>
<th style="text-align:left;">
Mean Se
</th>
<th style="text-align:left;">
Type S Rate
</th>
<th style="text-align:left;">
Mean Estimand
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
distal_design
</td>
<td style="text-align:left;">
ate_no_spill
</td>
<td style="text-align:left;">
main effect
</td>
<td style="text-align:left;">
Z
</td>
<td style="text-align:left;">
500
</td>
<td style="text-align:left;">
-0.25
</td>
<td style="text-align:left;">
0.43
</td>
<td style="text-align:left;">
0.23
</td>
<td style="text-align:left;">
0.88
</td>
<td style="text-align:left;">
-0.45
</td>
<td style="text-align:left;">
0.36
</td>
<td style="text-align:left;">
0.36
</td>
<td style="text-align:left;">
0.00
</td>
<td style="text-align:left;">
-0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.00)
</td>
<td style="text-align:left;">
(0.00)
</td>
<td style="text-align:left;">
(0.00)
</td>
</tr>
<tr>
<td style="text-align:left;">
distal_design
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
high vs low
</td>
<td style="text-align:left;">
Shigh
</td>
<td style="text-align:left;">
500
</td>
<td style="text-align:left;">
0.20
</td>
<td style="text-align:left;">
0.54
</td>
<td style="text-align:left;">
0.48
</td>
<td style="text-align:left;">
0.91
</td>
<td style="text-align:left;">
0.95
</td>
<td style="text-align:left;">
0.50
</td>
<td style="text-align:left;">
0.48
</td>
<td style="text-align:left;">
0.00
</td>
<td style="text-align:left;">
0.75
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.00)
</td>
<td style="text-align:left;">
(0.00)
</td>
</tr>
<tr>
<td style="text-align:left;">
distal_design
</td>
<td style="text-align:left;">
med
</td>
<td style="text-align:left;">
med vs low
</td>
<td style="text-align:left;">
Smed
</td>
<td style="text-align:left;">
500
</td>
<td style="text-align:left;">
0.15
</td>
<td style="text-align:left;">
0.42
</td>
<td style="text-align:left;">
0.33
</td>
<td style="text-align:left;">
0.92
</td>
<td style="text-align:left;">
0.65
</td>
<td style="text-align:left;">
0.40
</td>
<td style="text-align:left;">
0.41
</td>
<td style="text-align:left;">
0.00
</td>
<td style="text-align:left;">
0.50
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.02)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.00)
</td>
<td style="text-align:left;">
(0.00)
</td>
<td style="text-align:left;">
(0.00)
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="experimental-designs-for-causal-inference.html"><span class="header-section-number">17</span> Experimental designs for causal inference</a></div>
<div class="next"><a href="multi-study-designs.html"><span class="header-section-number">19</span> Multi-study designs</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li>
<a class="nav-link" href="#exercises-6"><span class="header-section-number">18</span> Exercises</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#online-appendix-applied-example-2"><span class="header-section-number">18.0.1</span> Online Appendix Applied Example</a></li>
<li><a class="nav-link" href="#design-declaration-4"><span class="header-section-number">18.0.2</span> Design Declaration</a></li>
</ul>
</li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Research Design: Declare, Diagnose, Redesign</strong>" was written by Graeme Blair, Jasper Cooper, Alexander Coppock, and Macartan Humphreys. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
