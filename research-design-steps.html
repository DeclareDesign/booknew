<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.4 Research design steps | Research Design: Declare, Diagnose, Redesign</title>
  <meta name="description" content="describe the book" />
  <meta name="generator" content="bookdown 0.13.2 and GitBook 2.6.7" />

  <meta property="og:title" content="3.4 Research design steps | Research Design: Declare, Diagnose, Redesign" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="describe the book" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.4 Research design steps | Research Design: Declare, Diagnose, Redesign" />
  
  <meta name="twitter:description" content="describe the book" />
  

<meta name="author" content="Graeme Blair, Jasper Cooper, Alexander Coppock, and Macartan Humphreys" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="building-a-step-of-a-research-design.html"/>
<link rel="next" href="building-a-design-from-design-steps.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="https://hypothes.is/embed.js" async></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="headers/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Research Design</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="preamble.html"><a href="preamble.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="mida.html"><a href="mida.html"><i class="fa fa-check"></i><b>2</b> MIDA</a><ul>
<li class="chapter" data-level="2.1" data-path="model-inquiry-data-strategy-model-strategy.html"><a href="model-inquiry-data-strategy-model-strategy.html"><i class="fa fa-check"></i><b>2.1</b> Model-Inquiry-Data Strategy-Model Strategy</a></li>
<li class="chapter" data-level="2.2" data-path="diagnosands-and-diagnosis.html"><a href="diagnosands-and-diagnosis.html"><i class="fa fa-check"></i><b>2.2</b> Diagnosands and diagnosis</a></li>
<li class="chapter" data-level="2.3" data-path="what-is-a-complete-design-declaration.html"><a href="what-is-a-complete-design-declaration.html"><i class="fa fa-check"></i><b>2.3</b> What is a <em>Complete</em> Design Declaration?</a></li>
<li class="chapter" data-level="2.4" data-path="declaration-diagnosis-redesign.html"><a href="declaration-diagnosis-redesign.html"><i class="fa fa-check"></i><b>2.4</b> Declaration-Diagnosis-Redesign</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="software-primer.html"><a href="software-primer.html"><i class="fa fa-check"></i><b>3</b> Software primer</a><ul>
<li class="chapter" data-level="3.1" data-path="installing-r.html"><a href="installing-r.html"><i class="fa fa-check"></i><b>3.1</b> Installing R</a></li>
<li class="chapter" data-level="3.2" data-path="where-we-are-going.html"><a href="where-we-are-going.html"><i class="fa fa-check"></i><b>3.2</b> Where we are going</a><ul>
<li class="chapter" data-level="3.2.1" data-path="where-we-are-going.html"><a href="where-we-are-going.html#declaring-a-design"><i class="fa fa-check"></i><b>3.2.1</b> Declaring a design</a></li>
<li class="chapter" data-level="3.2.2" data-path="where-we-are-going.html"><a href="where-we-are-going.html#diagnosis"><i class="fa fa-check"></i><b>3.2.2</b> Diagnosis</a></li>
<li class="chapter" data-level="3.2.3" data-path="where-we-are-going.html"><a href="where-we-are-going.html#redesign"><i class="fa fa-check"></i><b>3.2.3</b> Redesign</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="building-a-step-of-a-research-design.html"><a href="building-a-step-of-a-research-design.html"><i class="fa fa-check"></i><b>3.3</b> Building a step of a research design</a><ul>
<li class="chapter" data-level="3.3.1" data-path="building-a-step-of-a-research-design.html"><a href="building-a-step-of-a-research-design.html#using-dplyr"><i class="fa fa-check"></i><b>3.3.1</b> Using dplyr</a></li>
<li class="chapter" data-level="3.3.2" data-path="building-a-step-of-a-research-design.html"><a href="building-a-step-of-a-research-design.html#as-a-function"><i class="fa fa-check"></i><b>3.3.2</b> As a function</a></li>
<li class="chapter" data-level="3.3.3" data-path="building-a-step-of-a-research-design.html"><a href="building-a-step-of-a-research-design.html#in-declaredesign"><i class="fa fa-check"></i><b>3.3.3</b> In DeclareDesign</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="research-design-steps.html"><a href="research-design-steps.html"><i class="fa fa-check"></i><b>3.4</b> Research design steps</a><ul>
<li class="chapter" data-level="3.4.1" data-path="research-design-steps.html"><a href="research-design-steps.html#model"><i class="fa fa-check"></i><b>3.4.1</b> Model</a></li>
<li class="chapter" data-level="3.4.2" data-path="research-design-steps.html"><a href="research-design-steps.html#inquiry"><i class="fa fa-check"></i><b>3.4.2</b> Inquiry</a></li>
<li class="chapter" data-level="3.4.3" data-path="research-design-steps.html"><a href="research-design-steps.html#data-strategy"><i class="fa fa-check"></i><b>3.4.3</b> Data strategy</a></li>
<li class="chapter" data-level="3.4.4" data-path="research-design-steps.html"><a href="research-design-steps.html#answer-strategy"><i class="fa fa-check"></i><b>3.4.4</b> Answer strategy</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="building-a-design-from-design-steps.html"><a href="building-a-design-from-design-steps.html"><i class="fa fa-check"></i><b>3.5</b> Building a design from design steps</a><ul>
<li class="chapter" data-level="3.5.1" data-path="building-a-design-from-design-steps.html"><a href="building-a-design-from-design-steps.html#order-matters"><i class="fa fa-check"></i><b>3.5.1</b> Order matters</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="simulating-a-research-design.html"><a href="simulating-a-research-design.html"><i class="fa fa-check"></i><b>3.6</b> Simulating a research design</a><ul>
<li class="chapter" data-level="3.6.1" data-path="simulating-a-research-design.html"><a href="simulating-a-research-design.html#in-dplyr"><i class="fa fa-check"></i><b>3.6.1</b> In <code>dplyr</code></a></li>
<li class="chapter" data-level="3.6.2" data-path="simulating-a-research-design.html"><a href="simulating-a-research-design.html#in-declaredesign-1"><i class="fa fa-check"></i><b>3.6.2</b> In <code>DeclareDesign</code></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="diagnosing-a-research-design.html"><a href="diagnosing-a-research-design.html"><i class="fa fa-check"></i><b>3.7</b> Diagnosing a research design</a></li>
<li class="chapter" data-level="3.8" data-path="comparing-designs.html"><a href="comparing-designs.html"><i class="fa fa-check"></i><b>3.8</b> Comparing designs</a><ul>
<li class="chapter" data-level="3.8.1" data-path="comparing-designs.html"><a href="comparing-designs.html#comparing-many-variants-of-a-design"><i class="fa fa-check"></i><b>3.8.1</b> Comparing many variants of a design</a></li>
<li class="chapter" data-level="3.8.2" data-path="comparing-designs.html"><a href="comparing-designs.html#library-of-designs"><i class="fa fa-check"></i><b>3.8.2</b> Library of designs</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Declaration and Diagnosis in Practice</b></span></li>
<li class="chapter" data-level="4" data-path="research-questions.html"><a href="research-questions.html"><i class="fa fa-check"></i><b>4</b> Research questions</a></li>
<li class="chapter" data-level="5" data-path="specifying-the-model.html"><a href="specifying-the-model.html"><i class="fa fa-check"></i><b>5</b> Specifying the model</a><ul>
<li class="chapter" data-level="5.1" data-path="declaring-exogenous-and-endogenous-variables-in-the-population.html"><a href="declaring-exogenous-and-endogenous-variables-in-the-population.html"><i class="fa fa-check"></i><b>5.1</b> Declaring exogenous and endogenous variables in the population</a></li>
<li class="chapter" data-level="5.2" data-path="declaring-potential-outcomes.html"><a href="declaring-potential-outcomes.html"><i class="fa fa-check"></i><b>5.2</b> Declaring potential outcomes</a><ul>
<li class="chapter" data-level="5.2.1" data-path="declaring-potential-outcomes.html"><a href="declaring-potential-outcomes.html#potential-outcomes-can-include-variables-that-are-not-yet-defined"><i class="fa fa-check"></i><b>5.2.1</b> Potential outcomes can include variables that are not yet defined</a></li>
<li class="chapter" data-level="5.2.2" data-path="declaring-potential-outcomes.html"><a href="declaring-potential-outcomes.html#when-you-do-and-do-not-need-to-define-potential-outcomes"><i class="fa fa-check"></i><b>5.2.2</b> When you do and do not need to define potential outcomes</a></li>
<li class="chapter" data-level="5.2.3" data-path="declaring-potential-outcomes.html"><a href="declaring-potential-outcomes.html#manipulation-creates-potential-outcomes"><i class="fa fa-check"></i><b>5.2.3</b> Manipulation creates potential outcomes</a></li>
<li class="chapter" data-level="5.2.4" data-path="declaring-potential-outcomes.html"><a href="declaring-potential-outcomes.html#interference-creates-potential-outcomes"><i class="fa fa-check"></i><b>5.2.4</b> Interference creates potential outcomes</a></li>
<li class="chapter" data-level="5.2.5" data-path="declaring-potential-outcomes.html"><a href="declaring-potential-outcomes.html#what-to-do-with-potential-outcomes-whose-parents-are-continuous"><i class="fa fa-check"></i><b>5.2.5</b> What to do with potential outcomes whose parents are continuous</a></li>
<li class="chapter" data-level="5.2.6" data-path="declaring-potential-outcomes.html"><a href="declaring-potential-outcomes.html#principal-strata-can-be-defined-in-terms-of-potential-outcomes"><i class="fa fa-check"></i><b>5.2.6</b> Principal strata can be defined in terms of potential outcomes</a></li>
<li class="chapter" data-level="5.2.7" data-path="declaring-potential-outcomes.html"><a href="declaring-potential-outcomes.html#develop-a-null-model"><i class="fa fa-check"></i><b>5.2.7</b> Develop a null model</a></li>
<li class="chapter" data-level="5.2.8" data-path="declaring-potential-outcomes.html"><a href="declaring-potential-outcomes.html#consider-heterogeneity"><i class="fa fa-check"></i><b>5.2.8</b> Consider heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="declaring-populations.html"><a href="declaring-populations.html"><i class="fa fa-check"></i><b>5.3</b> Declaring populations</a><ul>
<li class="chapter" data-level="5.3.1" data-path="declaring-populations.html"><a href="declaring-populations.html#use-data-if-you-have-it"><i class="fa fa-check"></i><b>5.3.1</b> Use data, if you have it</a></li>
<li class="chapter" data-level="5.3.2" data-path="declaring-populations.html"><a href="declaring-populations.html#incorporate-hierarchy-into-your-model"><i class="fa fa-check"></i><b>5.3.2</b> Incorporate hierarchy into your model</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="without-a-model-you-can-get-the-answer-pretty-wrong.html"><a href="without-a-model-you-can-get-the-answer-pretty-wrong.html"><i class="fa fa-check"></i><b>5.4</b> Without a model you can get the answer pretty wrong</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="defining-the-inquiry.html"><a href="defining-the-inquiry.html"><i class="fa fa-check"></i><b>6</b> Defining the Inquiry</a><ul>
<li class="chapter" data-level="6.1" data-path="classes-of-estimands.html"><a href="classes-of-estimands.html"><i class="fa fa-check"></i><b>6.1</b> Classes of estimands</a><ul>
<li class="chapter" data-level="6.1.1" data-path="classes-of-estimands.html"><a href="classes-of-estimands.html#descriptive-estimands"><i class="fa fa-check"></i><b>6.1.1</b> Descriptive estimands</a></li>
<li class="chapter" data-level="6.1.2" data-path="classes-of-estimands.html"><a href="classes-of-estimands.html#simple-causal-estimands"><i class="fa fa-check"></i><b>6.1.2</b> Simple causal estimands</a></li>
<li class="chapter" data-level="6.1.3" data-path="classes-of-estimands.html"><a href="classes-of-estimands.html#local-estimands-estiamnds-over-latent-classes-principal-strata"><i class="fa fa-check"></i><b>6.1.3</b> Local estimands / EStiamnds over latent classes, principal strata</a></li>
<li class="chapter" data-level="6.1.4" data-path="classes-of-estimands.html"><a href="classes-of-estimands.html#study-dependent-estimands"><i class="fa fa-check"></i><b>6.1.4</b> Study dependent estimands</a></li>
<li class="chapter" data-level="6.1.5" data-path="classes-of-estimands.html"><a href="classes-of-estimands.html#complex-counterfactuals"><i class="fa fa-check"></i><b>6.1.5</b> Complex counterfactuals</a></li>
<li class="chapter" data-level="6.1.6" data-path="classes-of-estimands.html"><a href="classes-of-estimands.html#parametric-estimands"><i class="fa fa-check"></i><b>6.1.6</b> Parametric estimands</a></li>
<li class="chapter" data-level="6.1.7" data-path="classes-of-estimands.html"><a href="classes-of-estimands.html#vector-valued-inquiries-set-of-predictions-for-n-units"><i class="fa fa-check"></i><b>6.1.7</b> Vector-valued inquiries (set of predictions for N units),</a></li>
<li class="chapter" data-level="6.1.8" data-path="classes-of-estimands.html"><a href="classes-of-estimands.html#models-as-estimands"><i class="fa fa-check"></i><b>6.1.8</b> Models as estimands</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="selecting-estimands.html"><a href="selecting-estimands.html"><i class="fa fa-check"></i><b>6.2</b> Selecting estimands</a><ul>
<li class="chapter" data-level="6.2.1" data-path="selecting-estimands.html"><a href="selecting-estimands.html#you-are-responsible-for-your-estimand"><i class="fa fa-check"></i><b>6.2.1</b> You are responsible for your estimand</a></li>
<li class="chapter" data-level="6.2.2" data-path="selecting-estimands.html"><a href="selecting-estimands.html#estimands-to-purpose.-choice-of-inquiry-is-not-valueless"><i class="fa fa-check"></i><b>6.2.2</b> Estimands to purpose. Choice of inquiry is not valueless</a></li>
<li class="chapter" data-level="6.2.3" data-path="selecting-estimands.html"><a href="selecting-estimands.html#estimand-scopewhat-is-the-set-of-units-which-you-want-to-learn-the-answer-about-know-what-ate-averages-over"><i class="fa fa-check"></i><b>6.2.3</b> Estimand scope:What is the set of units which you want to learn the answer about? Know what ATE averages over</a></li>
<li class="chapter" data-level="6.2.4" data-path="selecting-estimands.html"><a href="selecting-estimands.html#unknown-estimands-inquiries-for-discovery"><i class="fa fa-check"></i><b>6.2.4</b> Unknown estimands: Inquiries for discovery</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="crafting-a-data-strategy.html"><a href="crafting-a-data-strategy.html"><i class="fa fa-check"></i><b>7</b> Crafting a data strategy</a><ul>
<li class="chapter" data-level="7.1" data-path="choosing-a-sampling-procedure.html"><a href="choosing-a-sampling-procedure.html"><i class="fa fa-check"></i><b>7.1</b> Choosing a sampling procedure</a></li>
<li class="chapter" data-level="7.2" data-path="choosing-an-assignment-procedure.html"><a href="choosing-an-assignment-procedure.html"><i class="fa fa-check"></i><b>7.2</b> Choosing an assignment procedure</a></li>
<li class="chapter" data-level="7.3" data-path="choosing-a-measurement-procedure.html"><a href="choosing-a-measurement-procedure.html"><i class="fa fa-check"></i><b>7.3</b> Choosing a measurement procedure</a></li>
<li class="chapter" data-level="7.4" data-path="section.html"><a href="section.html"><i class="fa fa-check"></i><b>7.4</b> </a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="choosing-an-answer-strategy.html"><a href="choosing-an-answer-strategy.html"><i class="fa fa-check"></i><b>8</b> Choosing an answer strategy</a><ul>
<li class="chapter" data-level="8.1" data-path="what-is-included-in-an-answer-strategy.html"><a href="what-is-included-in-an-answer-strategy.html"><i class="fa fa-check"></i><b>8.1</b> What is included in an answer strategy</a></li>
<li class="chapter" data-level="8.2" data-path="what-are-the-properties-of-a-good-answer-strategy.html"><a href="what-are-the-properties-of-a-good-answer-strategy.html"><i class="fa fa-check"></i><b>8.2</b> what are the properties of a good answer strategy</a></li>
<li class="chapter" data-level="8.3" data-path="how-to-select-an-answer-strategy.html"><a href="how-to-select-an-answer-strategy.html"><i class="fa fa-check"></i><b>8.3</b> how to select an answer strategy</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="diagnosis-1.html"><a href="diagnosis-1.html"><i class="fa fa-check"></i><b>9</b> Diagnosis</a><ul>
<li class="chapter" data-level="9.1" data-path="diagnosing-a-single-design.html"><a href="diagnosing-a-single-design.html"><i class="fa fa-check"></i><b>9.1</b> Diagnosing a single design</a></li>
<li class="chapter" data-level="9.2" data-path="how-do-you-select-diagnosands.html"><a href="how-do-you-select-diagnosands.html"><i class="fa fa-check"></i><b>9.2</b> How do you select diagnosands?</a></li>
<li class="chapter" data-level="9.3" data-path="diagnosis-to-assess-the-robustness-of-designs-to-models-gb.html"><a href="diagnosis-to-assess-the-robustness-of-designs-to-models-gb.html"><i class="fa fa-check"></i><b>9.3</b> Diagnosis to assess the robustness of designs to models [GB]</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="redesign-1.html"><a href="redesign-1.html"><i class="fa fa-check"></i><b>10</b> Redesign</a></li>
<li class="part"><span><b>III Design Library</b></span></li>
<li class="chapter" data-level="11" data-path="design-library.html"><a href="design-library.html"><i class="fa fa-check"></i><b>11</b> Design Library</a></li>
<li class="chapter" data-level="12" data-path="observational-designs-for-descriptive-inference.html"><a href="observational-designs-for-descriptive-inference.html"><i class="fa fa-check"></i><b>12</b> Observational designs for descriptive inference</a><ul>
<li class="chapter" data-level="12.1" data-path="random-sampling.html"><a href="random-sampling.html"><i class="fa fa-check"></i><b>12.1</b> Random sampling</a><ul>
<li class="chapter" data-level="12.1.1" data-path="random-sampling.html"><a href="random-sampling.html#simple-random-sampling"><i class="fa fa-check"></i><b>12.1.1</b> Simple random sampling</a></li>
<li class="chapter" data-level="12.1.2" data-path="random-sampling.html"><a href="random-sampling.html#stratified-and-clustered-random-sampling"><i class="fa fa-check"></i><b>12.1.2</b> Stratified and clustered random sampling</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="multilevel-regression-and-poststratification.html"><a href="multilevel-regression-and-poststratification.html"><i class="fa fa-check"></i><b>12.2</b> Multilevel regression and poststratification</a></li>
<li class="chapter" data-level="12.3" data-path="inference-about-unobserved-variables.html"><a href="inference-about-unobserved-variables.html"><i class="fa fa-check"></i><b>12.3</b> Inference about unobserved variables</a></li>
<li class="chapter" data-level="12.4" data-path="structural-estimation.html"><a href="structural-estimation.html"><i class="fa fa-check"></i><b>12.4</b> Structural estimation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="experimental-designs-for-descriptive-inference.html"><a href="experimental-designs-for-descriptive-inference.html"><i class="fa fa-check"></i><b>13</b> Experimental designs for descriptive inference</a><ul>
<li class="chapter" data-level="13.1" data-path="audit-experiments.html"><a href="audit-experiments.html"><i class="fa fa-check"></i><b>13.1</b> Audit experiments</a><ul>
<li class="chapter" data-level="13.1.1" data-path="audit-experiments.html"><a href="audit-experiments.html#design-declaration-2"><i class="fa fa-check"></i><b>13.1.1</b> Design Declaration</a></li>
<li class="chapter" data-level="13.1.2" data-path="audit-experiments.html"><a href="audit-experiments.html#takeaways-2"><i class="fa fa-check"></i><b>13.1.2</b> Takeaways</a></li>
<li class="chapter" data-level="13.1.3" data-path="audit-experiments.html"><a href="audit-experiments.html#applications"><i class="fa fa-check"></i><b>13.1.3</b> Applications</a></li>
<li class="chapter" data-level="13.1.4" data-path="audit-experiments.html"><a href="audit-experiments.html#exercises-1"><i class="fa fa-check"></i><b>13.1.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="experiments-for-sensitive-questions.html"><a href="experiments-for-sensitive-questions.html"><i class="fa fa-check"></i><b>13.2</b> Experiments for sensitive questions</a><ul>
<li class="chapter" data-level="13.2.1" data-path="experiments-for-sensitive-questions.html"><a href="experiments-for-sensitive-questions.html#list-experiments"><i class="fa fa-check"></i><b>13.2.1</b> List experiments</a></li>
<li class="chapter" data-level="13.2.2" data-path="experiments-for-sensitive-questions.html"><a href="experiments-for-sensitive-questions.html#randomized-response-technique"><i class="fa fa-check"></i><b>13.2.2</b> Randomized response technique</a></li>
<li class="chapter" data-level="13.2.3" data-path="experiments-for-sensitive-questions.html"><a href="experiments-for-sensitive-questions.html#references"><i class="fa fa-check"></i><b>13.2.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="conjoint-experimetns.html"><a href="conjoint-experimetns.html"><i class="fa fa-check"></i><b>13.3</b> Conjoint experimetns</a></li>
<li class="chapter" data-level="13.4" data-path="behavioral-games.html"><a href="behavioral-games.html"><i class="fa fa-check"></i><b>13.4</b> Behavioral games</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="observational-designs-for-causal-inference.html"><a href="observational-designs-for-causal-inference.html"><i class="fa fa-check"></i><b>14</b> Observational designs for causal inference</a><ul>
<li class="chapter" data-level="14.1" data-path="selection-on-observables.html"><a href="selection-on-observables.html"><i class="fa fa-check"></i><b>14.1</b> Selection on observables</a><ul>
<li class="chapter" data-level="14.1.1" data-path="selection-on-observables.html"><a href="selection-on-observables.html#classic-confounding"><i class="fa fa-check"></i><b>14.1.1</b> Classic Confounding</a></li>
<li class="chapter" data-level="14.1.2" data-path="selection-on-observables.html"><a href="selection-on-observables.html#what-if-the-functional-form-is-wrong"><i class="fa fa-check"></i><b>14.1.2</b> What if the functional form is wrong?</a></li>
<li class="chapter" data-level="14.1.3" data-path="selection-on-observables.html"><a href="selection-on-observables.html#what-if-you-have-unobserved-confounding"><i class="fa fa-check"></i><b>14.1.3</b> What if you have unobserved confounding?</a></li>
<li class="chapter" data-level="14.1.4" data-path="selection-on-observables.html"><a href="selection-on-observables.html#what-if-the-observed-covariate-is-post-treatment"><i class="fa fa-check"></i><b>14.1.4</b> What if the observed covariate is post-treatment?</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="instrumental-variables.html"><a href="instrumental-variables.html"><i class="fa fa-check"></i><b>14.2</b> Instrumental variables</a></li>
<li class="chapter" data-level="14.3" data-path="difference-in-differences.html"><a href="difference-in-differences.html"><i class="fa fa-check"></i><b>14.3</b> Difference in differences</a><ul>
<li class="chapter" data-level="14.3.1" data-path="difference-in-differences.html"><a href="difference-in-differences.html#two-period-two-group-setting"><i class="fa fa-check"></i><b>14.3.1</b> Two-period two-group setting</a></li>
<li class="chapter" data-level="14.3.2" data-path="difference-in-differences.html"><a href="difference-in-differences.html#parallel-trends-assumption"><i class="fa fa-check"></i><b>14.3.2</b> Parallel trends assumption</a></li>
<li class="chapter" data-level="14.3.3" data-path="difference-in-differences.html"><a href="difference-in-differences.html#multi-period-design"><i class="fa fa-check"></i><b>14.3.3</b> Multi-period design</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html"><i class="fa fa-check"></i><b>14.4</b> Regression Discontinuity</a><ul>
<li class="chapter" data-level="14.4.1" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#design-declaration-3"><i class="fa fa-check"></i><b>14.4.1</b> Design Declaration</a></li>
<li class="chapter" data-level="14.4.2" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#takeaways-3"><i class="fa fa-check"></i><b>14.4.2</b> Takeaways</a></li>
<li class="chapter" data-level="14.4.3" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#further-reading"><i class="fa fa-check"></i><b>14.4.3</b> Further Reading</a></li>
<li class="chapter" data-level="14.4.4" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#exercises-2"><i class="fa fa-check"></i><b>14.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="process-tracing.html"><a href="process-tracing.html"><i class="fa fa-check"></i><b>14.5</b> Process tracing</a></li>
<li class="chapter" data-level="14.6" data-path="synthetic-controls.html"><a href="synthetic-controls.html"><i class="fa fa-check"></i><b>14.6</b> Synthetic controls</a><ul>
<li class="chapter" data-level="14.6.1" data-path="synthetic-controls.html"><a href="synthetic-controls.html#references-1"><i class="fa fa-check"></i><b>14.6.1</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="experimental-designs-for-causal-inference.html"><a href="experimental-designs-for-causal-inference.html"><i class="fa fa-check"></i><b>15</b> Experimental designs for causal inference</a><ul>
<li class="chapter" data-level="15.1" data-path="two-arm-trials.html"><a href="two-arm-trials.html"><i class="fa fa-check"></i><b>15.1</b> Two arm trials</a></li>
<li class="chapter" data-level="15.2" data-path="two-arm-trials-and-designs-with-blocking-and-clustering.html"><a href="two-arm-trials-and-designs-with-blocking-and-clustering.html"><i class="fa fa-check"></i><b>15.2</b> Two-arm trials and designs with blocking and clustering</a></li>
<li class="chapter" data-level="15.3" data-path="multiarm-designs.html"><a href="multiarm-designs.html"><i class="fa fa-check"></i><b>15.3</b> Multiarm Designs</a></li>
<li class="chapter" data-level="15.4" data-path="encouragement-designs.html"><a href="encouragement-designs.html"><i class="fa fa-check"></i><b>15.4</b> Encouragement designs</a><ul>
<li class="chapter" data-level="15.4.1" data-path="encouragement-designs.html"><a href="encouragement-designs.html#references-2"><i class="fa fa-check"></i><b>15.4.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="stepped-wedge-designs.html"><a href="stepped-wedge-designs.html"><i class="fa fa-check"></i><b>15.5</b> Stepped wedge designs</a><ul>
<li class="chapter" data-level="15.5.1" data-path="stepped-wedge-designs.html"><a href="stepped-wedge-designs.html#design-declaration-4"><i class="fa fa-check"></i><b>15.5.1</b> Design Declaration</a></li>
<li class="chapter" data-level="15.5.2" data-path="stepped-wedge-designs.html"><a href="stepped-wedge-designs.html#references-3"><i class="fa fa-check"></i><b>15.5.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="partial-population-design.html"><a href="partial-population-design.html"><i class="fa fa-check"></i><b>15.6</b> Partial Population Design</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="multi-study-designs.html"><a href="multi-study-designs.html"><i class="fa fa-check"></i><b>16</b> Multi-study designs</a><ul>
<li class="chapter" data-level="16.1" data-path="papers-with-multiple-studies.html"><a href="papers-with-multiple-studies.html"><i class="fa fa-check"></i><b>16.1</b> Papers with multiple studies</a></li>
<li class="chapter" data-level="16.2" data-path="multi-site-studies.html"><a href="multi-site-studies.html"><i class="fa fa-check"></i><b>16.2</b> Multi-site studies</a></li>
</ul></li>
<li class="part"><span><b>IV Conclusion</b></span></li>
<li class="chapter" data-level="17" data-path="putting-designs-to-use.html"><a href="putting-designs-to-use.html"><i class="fa fa-check"></i><b>17</b> Putting Designs to Use</a><ul>
<li class="chapter" data-level="17.1" data-path="before-studies.html"><a href="before-studies.html"><i class="fa fa-check"></i><b>17.1</b> Before studies</a><ul>
<li class="chapter" data-level="17.1.1" data-path="before-studies.html"><a href="before-studies.html#pre-analysis-plans"><i class="fa fa-check"></i><b>17.1.1</b> Pre-Analysis Plans</a></li>
<li class="chapter" data-level="17.1.2" data-path="before-studies.html"><a href="before-studies.html#registered-reports"><i class="fa fa-check"></i><b>17.1.2</b> Registered Reports</a></li>
<li class="chapter" data-level="17.1.3" data-path="before-studies.html"><a href="before-studies.html#standard-operating-procedures"><i class="fa fa-check"></i><b>17.1.3</b> Standard Operating Procedures</a></li>
<li class="chapter" data-level="17.1.4" data-path="before-studies.html"><a href="before-studies.html#evaluating-and-supporting-research"><i class="fa fa-check"></i><b>17.1.4</b> Evaluating and Supporting Research</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="after-studies.html"><a href="after-studies.html"><i class="fa fa-check"></i><b>17.2</b> After studies</a><ul>
<li class="chapter" data-level="17.2.1" data-path="after-studies.html"><a href="after-studies.html#reconciliation"><i class="fa fa-check"></i><b>17.2.1</b> Reconciliation</a></li>
<li class="chapter" data-level="17.2.2" data-path="after-studies.html"><a href="after-studies.html#replication"><i class="fa fa-check"></i><b>17.2.2</b> Replication</a></li>
<li class="chapter" data-level="17.2.3" data-path="after-studies.html"><a href="after-studies.html#peers-better-scholarly-critique"><i class="fa fa-check"></i><b>17.2.3</b> Peers: Better scholarly critique</a></li>
<li class="chapter" data-level="17.2.4" data-path="after-studies.html"><a href="after-studies.html#combining-designs"><i class="fa fa-check"></i><b>17.2.4</b> Combining designs</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="improving-designs-in-the-social-sciences.html"><a href="improving-designs-in-the-social-sciences.html"><i class="fa fa-check"></i><b>17.3</b> Improving designs in the social sciences</a><ul>
<li class="chapter" data-level="17.3.1" data-path="improving-designs-in-the-social-sciences.html"><a href="improving-designs-in-the-social-sciences.html#a-library-of-research-designs-as-objects"><i class="fa fa-check"></i><b>17.3.1</b> A library of research designs as objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-4.html"><a href="references-4.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://declaredesign.org" target="blank">DeclareDesign</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Research Design: Declare, Diagnose, Redesign</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="research-design-steps" class="section level2">
<h2><span class="header-section-number">3.4</span> Research design steps</h2>
<p>In this section, we walk through how to declare each step of a research design using <code>DeclareDesign</code>. In the next section, we build those steps into a research design, and then describe how to interrogate the design.</p>
<div id="model" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Model</h3>
<p>The model defines the structure of the world, both its size and background characteristics as well as how interventions in the world determine outcomes. In <code>DeclareDesign</code>, we split the model into two main design steps: the population and potential outcomes. There is always one population in a design, but there can be multiple sets of potential outcomes.</p>
<div id="population" class="section level4">
<h4><span class="header-section-number">3.4.1.1</span> Population</h4>
<p>The population defines the number of units in the population, any multilevel structure to the data, and its background characteristics. We can define the population in several ways.</p>
<p>In some cases, you may start a design with data on the population. When that happens, we do not to simulate it. We can simply declare the data as our population:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">declare_population</span>(<span class="dt">data =</span> voter_file)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
sex
</th>
<th style="text-align:left;">
party
</th>
<th style="text-align:right;">
precinct
</th>
<th style="text-align:right;">
Z
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
DEM
</td>
<td style="text-align:right;">
7356
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
REP
</td>
<td style="text-align:right;">
8304
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
GRN
</td>
<td style="text-align:right;">
6938
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
GRN
</td>
<td style="text-align:right;">
2962
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
GRN
</td>
<td style="text-align:right;">
2786
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
DEM
</td>
<td style="text-align:right;">
7684
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>When we do not have complete data on the population, we simulate it. Relying on the data simulation functions from our <code>fabricatr</code> package, <code>declare_population</code> asks about the size and variables of the population:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">declare_population</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">u =</span> <span class="kw">rnorm</span>(N))</a></code></pre></div>
<p>When we run the declared population function, we will get a different 100-unit dataset each time:</p>
<table class="kable_wrapper table" style="margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
0.7407205
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
0.3985774
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
0.2702093
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
-0.5732857
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
-0.9383636
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
0.4507827
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
0.7755814
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
1.0701341
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
-0.4472873
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
-0.6483019
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
0.6602731
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
-0.5028638
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
-0.7679974
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
0.7701792
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
0.3013880
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
-0.2919992
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
-0.1680557
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
-1.7205452
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>The <code>fabricatr</code> package can simulate data for social science research including multilevel data structures like students in classrooms in schools. You can read the <code>fabricatr</code> Web site to get started simulating your data structure (link). A simple two-level data structure of individuals within households could be declared as:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">declare_population</span>(</a>
<a class="sourceLine" id="cb15-2" title="2">  <span class="dt">households =</span> <span class="kw">add_level</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">individuals_per_hh =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>)),</a>
<a class="sourceLine" id="cb15-3" title="3">  <span class="dt">individuals =</span> <span class="kw">add_level</span>(<span class="dt">N =</span> individuals_per_hh, <span class="dt">age =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb15-4" title="4">)</a></code></pre></div>
<p>In every step of the research design process, you can short-circuit our default way of doing things and bring in your own code. This is useful when you have a complex design, or when you’ve already written code for your design and you want to use it directly. It works by setting the handler:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">complex_population_function &lt;-<span class="st"> </span><span class="cf">function</span>(data, N_units) {</a>
<a class="sourceLine" id="cb16-2" title="2">  <span class="kw">data.frame</span>(<span class="dt">u =</span> <span class="kw">rnorm</span>(N_units))</a>
<a class="sourceLine" id="cb16-3" title="3">}</a>
<a class="sourceLine" id="cb16-4" title="4"></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="kw">declare_population</span>(<span class="dt">handler =</span> complex_population_function, <span class="dt">N_units =</span> <span class="dv">100</span>)</a></code></pre></div>
</div>
<div id="potential-outcomes" class="section level4">
<h4><span class="header-section-number">3.4.1.2</span> Potential outcomes</h4>
<p>Defining potential outcomes is as easy as a single expression per potential outcome. These may be a function of background characteristics, other potential outcomes, or other R functions.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">declare_potential_outcomes</span>(</a>
<a class="sourceLine" id="cb17-2" title="2">  <span class="dt">Y_Z_0 =</span> u, </a>
<a class="sourceLine" id="cb17-3" title="3">  <span class="dt">Y_Z_1 =</span> Y_Z_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span>)</a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">des &lt;-<span class="st"> </span><span class="kw">declare_population</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">u =</span> <span class="kw">rnorm</span>(N)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="st">  </span><span class="kw">declare_potential_outcomes</span>(<span class="dt">Y_Z_0 =</span> u, <span class="dt">Y_Z_1 =</span> Y_Z_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb18-3" title="3"></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="kw">draw_data</span>(des)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
<th style="text-align:right;">
Y_Z_0
</th>
<th style="text-align:right;">
Y_Z_1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
-0.5633013
</td>
<td style="text-align:right;">
-0.5633013
</td>
<td style="text-align:right;">
-0.3133013
</td>
</tr>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
-0.3622719
</td>
<td style="text-align:right;">
-0.3622719
</td>
<td style="text-align:right;">
-0.1122719
</td>
</tr>
<tr>
<td style="text-align:left;">
003
</td>
<td style="text-align:right;">
0.8327629
</td>
<td style="text-align:right;">
0.8327629
</td>
<td style="text-align:right;">
1.0827629
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
1.0283249
</td>
<td style="text-align:right;">
1.0283249
</td>
<td style="text-align:right;">
1.2783249
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
0.0921662
</td>
<td style="text-align:right;">
0.0921662
</td>
<td style="text-align:right;">
0.3421662
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
-0.0714467
</td>
<td style="text-align:right;">
-0.0714467
</td>
<td style="text-align:right;">
0.1785533
</td>
</tr>
</tbody>
</table>
<p>We also have a simpler interface to define all the potential outcomes at once as a function of a treatment assignment variable. The names of the potential outcomes are constructed from the outcome name (here <code>Y</code> on the lefthand side of the formula) and from the <code>assignment_variables</code> argument (here <code>Z</code>).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">declare_potential_outcomes</span>(Y <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span> <span class="op">*</span><span class="st"> </span>Z, <span class="dt">assignment_variables =</span> Z)</a></code></pre></div>
<p>Either way of creating potential outcomes works; one may be easier or harder to code up in a given research design setting.</p>
</div>
</div>
<div id="inquiry" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Inquiry</h3>
<p>To define your inquiry, declare your estimand, which is a function of background characteristics from your population, potential outcomes, or both. We define the average treatment effect for the experiment in our simple design as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">declare_estimand</span>(<span class="dt">PATE =</span> <span class="kw">mean</span>(Y_Z_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>Y_Z_<span class="dv">0</span>))</a></code></pre></div>
<p>Notice that we defined the PATE (the <em>population</em> average treatment effect), but said nothing special related to the population. In fact, it looks like we just defined the average treatment effect. This is because where you define the estimand in your design is going to determine whether it refers to the population, sample, or other form of estimand. We will see how to do this in a moment.</p>
</div>
<div id="data-strategy" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Data strategy</h3>
<p>The data strategy constitutes one or more steps representing interventions the researcher makes in the world from sampling to assignment to measurement. Typically, this may include sampling and assignment.</p>
<div id="sampling" class="section level4">
<h4><span class="header-section-number">3.4.3.1</span> Sampling</h4>
<p>The sampling step relies on the <code>randomizr</code> package to conduct random sampling. See Section XX for an overview of the many kinds of sampling that are possible. We define a simple 50-unit sample from the population as follows:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">declare_sampling</span>(<span class="dt">n =</span> <span class="dv">50</span>)</a></code></pre></div>
<p>When we draw data from our simple design at this point, it will be smaller: from 100 units in the population to a data frame of 50 units representing the sample. In the data frame, we have an inclusion probability, the probability of being included in the sample. <code>randomizr</code> includes this by default. In this case, every unit in the population had an equal 0.5 probability of inclusion.</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
<th style="text-align:right;">
Y_Z_0
</th>
<th style="text-align:right;">
Y_Z_1
</th>
<th style="text-align:right;">
S_inclusion_prob
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
-1.0979048
</td>
<td style="text-align:right;">
-1.0979048
</td>
<td style="text-align:right;">
-0.8479048
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
-1.7728570
</td>
<td style="text-align:right;">
-1.7728570
</td>
<td style="text-align:right;">
-1.5228570
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
0.8503419
</td>
<td style="text-align:right;">
0.8503419
</td>
<td style="text-align:right;">
1.1003419
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
008
</td>
<td style="text-align:right;">
-1.2356806
</td>
<td style="text-align:right;">
-1.2356806
</td>
<td style="text-align:right;">
-0.9856806
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
014
</td>
<td style="text-align:right;">
0.4806454
</td>
<td style="text-align:right;">
0.4806454
</td>
<td style="text-align:right;">
0.7306454
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
015
</td>
<td style="text-align:right;">
-0.1852486
</td>
<td style="text-align:right;">
-0.1852486
</td>
<td style="text-align:right;">
0.0647514
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
</tbody>
</table>
<p>Sampling could also be non-random, which could be accomplished by using a handler.</p>
</div>
<div id="assignment" class="section level4">
<h4><span class="header-section-number">3.4.3.2</span> Assignment</h4>
<p>Assignment also relies, by default, on the <code>randomizr</code> package for random assignment. Here, we define assignment as a 50% probability of assignment to treatment and 50% to control.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">declare_assignment</span>(<span class="dt">prob =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p>Assignment results in a data frame with an additional indicator <code>Z</code> of the assignment as well as the probability of assignment. Again, here the assignment probabilities are constant, but in other designs described in Section XX they are not and this is crucial information for the analysis stage.</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
<th style="text-align:right;">
Y_Z_0
</th>
<th style="text-align:right;">
Y_Z_1
</th>
<th style="text-align:right;">
S_inclusion_prob
</th>
<th style="text-align:right;">
Z
</th>
<th style="text-align:right;">
Z_cond_prob
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
001
</td>
<td style="text-align:right;">
-1.9161518
</td>
<td style="text-align:right;">
-1.9161518
</td>
<td style="text-align:right;">
-1.6661518
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
-0.5141478
</td>
<td style="text-align:right;">
-0.5141478
</td>
<td style="text-align:right;">
-0.2641478
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
-0.4908343
</td>
<td style="text-align:right;">
-0.4908343
</td>
<td style="text-align:right;">
-0.2408343
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
007
</td>
<td style="text-align:right;">
0.3331834
</td>
<td style="text-align:right;">
0.3331834
</td>
<td style="text-align:right;">
0.5831834
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
008
</td>
<td style="text-align:right;">
0.8697393
</td>
<td style="text-align:right;">
0.8697393
</td>
<td style="text-align:right;">
1.1197393
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
010
</td>
<td style="text-align:right;">
-1.3602271
</td>
<td style="text-align:right;">
-1.3602271
</td>
<td style="text-align:right;">
-1.1102271
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
</tbody>
</table>
</div>
<div id="other-data-strategies" class="section level4">
<h4><span class="header-section-number">3.4.3.3</span> Other data strategies</h4>
<p>Random sampling and random assignment are not the only kinds of data strategies. Others may include merging in fixed administrative data from other sources, collapsing data across months or days, and other operations. You can include these as steps in your design too, using <code>declare_step</code>. Here, you must define a handler, as we did for using a custom function in <code>declare_population</code>. Some handlers that may prove useful are the <code>dplyr</code> verbs such as <code>mutate</code> and <code>summarize</code>, and the <code>fabricate</code> function from our <code>fabricatr</code> package.</p>
<p>To add a variable using fabricate:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">declare_step</span>(<span class="dt">handler =</span> fabricate, <span class="dt">add_variable =</span> <span class="kw">rnorm</span>(N))</a></code></pre></div>
<p>If you have district-month data you may want to analyze at the district level, collapsing across months:<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">collapse_data &lt;-<span class="st"> </span><span class="cf">function</span>(data, collapse_by) {</a>
<a class="sourceLine" id="cb24-2" title="2">  data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>({{ collapse_by }}) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize_all</span>(mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb24-3" title="3">}</a>
<a class="sourceLine" id="cb24-4" title="4"></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="kw">declare_step</span>(<span class="dt">handler =</span> collapse_data, <span class="dt">collapse_by =</span> district)</a></code></pre></div>
</div>
</div>
<div id="answer-strategy" class="section level3">
<h3><span class="header-section-number">3.4.4</span> Answer strategy</h3>
<p>Through our model and data strategy steps, we have simulated a dataset with two key inputs to the answer strategy: an assignment variable and an outcome. In other answer strategies, pretreatment characteristics from the model might also be relevant. The data look like this:</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
ID
</th>
<th style="text-align:right;">
u
</th>
<th style="text-align:right;">
Y_Z_0
</th>
<th style="text-align:right;">
Y_Z_1
</th>
<th style="text-align:right;">
S_inclusion_prob
</th>
<th style="text-align:right;">
Z
</th>
<th style="text-align:right;">
Z_cond_prob
</th>
<th style="text-align:right;">
Y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
002
</td>
<td style="text-align:right;">
0.6898023
</td>
<td style="text-align:right;">
0.6898023
</td>
<td style="text-align:right;">
0.9398023
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.6898023
</td>
</tr>
<tr>
<td style="text-align:left;">
004
</td>
<td style="text-align:right;">
1.7706101
</td>
<td style="text-align:right;">
1.7706101
</td>
<td style="text-align:right;">
2.0206101
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1.7706101
</td>
</tr>
<tr>
<td style="text-align:left;">
005
</td>
<td style="text-align:right;">
0.1980832
</td>
<td style="text-align:right;">
0.1980832
</td>
<td style="text-align:right;">
0.4480832
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.4480832
</td>
</tr>
<tr>
<td style="text-align:left;">
006
</td>
<td style="text-align:right;">
-0.5296684
</td>
<td style="text-align:right;">
-0.5296684
</td>
<td style="text-align:right;">
-0.2796684
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
-0.2796684
</td>
</tr>
<tr>
<td style="text-align:left;">
007
</td>
<td style="text-align:right;">
-1.1895497
</td>
<td style="text-align:right;">
-1.1895497
</td>
<td style="text-align:right;">
-0.9395497
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
-0.9395497
</td>
</tr>
<tr>
<td style="text-align:left;">
008
</td>
<td style="text-align:right;">
0.4543946
</td>
<td style="text-align:right;">
0.4543946
</td>
<td style="text-align:right;">
0.7043946
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.4543946
</td>
</tr>
</tbody>
</table>
<p>Our estimator is the difference-in-means estimator, which compares outcomes between the group that was assigned to treatment and that assigned to control. We can calculate the difference-in-means estimate with a call to <code>summarize</code> from <code>dplyr</code>:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">simple_design_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">DiM =</span> <span class="kw">mean</span>(Y[Z <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(Y[Z <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]))</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
DiM
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.43674
</td>
</tr>
</tbody>
</table>
<p>The <code>estimatr</code> package makes this easy and calculates the design-based standard error and a p-value and confidence interval for you:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">difference_in_means</span>(Y <span class="op">~</span><span class="st"> </span>Z, <span class="dt">data =</span> simple_design_data)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:left;">
outcome
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Z
</td>
<td style="text-align:right;">
0.43674
</td>
<td style="text-align:right;">
0.2652905
</td>
<td style="text-align:right;">
1.646271
</td>
<td style="text-align:right;">
0.1063448
</td>
<td style="text-align:right;">
-0.0968818
</td>
<td style="text-align:right;">
0.9703617
</td>
<td style="text-align:right;">
47.24747
</td>
<td style="text-align:left;">
Y
</td>
</tr>
</tbody>
</table>
<p>Now, in order to <em>declare</em> our estimator, we can send the name of a model to <code>declare_estimator</code>. R has many models that work with <code>declare_estimator</code>, including <code>lm</code>, <code>glm</code>, the <code>ictreg</code> package from the <code>list</code> package, etc. The design-based estimators from <code>estimatr</code> can all be used.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">declare_estimator</span>(Y <span class="op">~</span><span class="st"> </span>Z, <span class="dt">model =</span> difference_in_means, <span class="dt">estimand =</span> <span class="st">&quot;PATE&quot;</span>)</a></code></pre></div>
<p>In this declaration, we also define the estimand we are targeting with the difference-in-means estimator.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> Typically, you will have an estimand that you are targeting, and sometimes you may consider targeting more than one and assessing how good your estimator estimates them. For example, you may want to know how good a job your instrumental variables job is at targeting the complier average causal effect, but also how close it gets on average to the average treatment effect.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>Typically, we think of potential outcomes as fixed and not random, and move random variables to the population.<a href="research-design-steps.html#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>The <code>{{ }}</code> syntax is handy for writing functions in <code>dplyr</code> where you want to be able reuse the function with different variable names. Here, the <code>collapse_data</code> function will <code>group_by</code> the variable you send to the argument <code>collapse_by</code>, which in our declaration we set to <code>district</code>. The pipeline within the function then calculates the mean in each district.<a href="research-design-steps.html#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p>Sometimes, you may be interested just in the properties of an estimator, such as calculating its power. In this case, you need not define an estimand.<a href="research-design-steps.html#fnref6" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="building-a-step-of-a-research-design.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="building-a-design-from-design-steps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
