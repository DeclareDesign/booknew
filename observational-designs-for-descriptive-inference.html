<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 14 Observational designs for descriptive inference | Research Design: Declare, Diagnose, Redesign</title>
<meta name="author" content="Graeme Blair, Alexander Coppock, and Macartan Humphreys">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<link href="libs/bs4_book-1.0.0/dd_imgpopup.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/bs4_book-1.0.0/dd_imgpopup.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://hypothes.is/embed.js" async></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Research Design: Declare, Diagnose, Redesign</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li class="book-part">Introduction</li>
<li><a class="" href="preamble.html"><span class="header-section-number">1</span> Preamble</a></li>
<li><a class="" href="improving-research-designs.html"><span class="header-section-number">2</span> Improving research designs</a></li>
<li><a class="" href="primer.html"><span class="header-section-number">3</span> Software primer</a></li>
<li><a class="" href="part-i-exercises.html"><span class="header-section-number">4</span> Part I Exercises</a></li>
<li class="book-part">Declaration, Diagnosis, Redesign</li>
<li><a class="" href="declaration.html"><span class="header-section-number">5</span> Declaration</a></li>
<li><a class="" href="specifying-the-model.html"><span class="header-section-number">6</span> Specifying the model</a></li>
<li><a class="" href="defining-the-inquiry.html"><span class="header-section-number">7</span> Defining the inquiry</a></li>
<li><a class="" href="crafting-a-data-strategy.html"><span class="header-section-number">8</span> Crafting a data strategy</a></li>
<li><a class="" href="choosing-an-answer-strategy.html"><span class="header-section-number">9</span> Choosing an answer strategy</a></li>
<li><a class="" href="p2diagnosis.html"><span class="header-section-number">10</span> Diagnosis</a></li>
<li><a class="" href="redesign-2.html"><span class="header-section-number">11</span> Redesign</a></li>
<li><a class="" href="part-ii-exercises.html"><span class="header-section-number">12</span> Part II Exercises</a></li>
<li class="book-part">Research Design Library</li>
<li><a class="" href="research-design-library.html"><span class="header-section-number">13</span> Research Design Library</a></li>
<li><a class="active" href="observational-designs-for-descriptive-inference.html"><span class="header-section-number">14</span> Observational designs for descriptive inference</a></li>
<li><a class="" href="experimental-designs-for-descriptive-inference.html"><span class="header-section-number">15</span> Experimental designs for descriptive inference</a></li>
<li><a class="" href="observational-designs-for-causal-inference.html"><span class="header-section-number">16</span> Observational designs for causal inference</a></li>
<li><a class="" href="experimental-designs-for-causal-inference.html"><span class="header-section-number">17</span> Experimental designs for causal inference</a></li>
<li><a class="" href="multi-study-designs.html"><span class="header-section-number">18</span> Multi-study designs</a></li>
<li><a class="" href="part-iii-exercises.html"><span class="header-section-number">19</span> Part III Exercises</a></li>
<li class="book-part">Research Design Lifecycle</li>
<li><a class="" href="research-design-lifecycle.html"><span class="header-section-number">20</span> Research Design Lifecycle</a></li>
<li><a class="" href="before.html"><span class="header-section-number">21</span> Before</a></li>
<li><a class="" href="during.html"><span class="header-section-number">22</span> During</a></li>
<li><a class="" href="after.html"><span class="header-section-number">23</span> After</a></li>
<li><a class="" href="part-iv-exercises.html"><span class="header-section-number">24</span> Part IV Exercises</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="observational-designs-for-descriptive-inference" class="section level1">
<h1>
<span class="header-section-number">14</span> Observational designs for descriptive inference<a class="anchor" aria-label="anchor" href="#observational-designs-for-descriptive-inference"><i class="fas fa-link"></i></a>
</h1>
<p>An observational design for descriptive inference has a inquiry like a population mean, covariance, or distribution as the main research goal. In an observational research design, the data strategy includes sampling and measurement components, but no treatments are allocated. Put differently, in an observational design for descriptive inference, researchers seek to measure and summarize the world, but not to change it. This class of research design encompasses a huge portion of research activity – most surveys fall into this class, as do large-scale data collections of economic and sociopolitical indicators. Other examples of observational designs for descriptive inference include classic case studies focused on “thick description” and many text analysis projects.</p>

<!-- note do_bookdown is set in index.rmd, so we know if you're running just this .Rmd or compiling the book-->
<!-- start post here, do not edit above -->
<div id="random-sampling" class="section level2">
<h2>
<span class="header-section-number">14.1</span> Random sampling<a class="anchor" aria-label="anchor" href="#random-sampling"><i class="fas fa-link"></i></a>
</h2>
<p>Often we are interested in features of a population, but data on the entire population is prohibitively expensive to collect. Instead, researchers obtain data on a small fraction of the population and use measurements taken on that sample to draw inferences about the population.</p>
<p>Imagine we seek to estimate the average political ideology of adults residents of the small town of Portola, California (population 2,100). Households include between 1 and 3 adults; adults living in the same households typically have similar ideologies, but differ somewhat. The <em>latent</em> ideology of each subject is therefore composed of a household-level shock as well as an idiosyncratic individual-level shock. Our data strategy will involve administering a survey that asks subjects to place themselves on a left-right scale that varies from 1 (most liberal) to 7 (most conservative). We approximate this measurement procedure with a function that “cuts” the latent ideology into 7 separate groups. Note that here we define the measurement <em>before</em> the sampling to let us simulate what we <em>would</em> measure for any member of the population were we to sample them.</p>
<p>Our inquiry is “data-dependent”, since we are interested the population mean of the <em>measured</em> variable <span class="math inline">\(Y\)</span>: <span class="math inline">\(\frac{1}{N} \sum_1^N Y_i = \bar{Y}\)</span> (or, what we would measure were we to be able to measure the population). Our first sampling strategy will be complete random sampling. We draw a sample of exactly <span class="math inline">\(n = 100\)</span>, where every member of the population has an equal probability of inclusion in the sample, <span class="math inline">\(\frac{n}{N}\)</span>. Our answer strategy is the sample mean estimator: <span class="math inline">\(\widehat{\overline{Y}} = \frac{1}{n} \sum_1^n Y_i\)</span>, implemented here as an ordinary least squares regression to facilitate the easy calculation of auxiliary statistics like the standard error of the estimate and the 95% confidence interval.</p>
<div id="declaration-1" class="section level3">
<h3>
<span class="header-section-number">14.1.1</span> Declaration<a class="anchor" aria-label="anchor" href="#declaration-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">portola</span> <span class="op">&lt;-</span>
  <span class="fu">fabricate</span><span class="op">(</span>
    households <span class="op">=</span> <span class="fu">add_level</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">500</span>, 
                           n_adults <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                           household_shock <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
    adults <span class="op">=</span> <span class="fu">add_level</span><span class="op">(</span>N <span class="op">=</span> <span class="va">n_adults</span>, 
                       individual_shock <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,
                       Ystar <span class="op">=</span> <span class="va">household_shock</span> <span class="op">+</span> <span class="va">individual_shock</span><span class="op">)</span>
    <span class="op">)</span>

<span class="va">design</span> <span class="op">&lt;-</span> 
  <span class="fu">declare_population</span><span class="op">(</span>data <span class="op">=</span> <span class="va">portola</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_measurement</span><span class="op">(</span>Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">Ystar</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_estimand</span><span class="op">(</span>Y_bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_sampling</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_estimator</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>, model <span class="op">=</span> <span class="va">lm_robust</span>, estimand <span class="op">=</span> <span class="st">"Y_bar"</span><span class="op">)</span></code></pre></div>
</div>
<div id="dag" class="section level3">
<h3>
<span class="header-section-number">14.1.2</span> DAG<a class="anchor" aria-label="anchor" href="#dag"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-figure"><img src="book_files/figure-html/unnamed-chunk-152-1.svg" width="100%"></div>
<div id="diagnosis" class="section level4">
<h4>
<span class="header-section-number">14.1.2.1</span> Diagnosis<a class="anchor" aria-label="anchor" href="#diagnosis"><i class="fas fa-link"></i></a>
</h4>
<p>Two main diagnosands for the simple random sampling design are bias and rmse. We want to know if we get the right answer on average and we want to know, on average, how far off from the truth we are.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diagnosands</span> <span class="op">&lt;-</span> <span class="fu">declare_diagnosands</span><span class="op">(</span>
  bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">estimate</span> <span class="op">-</span> <span class="va">estimand</span><span class="op">)</span>,
  rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">estimate</span> <span class="op">-</span> <span class="va">estimand</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu">diagnose_design</span><span class="op">(</span><span class="va">design</span>, diagnosands <span class="op">=</span> <span class="va">diagnosands</span><span class="op">)</span> </code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:completerandomsampling">Table 14.1: </span>Complete random sampling design diagnosis
</caption>
<thead><tr>
<th style="text-align:left;">
Bias
</th>
<th style="text-align:left;">
RMSE
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
0.00
</td>
<td style="text-align:left;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.00)
</td>
</tr>
</tbody>
</table></div>
<p>The diagnosis in table <a href="observational-designs-for-descriptive-inference.html#tab:completerandomsampling">14.1</a> indicates that under complete random sampling, the sample mean estimator of the population mean is unbiased and that the root mean squared error is manageable at 0.11.</p>
</div>
<div id="exercises" class="section level4">
<h4>
<span class="header-section-number">14.1.2.2</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>Can you modify the design to define the estimand as the mean of the latent variable <code>Y_star</code>? What happens if you diagnose this design?</li>
<li>Can you modify the design to allow for the possibility of measurement error?</li>
<li>Can you modify the design to allow for the possibility of sampling error?</li>
</ol>
</div>
</div>
<div id="clustered-random-sampling" class="section level3">
<h3>
<span class="header-section-number">14.1.3</span> Clustered random sampling<a class="anchor" aria-label="anchor" href="#clustered-random-sampling"><i class="fas fa-link"></i></a>
</h3>
<p>Researchers often cannot randomly sample at the individual level because it may, among other reasons, be too costly or logistically impractical. Instead, they may choose to randomly sample households, political precincts, or any group of individuals in order to draw inferences about the population. This strategy may be cheaper and simpler but may also introduce risks of less precise estimates.</p>
<p>Let’s modify our first design to sample at the household level, rather than at the individual individual level. We’ll also add an additional estimator that clusters standard errors at the level of sampling, the household to compare to the estimator that ignores clustering. We’ll also add a new diagnosand, coverage, which will indicate whether the confidence intervals we construct (which depend on the flavor of standard errors we estimate) indeed include the true value of the inquiry 95% of the time.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span>
  <span class="fu">declare_population</span><span class="op">(</span>data <span class="op">=</span> <span class="va">portola</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_measurement</span><span class="op">(</span>Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">Ystar</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimand</span><span class="op">(</span>Y_bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_sampling</span><span class="op">(</span>clusters <span class="op">=</span> <span class="va">households</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimator</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>,
                    model <span class="op">=</span> <span class="va">lm_robust</span>,
                    estimand <span class="op">=</span> <span class="st">"Y_bar"</span>,
                    label <span class="op">=</span> <span class="st">"Standard errors not clustered"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimator</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>,
                    clusters <span class="op">=</span> <span class="va">households</span>,
                    model <span class="op">=</span> <span class="va">lm_robust</span>,
                    estimand <span class="op">=</span> <span class="st">"Y_bar"</span>,
                    label <span class="op">=</span> <span class="st">"Standard errors clustered"</span><span class="op">)</span>

<span class="va">diagnosands</span> <span class="op">&lt;-</span> <span class="fu">declare_diagnosands</span><span class="op">(</span>
  bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">estimate</span> <span class="op">-</span> <span class="va">estimand</span><span class="op">)</span>,
  rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">estimate</span> <span class="op">-</span> <span class="va">estimand</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
  coverage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">estimand</span> <span class="op">&lt;=</span> <span class="va">conf.high</span> <span class="op">&amp;</span> <span class="va">estimand</span> <span class="op">&gt;=</span> <span class="va">conf.low</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu">diagnose_design</span><span class="op">(</span><span class="va">design</span>, diagnosands <span class="op">=</span> <span class="va">diagnosands</span><span class="op">)</span> </code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:clusterrandomsampling">Table 14.2: </span>Cluster random sampling design diagnosis
</caption>
<thead><tr>
<th style="text-align:left;">
Estimator Label
</th>
<th style="text-align:left;">
Bias
</th>
<th style="text-align:left;">
RMSE
</th>
<th style="text-align:left;">
Coverage
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Standard errors clustered
</td>
<td style="text-align:left;">
-0.01
</td>
<td style="text-align:left;">
0.16
</td>
<td style="text-align:left;">
0.96
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.01)
</td>
</tr>
<tr>
<td style="text-align:left;">
Standard errors not clustered
</td>
<td style="text-align:left;">
-0.01
</td>
<td style="text-align:left;">
0.16
</td>
<td style="text-align:left;">
0.84
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.01)
</td>
<td style="text-align:left;">
(0.02)
</td>
</tr>
</tbody>
</table></div>
<p>The diagnosis shows the affect of clustering on the quality of our estimates. While the design remains unbiased for the population mean, the RMSE has gone up. We still interview (on average) 100 people in each sample, but since under the clustered design, we interview all adults in the household, the sampling distribution of the estimates has higher variance. The diagnosis also highlights the importance of matching your answer strategy to your data strategy. The sampling was clustered by household. The answer strategy that fails to account for clustering yields confidence intervals that are too small, as evidenced by the coverage rate well below the nominal 95%. When we estimate clustered standard errors instead, the coverage improves.</p>
<div id="exercises-1" class="section level4">
<h4>
<span class="header-section-number">14.1.3.1</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-1"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>Here the clusters were defined as part of the model, but they could be defined as part of the data strategy. Can you modify the design and generate sampling clusters by putting neighboring households into the same cluster. Your data will have a household identifier <code>households</code> so you could try making a single cluster out of each pair (for instance households <code>001</code> and <code>002</code>). How does sampling using pairs households together affect your estimated rmse?</li>
</ol>
<!-- #### Exercises --><!-- 1. Modify the declaration to change the distribution of $Y$ from being uniform to something else: perhaps imagine that more extreme ideologies are more prevalent than moderate ones. Is the sample mean estimator still unbiased? Interpret your answer. --><!-- 2. Change the sampling procedure to favor units with higher values of ideology. Is the sample mean estimator still unbiased? Interpret your answer. --><!-- 3. Modify the estimation function to use this formula for the standard error: $\widehat{se} \equiv \frac{\widehat\sigma}{\sqrt{n}}$. This equation differs from the one used in our declaration (it ignores the total population size $N$). Check that the coverage of this new design is incorrect when $N=n$. Assess how large $N$ has to be for the difference between these procedures not to matter.  --><!-- note do_bookdown is set in index.rmd, so we know if you're running just this .Rmd or compiling the book--><!-- start post here, do not edit above -->
</div>
</div>
</div>
<div id="poststratification" class="section level2">
<h2>
<span class="header-section-number">14.2</span> Poststratification<a class="anchor" aria-label="anchor" href="#poststratification"><i class="fas fa-link"></i></a>
</h2>
<p>Poststratification is a tool for learning about a population when you have a sample whose units were drawn with unequal (and usually unknown) probabilities. In essence, if you know features of the population that you can measure in your own sample, you can reweight your sample to look like the population—at least along the dimensions you can measure. In its simplest form, poststratification just involves counting and dividing. Say you want to poststratify your sample so that, in terms of gender and age, it looks like all people in their twenties in the United States population in 2010. That gives twenty groups—one for each age and each gender—whose size you need to count in the 2010 Decennial census and in your sample. Then, simply weight each person in the sample by the size of their group in the population divided by the size of their group in the sample. As we illustrate with the declaration below, it turns out that these weights are equivalent to the inverse sampling probabilities one would obtain were one to construct the sample using groups as strata. That’s where the “stratification” in poststratification comes from—it’s “post” because the weights are constructed after the sampling has already taken place. In the online example, we illustrate how multi-level regression and poststratification (MRP) can help address the problem that, as the number of group-defining features increases, the sample may contain no information at all about some of the groups defined by the combination of those features. A multi-level regression model helps by partially pooling across strata to combat this sparsity problem.</p>
<div id="declaration-2" class="section level3">
<h3>
<span class="header-section-number">14.2.1</span> Declaration<a class="anchor" aria-label="anchor" href="#declaration-2"><i class="fas fa-link"></i></a>
</h3>
<!-- 
JC comment: Original declaration doesn't have correlation between X and Y so this design works even if the estimator is just an intercept. Once I added the correlation, the design was biased. Don't quite understand the demeaning approach (doesn't appear to be using any population-level info?) so have just opted for a more conventional approach to poststratification that reweights to the population proportions. Have also called this poststratification since we are now only using MRP in the extended example. 


```r
fixed_population <- declare_population(N = 500, 
                                       X = sample(c("A", "B", "C"), N, replace = TRUE),
                                       Y = sample(1:7, N, replace = TRUE))()

design <- 
  declare_population(data = fixed_population) + 
  declare_estimand(Ybar = mean(Y)) + 
  declare_sampling(strata_prob = c(0.2, 0.1, 0.3), strata = X) + 
  declare_step(B_demeaned = (X == "B") - mean(X == "B"),
               C_demeaned = (X == "C") - mean(X == "C"), mutate) + 
  declare_estimator(Y ~ B_demeaned + C_demeaned, term = "(Intercept)", model = lm_robust, estimand = "Ybar")
```

-->
<ul>
<li><p><strong>M</strong>odel: We have a fixed, finite population comprised of two groups defined by a binary variable, <span class="math inline">\(X\)</span>. There are 100 people who have <span class="math inline">\(X = 0\)</span> and 50 who have <span class="math inline">\(X = 1\)</span>. The outcome, <span class="math inline">\(Y\)</span>, takes one of three values, 0, 1, and 2, and is a function of <span class="math inline">\(X\)</span>.</p></li>
<li><p><strong>I</strong>nquiry: The researcher wants to know the true average of <span class="math inline">\(Y\)</span> in the population.</p></li>
<li><p><strong>D</strong>ata strategy: Ten individuals from each group are included in the sample. Thus, whereas 2/3 of the population belong to the <span class="math inline">\(X = 0\)</span> group, only 1/2 of the sample does. Conversely, while only 1/3 of the population belongs to the <span class="math inline">\(X = 1\)</span> group, 1/2 of the sample does.</p></li>
<li><p><strong>A</strong>nswer strategy: The answer strategy involves taking a weighted average of <span class="math inline">\(Y\)</span> in the sample, where each unit’s weight is equal to the size of their group in the population divided by the size of their group in the sample. Specifically, those in the underrepresented group, <span class="math inline">\(X = 0\)</span>, get a weight of 100/10 = 10, while the overrepresented group, <span class="math inline">\(X = 1\)</span>, gets a weight of 50 / 10 = 5. When the poststratification groups perfectly line up with the sample strata, as they do here, the approach is equivalent to weighting by the inverse of the sampling probability: 1/(10/100) = 10 and 1/(10/50) = 5. In both cases, the weights tell us how many units in the population each unit in the sample represents.</p></li>
</ul>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fixed_population</span> <span class="op">&lt;-</span>
  <span class="fu">fabricate</span><span class="op">(</span>
    group <span class="op">=</span> <span class="fu">add_level</span><span class="op">(</span>
      N <span class="op">=</span> <span class="fl">2</span>,
      X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,
      population_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">50</span><span class="op">)</span>
    <span class="op">)</span>,
    individual <span class="op">=</span> <span class="fu">add_level</span><span class="op">(</span>N <span class="op">=</span> <span class="va">population_n</span>,
                           Y <span class="op">=</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">design</span> <span class="op">&lt;-</span>
  <span class="fu">declare_population</span><span class="op">(</span>data <span class="op">=</span> <span class="va">fixed_population</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimand</span><span class="op">(</span>Ybar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_sampling</span><span class="op">(</span>strata_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, strata <span class="op">=</span> <span class="va">X</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_step</span><span class="op">(</span>handler <span class="op">=</span> <span class="va">group_by</span>, groups <span class="op">=</span> <span class="va">X</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_step</span><span class="op">(</span>handler <span class="op">=</span> <span class="va">mutate</span>,
               sample_n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,
               weight <span class="op">=</span> <span class="va">population_n</span> <span class="op">/</span> <span class="va">sample_n</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimator</span><span class="op">(</span>
    <span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>,
    term <span class="op">=</span> <span class="st">"(Intercept)"</span>,
    model <span class="op">=</span> <span class="va">lm_robust</span>,
    weights <span class="op">=</span> <span class="va">weight</span>,
    estimand <span class="op">=</span> <span class="st">"Ybar"</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="dag-1" class="section level3">
<h3>
<span class="header-section-number">14.2.2</span> Dag<a class="anchor" aria-label="anchor" href="#dag-1"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-figure"><img src="book_files/figure-html/unnamed-chunk-164-1.svg" width="100%"></div>
</div>
<div id="exercises-2" class="section level3">
<h3>
<span class="header-section-number">14.2.3</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-2"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Add an unweighted estimator to the design and diagnose it. Explain why the unweighted estimator is biased, as well as the direction of the bias.</li>
<li>Remove <code>X</code> from the definition of <code>Y</code>. Explain why the bias is now equivalent in the two approaches.</li>
<li>Change the <code>strata_n</code> so that 4 people are sampled from the first group and 25 are sampled from the second group.
<ol style="list-style-type: lower-roman">
<li>Calculate the poststratification weight for each group by hand (hint: you can check your answer using <code>draw_data(design)$weight</code>).</li>
<li>Calculate the sample inclusion probability for each group by hand (hint: you can check your answer using <code>draw_data(design)$S_inclusion_prob</code>).</li>
<li>Calculate the inverse of the sampling probability for each group. These should be equal to the poststratification weights.</li>
</ol>
</li>
</ul>
</div>
<div id="example-2" class="section level3">
<h3>
<span class="header-section-number">14.2.4</span> Example<a class="anchor" aria-label="anchor" href="#example-2"><i class="fas fa-link"></i></a>
</h3>
<!-- make sure to rename the section title below -->
<p>MRP based on Lax and Philips APSR 2009</p>
<!-- ```{r, echo = FALSE} -->
<!-- delaware_senate_districts_df <- read_rds("data/delaware.RDS") -->
<!-- kable(head(delaware_senate_districts_df, 5), booktabs = TRUE) -->
<!-- ``` -->
<!-- ```{r, eval = FALSE} -->
<!-- # US population -->
<!-- delaware_population_df <- fabricate( -->
<!--   data = delaware_senate_districts_df, -->
<!--   individuals = add_level( -->
<!--     N = population_size, -->
<!--     race_white = rbinom(N, 1, prob = prop_white), -->
<!--     race_black = rbinom(N, 1, prob = prop_black), -->
<!--     race_asian = rbinom(N, 1, prob = prop_black), -->
<!--     race_hispanic_other = rbinom(N, 1, prob = prop_hispanic_other), -->
<!--     pid_republican = rbinom(N, 1, prob = prop_republican), -->
<!--     pid_democrat = rbinom(N, 1, prob = prop_democrat) -->
<!--   ) -->
<!-- ) %>%  -->
<!--   select(-starts_with("prop_"), -population_size) -->
<!-- # population weights for MRP -->
<!-- mrp_weights <- delaware_population_df %>% -->
<!--   group_by(district, race_white, race_black, race_asian, race_hispanic_other, pid_republican, pid_democrat) %>%  -->
<!--   summarize(n_cell = n()) %>%  -->
<!--   group_by(district) %>%  -->
<!--   mutate(proportion_cell = n_cell/sum(n_cell)) %>%  -->
<!--   select(-n_cell) %>%  -->
<!--   ungroup  -->
<!-- delaware_population_df <- mrp_weights %>%  -->
<!--   select(district, proportion_cell) %>%  -->
<!--   right_join(delaware_population_df) -->
<!-- # Lax and Philips APSR 2009 -->
<!-- # Policies are coded dichotomously, 1 for the progay policy and 0 otherwise: Adoption (9 states allow second-parent adoption in all jurisdictions) -->
<!-- design <- -->
<!--   declare_population( -->
<!--     data = delaware_population_df,  -->
<!--     districts = modify_level(district_effect = rnorm(N)), -->
<!--     individuals = modify_level( -->
<!--       noise = rnorm(N, mean = district_effect), -->
<!--       policy_support = rbinom(N, 1, prob = pnorm( -->
<!--         0.25 + 0.2 * race_white - 0.1 * race_black - 0.2 * race_hispanic_other -  -->
<!--           0.1 * pid_democrat + 0.15 * pid_republican + noise)) -->
<!--     ) -->
<!--   ) +  -->
<!--   declare_estimand(handler = function(data) { -->
<!--     data %>% -->
<!--       group_by(district) %>% -->
<!--       summarize(estimand = mean(policy_support)) %>% -->
<!--       ungroup %>%  -->
<!--       mutate(estimand_label = "mean_policy_support") -->
<!--   }) + -->
<!--   declare_sampling(n = 500) + -->
<!--   declare_estimator(handler = tidy_estimator(function(data) { -->
<!--     data %>% -->
<!--       group_by(district) %>% -->
<!--       summarize(estimate = mean(policy_support)) -->
<!--   }), label = "strata_means", estimand = "mean_policy_support") +  -->
<!--   # this estimator owes code to https://timmastny.rbind.io/blog/multilevel-mrp-tidybayes-brms-stan/ -->
<!--   declare_estimator(handler = tidy_estimator(function(data) { -->
<!--     model_fit <- glmer( -->
<!--       formula = policy_support ~ race_white + race_black + race_asian + race_hispanic_other + -->
<!--         pid_democrat + pid_republican + (1 | district), -->
<!--       data = data, family = binomial(link = "logit")) -->
<!--     data %>% -->
<!--       mutate( -->
<!--         support_predicted = -->
<!--           prediction(model_fit, data = ., allow.new.levels = TRUE, type = "response"), -->
<!--         support_predicted_weighted = support_predicted * proportion_cell -->
<!--       ) %>% -->
<!--       group_by(district) %>% -->
<!--       summarize(estimate = sum(support_predicted_weighted)) -->
<!--   }), label = "mrp_mle", estimand = "mean_policy_support") -->
<!-- dat <- draw_data(design) -->
<!-- draw_estimates(design) -->
<!-- sims <- simulate_design(design, sims = 3) -->
<!-- diag <- diagnose_design(design, sims = 100, diagnosands = declare_diagnosands(bias = mean(estimate - estimand)), add_grouping_variables = "state") -->
<!-- ``` -->

<!-- note do_bookdown is set in index.rmd, so we know if you're running just this .Rmd or compiling the book-->
<!-- start post here, do not edit above -->
</div>
</div>
<div id="inference-about-unobserved-variables" class="section level2">
<h2>
<span class="header-section-number">14.3</span> Inference about unobserved variables<a class="anchor" aria-label="anchor" href="#inference-about-unobserved-variables"><i class="fas fa-link"></i></a>
</h2>
<p>Oftentimes researchers seek to measure a latent variable (<code>Y_star</code>) but have access only to proxies (<code>Y_1</code>, <code>Y_2</code>, <code>Y_3</code>). In such cases the proxies are sometimes combined into an index which is thought to capture <code>Y_star</code> and then used for further analysis.</p>
<p>A difficult feature of such problems is that we do not have access to the <em>scale</em> on which <code>Y_star</code> is measured and so it may seem like a hopeless exercise to try to assess whether we have got good or bad estimates of <code>Y_star</code> when we combine the measured data.</p>
<p>One way around this is to normalize the scale of both the latent variable and the measured variable so that they have a mean of 0 and unit standard deviation. But in that case we are guaranteed that our estimate of the mean of the normalized variable will be unbiased! We will certainly estimate a mean of 0! That may be but as we show in the declaration below, if you model is correct this approach may still be useful for calculating other quantities — such as conditional means—that you don’t just get right by construction.</p>
<div id="declaration-3" class="section level3">
<h3>
<span class="header-section-number">14.3.1</span> Declaration<a class="anchor" aria-label="anchor" href="#declaration-3"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span>
  <span class="fu">declare_population</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">200</span>, gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="va">N</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, Y_star <span class="op">=</span> <span class="va">gender</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimand</span><span class="op">(</span>Y_bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">Y_star</span><span class="op">)</span><span class="op">[</span><span class="va">gender</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_measurement</span><span class="op">(</span>Y_1 <span class="op">=</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">Y_star</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, sd <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,
                      Y_2 <span class="op">=</span> <span class="va">Y_star</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, sd <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,
                      Y_3 <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Y_star</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, sd <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,
                      Y_idx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">Y_1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">Y_2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">Y_3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_estimator</span><span class="op">(</span><span class="va">Y_idx</span> <span class="op">~</span> <span class="fl">1</span>, model <span class="op">=</span> <span class="va">lm_robust</span>, estimand <span class="op">=</span> <span class="st">"Y_bar"</span>, subset <span class="op">=</span> <span class="va">gender</span> <span class="op">==</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
</div>
<div id="dag-2" class="section level3">
<h3>
<span class="header-section-number">14.3.2</span> Dag<a class="anchor" aria-label="anchor" href="#dag-2"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-figure"><img src="book_files/figure-html/unnamed-chunk-171-1.svg" width="100%"></div>
</div>
<div id="example-3" class="section level3">
<h3>
<span class="header-section-number">14.3.3</span> Example<a class="anchor" aria-label="anchor" href="#example-3"><i class="fas fa-link"></i></a>
</h3>
<p><span style="color: red;"><small>[FLAG]</small></span>
Perhaps a good psychometric example would be worthwhile to explore here? Or an education example?</p>
<!-- make sure to rename the section title below -->
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu">diagnose_design</span><span class="op">(</span><span class="va">design</span><span class="op">)</span> </code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:latentmodel">Table 14.3: </span>Estimation of the conditional mean of a normalized latent variable
</caption>
<thead><tr>
<th style="text-align:left;">
Mean Estimand
</th>
<th style="text-align:left;">
Bias
</th>
<th style="text-align:left;">
RMSE
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
0.24
</td>
<td style="text-align:left;">
-0.01
</td>
<td style="text-align:left;">
0.02
</td>
</tr>
<tr>
<td style="text-align:left;">
(0.00)
</td>
<td style="text-align:left;">
(0.00)
</td>
<td style="text-align:left;">
(0.00)
</td>
</tr>
</tbody>
</table></div>
<p>We see from the diagnosis that we do quite well here in recovering the conditional mean of the latent variable.</p>
<!-- Maybe add in factor analysis; do more to explain bias -- which I think comes from normalization on tthe same creating to toght a distribution? -->
</div>
<div id="exercises-3" class="section level3">
<h3>
<span class="header-section-number">14.3.4</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-3"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Modify the design so that only two rather than three observed components are used. How is the diagnosis affected? Does it matter which indices you use?</li>
<li>Try to modify the design so that (a) indices are generated by a factor analysis procedure and (b) the different indices vary in the extent to which they are correlated with each other.</li>
<li>How is estimation affected if you have the wrong model linking measures to the latent variables? Try a design in which the measures are non linear in the latent variable.</li>
</ol>
<!-- note do_bookdown is set in index.rmd, so we know if you're running just this .Rmd or compiling the book--><!-- start post here, do not edit above -->
</div>
</div>
<div id="structural-estimation" class="section level2">
<h2>
<span class="header-section-number">14.4</span> Structural estimation<a class="anchor" aria-label="anchor" href="#structural-estimation"><i class="fas fa-link"></i></a>
</h2>
<p>Does structural estimation belong in “observational descriptive” or in “observational causal”?
What is the number one use case for this design?</p>
<div id="declaration-4" class="section level3">
<h3>
<span class="header-section-number">14.4.1</span> Declaration<a class="anchor" aria-label="anchor" href="#declaration-4"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="dag-3" class="section level3">
<h3>
<span class="header-section-number">14.4.2</span> Dag<a class="anchor" aria-label="anchor" href="#dag-3"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="example-4" class="section level3">
<h3>
<span class="header-section-number">14.4.3</span> Example<a class="anchor" aria-label="anchor" href="#example-4"><i class="fas fa-link"></i></a>
</h3>
<!-- make sure to rename the section title below -->

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="research-design-library.html"><span class="header-section-number">13</span> Research Design Library</a></div>
<div class="next"><a href="experimental-designs-for-descriptive-inference.html"><span class="header-section-number">15</span> Experimental designs for descriptive inference</a></div>
</div></main><div id="on-this-page-nav" class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#observational-designs-for-descriptive-inference"><span class="header-section-number">14</span> Observational designs for descriptive inference</a></li>
<li>
<a class="nav-link" href="#random-sampling"><span class="header-section-number">14.1</span> Random sampling</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#declaration-1"><span class="header-section-number">14.1.1</span> Declaration</a></li>
<li><a class="nav-link" href="#dag"><span class="header-section-number">14.1.2</span> DAG</a></li>
<li><a class="nav-link" href="#clustered-random-sampling"><span class="header-section-number">14.1.3</span> Clustered random sampling</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#poststratification"><span class="header-section-number">14.2</span> Poststratification</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#declaration-2"><span class="header-section-number">14.2.1</span> Declaration</a></li>
<li><a class="nav-link" href="#dag-1"><span class="header-section-number">14.2.2</span> Dag</a></li>
<li><a class="nav-link" href="#exercises-2"><span class="header-section-number">14.2.3</span> Exercises</a></li>
<li><a class="nav-link" href="#example-2"><span class="header-section-number">14.2.4</span> Example</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#inference-about-unobserved-variables"><span class="header-section-number">14.3</span> Inference about unobserved variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#declaration-3"><span class="header-section-number">14.3.1</span> Declaration</a></li>
<li><a class="nav-link" href="#dag-2"><span class="header-section-number">14.3.2</span> Dag</a></li>
<li><a class="nav-link" href="#example-3"><span class="header-section-number">14.3.3</span> Example</a></li>
<li><a class="nav-link" href="#exercises-3"><span class="header-section-number">14.3.4</span> Exercises</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#structural-estimation"><span class="header-section-number">14.4</span> Structural estimation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#declaration-4"><span class="header-section-number">14.4.1</span> Declaration</a></li>
<li><a class="nav-link" href="#dag-3"><span class="header-section-number">14.4.2</span> Dag</a></li>
<li><a class="nav-link" href="#example-4"><span class="header-section-number">14.4.3</span> Example</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Research Design: Declare, Diagnose, Redesign</strong>" was written by Graeme Blair, Alexander Coppock, and Macartan Humphreys. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Supported by the Laura and John Arnold Foundation and Evidence in Governance and Politics.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
