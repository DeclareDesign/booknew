<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 Redesign | Research Design: Declare, Diagnose, Redesign</title>
<meta name="author" content="Graeme Blair, Alexander Coppock, and Macartan Humphreys">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4.9000/tabs.js"></script><script src="libs/bs3compat-0.2.4.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<link href="libs/bs4_book-1.0.0/dd_imgpopup.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/bs4_book-1.0.0/dd_imgpopup.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://hypothes.is/embed.js" async></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="headers/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Research Design: Declare, Diagnose, Redesign</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li class="book-part">Introduction</li>
<li><a class="" href="preamble.html"><span class="header-section-number">1</span> Preamble</a></li>
<li><a class="" href="design-principles.html"><span class="header-section-number">2</span> Design principles</a></li>
<li><a class="" href="primer.html"><span class="header-section-number">3</span> Software primer</a></li>
<li><a class="" href="part-i-exercises.html"><span class="header-section-number">4</span> Part I Exercises</a></li>
<li class="book-part">Declaration, Diagnosis, Redesign</li>
<li><a class="" href="declaration-1.html"><span class="header-section-number">5</span> Declaration</a></li>
<li><a class="" href="specifying-the-model.html"><span class="header-section-number">6</span> Specifying the model</a></li>
<li><a class="" href="defining-the-inquiry.html"><span class="header-section-number">7</span> Defining the inquiry</a></li>
<li><a class="" href="crafting-a-data-strategy.html"><span class="header-section-number">8</span> Crafting a data strategy</a></li>
<li><a class="" href="choosing-an-answer-strategy.html"><span class="header-section-number">9</span> Choosing an answer strategy</a></li>
<li><a class="" href="p2diagnosis.html"><span class="header-section-number">10</span> Diagnosis</a></li>
<li><a class="active" href="redesign-2.html"><span class="header-section-number">11</span> Redesign</a></li>
<li><a class="" href="part-ii-exercises.html"><span class="header-section-number">12</span> Part II Exercises</a></li>
<li class="book-part">Research Design Library</li>
<li><a class="" href="research-design-library.html"><span class="header-section-number">13</span> Research Design Library</a></li>
<li><a class="" href="observational-descriptive.html"><span class="header-section-number">14</span> Observational | descriptive</a></li>
<li><a class="" href="observational-causal.html"><span class="header-section-number">15</span> Observational | causal</a></li>
<li><a class="" href="experimental-causal.html"><span class="header-section-number">16</span> Experimental | causal</a></li>
<li><a class="" href="experimental-descriptive.html"><span class="header-section-number">17</span> Experimental | descriptive</a></li>
<li><a class="" href="complex-designs-1.html"><span class="header-section-number">18</span> Complex designs</a></li>
<li><a class="" href="part-iii-exercises.html"><span class="header-section-number">19</span> Part III Exercises</a></li>
<li class="book-part">Research Design Lifecycle</li>
<li><a class="" href="research-design-lifecycle.html"><span class="header-section-number">20</span> Research Design Lifecycle</a></li>
<li><a class="" href="brainstorming.html"><span class="header-section-number">21</span> Brainstorming</a></li>
<li><a class="" href="planning.html"><span class="header-section-number">22</span> Planning</a></li>
<li><a class="" href="realization.html"><span class="header-section-number">23</span> Realization</a></li>
<li><a class="" href="integration.html"><span class="header-section-number">24</span> Integration</a></li>
<li><a class="" href="part-iv-exercises.html"><span class="header-section-number">25</span> Part IV Exercises</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="redesign-2" class="section level1">
<h1>
<span class="header-section-number">11</span> Redesign<a class="anchor" aria-label="anchor" href="#redesign-2"><i class="fas fa-link"></i></a>
</h1>
<!-- make sure to rename the section title below -->
<p>Diagnosis is the process of learning the value of a diagnosand and the utility of a research design. Often diagnosis is undertaken for a range of specifications of <em>M</em> to assess robustness to alternative models.</p>
<p>Redesign is the process of <em>changing</em> parts of <strong>D</strong> and <strong>A</strong> (and, perhaps, <strong>I</strong>) in order to learn how diagnosand values and researcher utility change. The redesign process is complete when a researcher settles on a choice of <strong>D</strong> and <strong>A</strong> among the feasible set.</p>
<p>For example, we can compare how the distribution of errors changes if we use a different data strategy <span class="math inline">\(D'\)</span>: <span class="math inline">\(P_M(a^d - a^m|D')\)</span> or a different answer strategy <span class="math inline">\(A'\)</span>: <span class="math inline">\(P_M(a^{d'} - a^m|D)\)</span>. In each case, as we examine variation in <strong>D</strong> and <strong>A</strong>, our diagnoses can assess how the distribution of errors differs for alternative model <span class="math inline">\(M'\)</span>: <span class="math inline">\(P_M(a^{d} - a^{m'}|D)\)</span>.</p>
<p>Sometimes redesign is about fixing problems. You diagnose a design and find that your estimator is shooting at an altogether different quantity than what you have in mind. In such cases, redesign is about fixing errors.</p>
<p>Often however researchers wish to find the optimal design for their question subject to financial and logistical constraints. Even simple designs have many variations, so the search space must be limited. For example, a researcher might want to find the sample size <span class="math inline">\(N\)</span> and the number of treated units <span class="math inline">\(N_t\)</span> that minimize a design’s error subject to a fixed budget for the experiment in which data collection for each unit costs $25 and treating one unit costs $5. They solve the optimization problem:</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
&amp; \underset{N, N_t}{\text{argmin}}
&amp; &amp; E_M(L(a^{d} - a^{m}|D_{N, N_t})) \\
&amp; \text{s.t.}
&amp; &amp; 25  N + 5  N_t \leq 5000
\end{aligned}
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(L\)</span> is a loss function, increasing in the difference between <span class="math inline">\(a^{d}\)</span> and <span class="math inline">\(a^{m}\)</span>.</p>
<p>There is no reason however to optimize with respect to a single diagnosand only. If we redesign by optimizing for the power diagnosand, we are likely to find a design that is highly powered but highly biased — it is targeting the wrong estimand. We can solve this by switching to the root mean-squared error as the diagnosand, which reflects both the bias and efficiency of the design. More generally, the choice of an optimal design requires the researcher to select a weighting of diagnosands. They must balance bias, efficiency, the risk of imprecise null results, the risk of getting the sign of an effect wrong, and other diagnosands given their research goals.</p>
<p>The full evaluation of a design — declaration, diagnosis, and redesign — depends on the assessment of one or more diagnosands, and comparing the diagnoses to what could be achieved under alternative designs.</p>
<!-- We usually redesign with respect to the data and answer strategies. We tweak the data strategy by changing $N$ to see how RMSE changes. We change the answer strategy to see how the inclusion of covariates decreases bias. While we usually redesign the empirical side, redesign can take place with respect to the theoretical side (model and inquiry) as well.^[There are some subtleties here. Sometimes a single design includes uncertainty about the model -- for example when we draw parameter values from a random distribution. We have a parameter be drawn from a normal distribution centered at 0.3 with an SD of 0.1 because we think a reasonable value for the parameter is "about three, plus or minus". We *could* imagine that we are "redesigning" with respect to each value of parameter, but only if the goal is to see how the changes in the model change the diagnosands. Otherwise, it's not redesign, it's just plain diagnosis, averaging over multiple models.] -->
<div id="graphical-inspection" class="section level2">
<h2>
<span class="header-section-number">11.1</span> Graphical inspection<a class="anchor" aria-label="anchor" href="#graphical-inspection"><i class="fas fa-link"></i></a>
</h2>
<p>One approach is to examine performance along multiple diagnosands visually. You may have encountered some figures that implicitly do redesign. Power curves are an example of the redesign process. A power curve has sample size on the horizontal axis and statistical power on the vertical axis. From a power curve, you can learn how big a study needs to be in order to achieve a desired level of statistical power. A “minimum detectable effect” figure is similar. It has sample size on the horizontal axis too, but plots the smallest effect size for which 80% power can be achieved. These plots are useful for learning something like, “given my budget, I can only sample 400 units. At 400 units, the MDE is a 0.5 standard deviation effect. My theory says that that the effect should be smaller than that, something closer to 0.1 SDs. I should apply for more funding or study something else.”</p>
<p>The highest level advice for redesign decisions using this approach is, at the beginning of the processes at least, to change one design parameter at a time. Vary the data strategy, holding the model, inquiry, and answer strategy constant. Change the answer strategy, while holding the other aspects of the design constant. Graphical representation of how diagnosands change as designs change is an intuitive way to do this.</p>
</div>
<div id="formal-optimization" class="section level2">
<h2>
<span class="header-section-number">11.2</span> Formal optimization<a class="anchor" aria-label="anchor" href="#formal-optimization"><i class="fas fa-link"></i></a>
</h2>
<p>A somewhat more integrated approach is to generate a diagnosand that reflects your objective function (or loss function)—which may be a combination of performance and cost—and choose the design the performs best for this diagnosand. The steps under this approach involve:</p>
<ul>
<li>Declaring a model that reflects your <em>prior</em> beliefs over underlying processes: expectations over diagnosands will be taken with respect to these priors.</li>
<li>Varying <strong>D</strong> and <strong>A</strong> over viable alternatives, recording the costs of different alternatives.</li>
<li>Declaring a diagnosand that reflects ultimate objectives including performance and cost.</li>
</ul>
<p>Consider for example a design in which we place a prior distribution over a treatment effect, <span class="math inline">\(b\)</span>. We consider designs that vary (a) the number of units studied and (b) the investment in careful measurement. Each comes with a cost. We imagine that results will be used as follows: if a <em>significant</em> treatment effect of <span class="math inline">\(b&gt;c\)</span> is estimated then an intervention is implemented which has value <span class="math inline">\(b\)</span> and cost <span class="math inline">\(c\)</span>. Our diagnosand is the expected utility from whatever policy is implemented after the study: <span class="math inline">\(b-c\)</span> if the policy is adopted, 0 otherwise. Thus it is responsive to different types of errors: implementing a weak intervention with <span class="math inline">\(b&lt;c\)</span> and failing to implement a strong intervention with <span class="math inline">\(b&gt;c\)</span>. Note of course that this policy decision rule is not <em>itself</em> optimal insofar as it is based on significance not on posteriors, yet it may still be the rule used and we may still need to know how to undertake optimal design given this rule.</p>
<p>We illustrate with a simple design in which we explicitly provide a prior distribution over the estimand and build in decision relevant parameters as arguments.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Decision parameters</span>

<span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span>  <span class="co"># Number of cases</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">1</span>     <span class="co"># Measurement error</span>
<span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">.2</span>   <span class="co"># Cost of policy</span>

<span class="co"># Design</span>
<span class="va">design</span> <span class="op">&lt;-</span> 
  <span class="fu">declare_model</span><span class="op">(</span>
    b <span class="op">=</span> <span class="fu">add_level</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
    i <span class="op">=</span> <span class="fu">add_level</span><span class="op">(</span>N <span class="op">=</span> <span class="va">N</span>, X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, Y <span class="op">=</span> <span class="fl">1</span><span class="op">+</span><span class="va">b</span><span class="op">*</span><span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_measurement</span><span class="op">(</span>Y_seen <span class="op">=</span> <span class="va">Y</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">0</span>, <span class="va">r</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_inquiry</span><span class="op">(</span>b <span class="op">=</span> <span class="va">b</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimator</span><span class="op">(</span><span class="va">Y_seen</span> <span class="op">~</span> <span class="va">X</span>, model <span class="op">=</span> <span class="va">lm_robust</span><span class="op">)</span> </code></pre></div>
<p>The key step then is to define a diagnosand that reflects choices, benefits, and costs and then assess performance over a range of designs.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Utility as a diagnosand</span>

<span class="va">diagnosands</span> <span class="op">&lt;-</span> <span class="fu">declare_diagnosands</span><span class="op">(</span>
  utility <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">p.value</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">estimate</span> <span class="op">&gt;</span> <span class="va">c</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">estimand</span> <span class="op">-</span> <span class="va">c</span><span class="op">)</span> <span class="op">-</span> <span class="va">N</span><span class="op">/</span><span class="fl">100000</span><span class="op">+</span> <span class="va">r</span><span class="op">/</span><span class="fl">250</span><span class="op">)</span><span class="op">)</span>
                                  
<span class="va">design</span> <span class="op">&lt;-</span> <span class="fu">set_diagnosands</span><span class="op">(</span><span class="va">design</span>, <span class="va">diagnosands</span><span class="op">)</span>

<span class="va">designs</span> <span class="op">&lt;-</span> <span class="fu">redesign</span><span class="op">(</span><span class="va">design</span>, N <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="fl">2</span><span class="op">^</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>, r <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>Payoffs across two decision dimensions are shown in Figure <a href="redesign-2.html#fig:optimaldesign">11.1</a>.</p>
<!-- utility <- declare_diagnosands( -->
<!--   utility_1 = mean((statistic > 1.96)*(estimate > c)*(estimand - c)), -->
<!--   utility_2 = mean((statistic > 1.96)*(estimate > c)*(estimand - c) - N/50000+ r/40), -->
<!--   power = mean(statistic > 1.96), -->
<!--   benefit_given_significant = mean(estimand[statistic > 1.96]) -->
<!-- ) -->
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu">diagnose_design</span><span class="op">(</span><span class="va">designs</span>, sims <span class="op">=</span> <span class="fl">20000</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span id="fig:optimaldesign"></span>
<img src="book_files/figure-html/optimaldesign-1.svg" alt="Utility over two design parameters." width="100%"><p class="caption">
Figure 11.1: Utility over two design parameters.
</p>
</div>
<!-- ## Redesign Mountain -->
<!-- This figure shows a schematic of the redesign process. We vary design parameter 1 and design parameter 2 independently to learn the value of the diagnosand for each combination of design parameters. The redesign process can be in more than 2 dimensions of course. We suggest varying the design parameters you have control over first. -->
<!-- ```{r redesignmountain, fig.cap = "Redesign mountain.", echo=FALSE} -->
<!-- expand.grid(param_1 = seq(0, 1, length.out = 100), -->
<!--             param_2 = seq(0, 1, length.out = 100)) %>% -->
<!--   mutate(diagnosand = 1 - sqrt((param_1 - 0.3) ^ 2 + (param_2 - 0.7) ^ 2)) %>% -->
<!--   ggplot(aes(param_1, param_2)) +  -->
<!--   geom_tile(aes(fill = diagnosand)) + -->
<!--   geom_point(x = 0.3, y = 0.7, size = 2) + -->
<!--   geom_contour(aes(z = diagnosand)) + -->
<!--   scale_fill_gradient(low = "blue", high = "red") + -->
<!--   labs(x = "Design Parameter 1", -->
<!--        y = "Design Parameter 2", -->
<!--        title = "Diagnosands change as design parameters change") -->
<!-- ``` -->
<!-- ## Redesign to assess the robustness of designs to models  -->
<!-- - Hold inquiry constant! (read Richard Crump “Moving the Goalposts”) -->
<!-- - Hold three constant, vary one of MIDA at a time -->
<!-- - M: ICC, null model, alternative DAGs, heterogeneity -->
<!-- - I: -->
<!-- Diagnosis is like this: -->
<!-- (we need a math glyph for left relation composition notation) -->
<!-- $$ -->
<!-- MIDA |> \\ -->
<!--   simulate |> \\ -->
<!--   summarize -->
<!-- $$ -->
<!-- Redesign is like this -->
<!-- $$ -->
<!-- map(parameters) |> \\ -->
<!--   MIDA |>  \\ -->
<!--   simulate |> \\  -->
<!--   group\_by(parameters) |> \\ -->
<!--   summarize -->
<!-- $$ -->

<!-- note do_bookdown is set in index.rmd, so we know if you're running just this .Rmd or compiling the book-->
<!-- start post here, do not edit above -->
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="p2diagnosis.html"><span class="header-section-number">10</span> Diagnosis</a></div>
<div class="next"><a href="part-ii-exercises.html"><span class="header-section-number">12</span> Part II Exercises</a></div>
</div></main><div id="on-this-page-nav" class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#redesign-2"><span class="header-section-number">11</span> Redesign</a></li>
<li><a class="nav-link" href="#graphical-inspection"><span class="header-section-number">11.1</span> Graphical inspection</a></li>
<li><a class="nav-link" href="#formal-optimization"><span class="header-section-number">11.2</span> Formal optimization</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="download-code" href="./redesign-2.R"><i class="far fa-file-code"></i> Download R code</a></li>
          
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Research Design: Declare, Diagnose, Redesign</strong>" was written by Graeme Blair, Alexander Coppock, and Macartan Humphreys. </p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
