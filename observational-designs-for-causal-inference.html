<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 15 Observational designs for causal inference | Research Design: Declare, Diagnose, Redesign</title>
<meta name="author" content="Graeme Blair, Alexander Coppock, and Macartan Humphreys">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<link href="libs/bs4_book-1.0.0/dd_imgpopup.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/bs4_book-1.0.0/dd_imgpopup.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://hypothes.is/embed.js" async></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Research Design: Declare, Diagnose, Redesign</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li class="book-part">Introduction</li>
<li><a class="" href="preamble.html"><span class="header-section-number">1</span> Preamble</a></li>
<li><a class="" href="improving-research-designs.html"><span class="header-section-number">2</span> Improving research designs</a></li>
<li><a class="" href="primer.html"><span class="header-section-number">3</span> Software primer</a></li>
<li><a class="" href="part-i-exercises.html"><span class="header-section-number">4</span> Part I Exercises</a></li>
<li class="book-part">Declaration, Diagnosis, Redesign</li>
<li><a class="" href="declaration-4.html"><span class="header-section-number">5</span> Declaration</a></li>
<li><a class="" href="specifying-the-model.html"><span class="header-section-number">6</span> Specifying the model</a></li>
<li><a class="" href="defining-the-inquiry.html"><span class="header-section-number">7</span> Defining the inquiry</a></li>
<li><a class="" href="crafting-a-data-strategy.html"><span class="header-section-number">8</span> Crafting a data strategy</a></li>
<li><a class="" href="choosing-an-answer-strategy.html"><span class="header-section-number">9</span> Choosing an answer strategy</a></li>
<li><a class="" href="p2diagnosis.html"><span class="header-section-number">10</span> Diagnosis</a></li>
<li><a class="" href="redesign-2.html"><span class="header-section-number">11</span> Redesign</a></li>
<li><a class="" href="part-ii-exercises.html"><span class="header-section-number">12</span> Part II Exercises</a></li>
<li class="book-part">Research Design Library</li>
<li><a class="" href="research-design-library.html"><span class="header-section-number">13</span> Research Design Library</a></li>
<li><a class="" href="observational-designs-for-descriptive-inference.html"><span class="header-section-number">14</span> Observational designs for descriptive inference</a></li>
<li><a class="active" href="observational-designs-for-causal-inference.html"><span class="header-section-number">15</span> Observational designs for causal inference</a></li>
<li><a class="" href="experimental-designs-for-causal-inference.html"><span class="header-section-number">16</span> Experimental designs for causal inference</a></li>
<li><a class="" href="experimental-designs-for-descriptive-inference.html"><span class="header-section-number">17</span> Experimental designs for descriptive inference</a></li>
<li><a class="" href="complex-designs-1.html"><span class="header-section-number">18</span> Complex designs</a></li>
<li><a class="" href="part-iii-exercises.html"><span class="header-section-number">19</span> Part III Exercises</a></li>
<li class="book-part">Research Design Lifecycle</li>
<li><a class="" href="research-design-lifecycle.html"><span class="header-section-number">20</span> Research Design Lifecycle</a></li>
<li><a class="" href="before.html"><span class="header-section-number">21</span> Before</a></li>
<li><a class="" href="model-2.html"><span class="header-section-number">22</span> Model</a></li>
<li><a class="" href="inquiry-2.html"><span class="header-section-number">23</span> Inquiry</a></li>
<li><a class="" href="data-strategy-2.html"><span class="header-section-number">24</span> Data strategy</a></li>
<li><a class="" href="answer-strategy-2.html"><span class="header-section-number">25</span> Answer strategy</a></li>
<li><a class="" href="during.html"><span class="header-section-number">26</span> During</a></li>
<li><a class="" href="after.html"><span class="header-section-number">27</span> After</a></li>
<li><a class="" href="part-iv-exercises.html"><span class="header-section-number">28</span> Part IV Exercises</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="observational-designs-for-causal-inference" class="section level1">
<h1>
<span class="header-section-number">15</span> Observational designs for causal inference<a class="anchor" aria-label="anchor" href="#observational-designs-for-causal-inference"><i class="fas fa-link"></i></a>
</h1>
<p>section introduction</p>
<p>cite <span class="citation">Dunning (<a href="references.html#ref-dunning2012natural" role="doc-biblioref">2012</a>)</span>, <span class="citation">Angrist and Pischke (<a href="references.html#ref-angrist2008mostly" role="doc-biblioref">2008</a>)</span></p>

<!-- note do_bookdown is set in index.rmd, so we know if you're running just this .Rmd or compiling the book-->
<!-- start post here, do not edit above -->
<!-- make sure to rename the section title below -->
<div id="causal-inquiries-about-a-single-unit" class="section level2">
<h2>
<span class="header-section-number">15.1</span> Causal inquiries about a single unit<a class="anchor" aria-label="anchor" href="#causal-inquiries-about-a-single-unit"><i class="fas fa-link"></i></a>
</h2>
<p>We often start a causal investigation wanting to know the causal effect for a single unit. For a unit that experienced an event or process, we want to know the causal effect of that event. To do so, we need to know what would have happened if the event did not happen, the <em>counter</em>factual outcome as opposed to the factual outcome that actually occurred. Due to the fundamental problem of causal inference, we cannot <em>observe</em> what would have happened if that counterfactual case had happened. The event can either happen, or not happen, to each unit. As a result, we have to guess what would have happened. Social scientists have developed a large array of tools for guessing, or imputing, the missing counterfactual outcome — what would have happened in the counterfactual case, if the event had not happened.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;We are also interested in the opposite case sometimes: we have a unit that did not experience an event, and we want to know the causal effect of &lt;em&gt;not&lt;/em&gt; having it. In this case, we need to guess what would have happened if the event did happen. The same tools apply in reverse.&lt;/p&gt;"><sup>22</sup></a></p>
<p>In this section, the inquiry is the treatment effect of the treated case (TET). The TET is the difference between the treated potential outcome and the control potential outcome in the posttreatment period for the treated unit of interest.</p>
<div class="inline-figure"><img src="book_files/figure-html/unnamed-chunk-232-1.svg" width="100%"></div>
<div id="process-tracing" class="section level3">
<h3>
<span class="header-section-number">15.1.1</span> Process tracing<a class="anchor" aria-label="anchor" href="#process-tracing"><i class="fas fa-link"></i></a>
</h3>
<!-- fearon1991, biqq -->
</div>
<div id="before-after-comparison" class="section level3">
<h3>
<span class="header-section-number">15.1.2</span> Before-after comparison<a class="anchor" aria-label="anchor" href="#before-after-comparison"><i class="fas fa-link"></i></a>
</h3>
<p>A natural idea for guessing what would have happened if an event did not occur for a single unit is to look within that unit at what happened <em>before</em> the event did occur. Within-unit over-time comparisons use outcomes in pretreatment periods to impute the posttreatment counterfactual outcome.</p>
<p>In order for the pretreatment outcome to be a good stand-in for the posttreatment control potential outcome, we must invoke two assumptions: excludability of time; and no interference between time periods. The excludability assumption says that the only change between pre and post is the fact that the treatment is administered. This rules out time trends and any other form of time-varying heterogeneity aside from the treatment status. The second assumption is that the unit is assigned to control in the pretreatment period cannot affect outcomes in the posttreatment period, and the fact that the unit is treated in the second period cannot affect outcomes in the first period. This is often called a no carryover assumption, and most importantly in this case rules out the possibility of effects of anticipating treatment in the next period. If the unit expects to be treated in period 1, this may affect the outcome in period 0 even though treatment has not yet been administered. Often anticipation effects wash out treatment effects; it is as if the treatment has already taken place.</p>
<p>To declare this design, we consider violations of the excludability assumption. The inquiry is the TET, as in all designs in this section. In the model, we consider two sources of heterogeneity in the outcome: time trends (an effect of time) and time-varying heterogeneity (an effect of <span class="math inline">\(U_{\rm time}\)</span>). Potential outcomes are a function of these two variables and the treatment variable. Our data strategy is to measure <span class="math inline">\(Y\)</span> in both periods, and this will reveal the control potential outcome in the first period, before treatment, and the control potential outcome in the second period, after treatment. Our answer strategy is to take the difference in the outcome between the post- and pretreatment periods.</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span> 
  <span class="fu">declare_population</span><span class="op">(</span>
    N <span class="op">=</span> <span class="fl">2</span>, 
    time <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>,
    U_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>,
    <span class="fu">potential_outcomes</span><span class="op">(</span>
      <span class="va">Y</span> <span class="op">~</span> <span class="va">time_trend</span> <span class="op">*</span> <span class="va">time</span> <span class="op">+</span> <span class="va">time_specific_effect</span> <span class="op">*</span> <span class="va">U_time</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Z</span>
    <span class="op">)</span>,
    Z <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_estimand</span><span class="op">(</span>TET <span class="op">=</span> <span class="va">Y_Z_1</span> <span class="op">-</span> <span class="va">Y_Z_0</span>, subset <span class="op">=</span> <span class="va">time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_measurement</span><span class="op">(</span>Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">0</span>, <span class="va">Y_Z_0</span>, <span class="va">Y_Z_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_estimator</span><span class="op">(</span>
    estimate <span class="op">=</span> <span class="va">Y</span><span class="op">[</span><span class="va">time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">Y</span><span class="op">[</span><span class="va">time</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span>, 
    estimand_label <span class="op">=</span> <span class="st">"TET"</span>, handler <span class="op">=</span> <span class="va">summarize</span><span class="op">)</span>

<span class="va">designs</span> <span class="op">&lt;-</span> <span class="fu">redesign</span><span class="op">(</span>
  <span class="va">design</span>, time_trend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>, time_specific_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu">diagnose_design</span><span class="op">(</span><span class="va">designs</span>, sims <span class="op">=</span> <span class="va">sims</span>, bootstrap_sims <span class="op">=</span> <span class="va">b_sims</span><span class="op">)</span></code></pre></div>
<p>We diagnose the design in four settings, the two-by-two of: with and without time trends, and with and without time-specific effects. We see that the over-time within-unit design is only unbiased when there are neither. If there are time trends, there is bias, due to a violation of the excludability of time assumption. If there is time-varying heterogeneity aside from the treatment, the excludability assumption is also violated. There is no test for these two conditions that lead to bias, and there is no diagnostic like the pretrends comparison for the difference-in-difference design.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:right;">
time_trend
</th>
<th style="text-align:right;">
time_specific_effect
</th>
<th style="text-align:right;">
bias
</th>
<th style="text-align:right;">
se(bias)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.500
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.011
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.470
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="posttreatment-comparison-to-an-untreated-case" class="section level3">
<h3>
<span class="header-section-number">15.1.3</span> Posttreatment comparison to an untreated case<a class="anchor" aria-label="anchor" href="#posttreatment-comparison-to-an-untreated-case"><i class="fas fa-link"></i></a>
</h3>
<p>A second natural design is to compare the outcomes of the treated case after to treatment to the outcomes in another unit in the same time period that did not receive the treatment. Instead of filling in the control potential outcome of the treated unit with its own outcome in the pretreatment period, we fill it in with the outcomes of this second “control” unit.</p>
<p>We can invoke an exactly parallel set of assumptions to the over time within unit design: excludability of the unit difference (rather than time), i.e., the only difference between the two units is the treatment status and not other unit-specific heterogeneity. This strong assumption is often relaxed in favor of a “selection-on-observables” assumption by accounting for observable differences between units and selecting a comparison unit that is similar in all observable ways.</p>
<p>In declaring the design, we target the same TET inquiry, and swap our model of over time heterogeneity with with between-unit heterogeneity (<span class="math inline">\(U_{\rm unit}\)</span>) (there is not a parallel of time trends). Our data strategy is to measure Y for both the treated unit and the comparison unit in the posttreatment time period; the treated unit reveals its treated potential outcome, while the comparison unit reveals its control potential outcome. The answer strategy is the posttreatment comparison between the treated and control unit.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span> 
  <span class="fu">declare_population</span><span class="op">(</span>
    N <span class="op">=</span> <span class="fl">2</span>, 
    time <span class="op">=</span> <span class="fl">1</span>,
    U_unit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>,
    <span class="fu">potential_outcomes</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Z</span> <span class="op">+</span> <span class="va">unit_specific_effect</span> <span class="op">*</span> <span class="va">U_unit</span><span class="op">)</span>,
    Z <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">U_unit</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">U_unit</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_estimand</span><span class="op">(</span>TET <span class="op">=</span> <span class="va">Y_Z_1</span> <span class="op">-</span> <span class="va">Y_Z_0</span>, subset <span class="op">=</span> <span class="va">time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_measurement</span><span class="op">(</span>Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span>, <span class="va">Y_Z_0</span>, <span class="va">Y_Z_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_estimator</span><span class="op">(</span>
    estimate <span class="op">=</span> <span class="va">Y</span><span class="op">[</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">Y</span><span class="op">[</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span>, 
    estimand_label <span class="op">=</span> <span class="st">"TET"</span>, handler <span class="op">=</span> <span class="va">summarize</span><span class="op">)</span>

<span class="va">designs</span> <span class="op">&lt;-</span> <span class="fu">redesign</span><span class="op">(</span><span class="va">design</span>, unit_specific_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu">diagnose_design</span><span class="op">(</span><span class="va">designs</span>, sims <span class="op">=</span> <span class="va">sims</span>, bootstrap_sims <span class="op">=</span> <span class="va">b_sims</span><span class="op">)</span></code></pre></div>
<p>We diagnose the two-unit posttreatment comparison design under two settings: with and without unit-specific differences not accounted for by observables, aside from the treatment. With these differences, the excludability assumption is violated. We see that the design is only unbiased for the TET if there are no such unit-specific differences besides treatment.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:right;">
unit_specific_effect
</th>
<th style="text-align:right;">
bias
</th>
<th style="text-align:right;">
se(bias)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.154
</td>
<td style="text-align:right;">
0.012
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="difference-in-differences-1" class="section level3">
<h3>
<span class="header-section-number">15.1.4</span> Difference-in-differences<a class="anchor" aria-label="anchor" href="#difference-in-differences-1"><i class="fas fa-link"></i></a>
</h3>
<p>When the over-time excludability of treatment and the selection-on-observables assumptions are unreasonable, an alternative is the difference-in-differences design. We difference out unit characteristics, whether observable or not, that do not vary over time by comparing the outcomes before and after treatment. What is left is time trends and other unit-invariant time-varying factors, and we difference these out by comparing the change over time in the treated unit to the change over time in the comparison unit. Each difference takes out one class of factors that would violate the excludability assumptions of over-time within unit designs alone or posttreatment comparison across-unit designs alone.</p>
<p>The difference-in-difference design does not rely on the assumptions the earlier two designs do. But it adds a new assumption: the parallel trends assumption. In order for the difference-in-difference design to work, the change between before and after treatment in the control potential outcomes must be equal (i.e., parallel). Because this assumption depends on the change in values of the unrealized (and thus unobservable) control potential outcome in the treated unit, it cannot be tested. There is a widely-used diagnostic of the difference in observed trends before treatment […]</p>
<p>Declaring this design combines the elements of the within-unit over time and between-unit posttreatment designs. We have two units (the treated unit and its comparison unit), and two time periods, before (0) and after treatment (1). There is unit-specific, time invariant heterogeneity (<span class="math inline">\(U_{\rm unit}\)</span>), and unit-invariant over time heterogeneity (<span class="math inline">\(U_{\rm time}\)</span>). The potential outcomes are a function of treatment, these heterogeneity variables, and time trends. We target the same TET inquiry as the other designs. We measure the outcome in a way that combines the two previous designs: the control potential outcome is revealed in both periods for the comparison untreated unit <em>and</em> in the pretreatmetn period for the treated unit, and the treated potential outocme is revealed in the posttreatment period of the treated unit. The answer strategy is the difference-in-differences, first differencing off within-unit changes from first to second period then across-unit changes in the comparison unit.</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span> 
  <span class="fu">declare_population</span><span class="op">(</span>
    unit <span class="op">=</span> <span class="fu">add_level</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">2</span>, U_unit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, Z <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">U_unit</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">U_unit</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
    period <span class="op">=</span> <span class="fu">add_level</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">2</span>, time <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, U_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, nest <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
    unit_period <span class="op">=</span> <span class="fu">cross_levels</span><span class="op">(</span>
      by <span class="op">=</span> <span class="fu">join</span><span class="op">(</span><span class="va">unit</span>, <span class="va">period</span><span class="op">)</span>, 
      U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, sd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>,
      <span class="fu">potential_outcomes</span><span class="op">(</span>
        <span class="va">Y</span> <span class="op">~</span> <span class="va">time_trend</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">time</span> <span class="op">+</span> 
          <span class="va">time_specific_effect</span> <span class="op">*</span> <span class="va">U_time</span> <span class="op">+</span> 
          <span class="va">unit_specific_effect</span> <span class="op">*</span> <span class="va">U_unit</span> <span class="op">+</span> 
          <span class="fl">1.25</span> <span class="op">*</span> <span class="va">Z</span> <span class="op">+</span> <span class="va">U</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_estimand</span><span class="op">(</span>TET <span class="op">=</span> <span class="va">Y_Z_1</span> <span class="op">-</span> <span class="va">Y_Z_0</span>, subset <span class="op">=</span> <span class="va">time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_measurement</span><span class="op">(</span>Y <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">period</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">Y_Z_0</span>, <span class="va">Y_Z_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_estimator</span><span class="op">(</span>
    estimate <span class="op">=</span> 
      <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">time</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> 
      <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">time</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, 
    estimand_label <span class="op">=</span> <span class="st">"ATT"</span>, handler <span class="op">=</span> <span class="va">summarize</span><span class="op">)</span>

<span class="va">designs</span> <span class="op">&lt;-</span> <span class="fu">redesign</span><span class="op">(</span><span class="va">design</span>, 
                    time_trend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>, 
                    time_specific_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, 
                    unit_specific_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu">diagnose_design</span><span class="op">(</span><span class="va">designs</span>, sims <span class="op">=</span> <span class="va">sims</span>, bootstrap_sims <span class="op">=</span> <span class="va">b_sims</span><span class="op">)</span></code></pre></div>
<p>We diagnose the difference-in-difference design under eight cases, the combinations of: with and without time trends in outcomes; with and without other, time-varying unit-invariant heterogeneity; and with and without unit-specific time-invariant heterogeneity. We see the power of the difference-in-difference design: under any of these alternatives, the design is unbiased for the TET inquiry. In the over-time within-unit design and the posttreatment comparison across units design, the design is unbiased only if the relevant one of these conditions holds. Unfortunately, there are no tests of the validity of those assumptions.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:right;">
time_trend
</th>
<th style="text-align:right;">
time_specific_effect
</th>
<th style="text-align:right;">
unit_specific_effect
</th>
<th style="text-align:right;">
bias
</th>
<th style="text-align:right;">
se(bias)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="synthetic-controls-1" class="section level3">
<h3>
<span class="header-section-number">15.1.5</span> Synthetic controls<a class="anchor" aria-label="anchor" href="#synthetic-controls-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span> 
  <span class="fu">declare_population</span><span class="op">(</span>
    units <span class="op">=</span> <span class="fu">add_level</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">10</span>, unit_ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, U_unit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, Z <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">unit_ID</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>, <span class="co"># if_else(U_unit == max(U_unit), 1, 0)),</span>
    periods <span class="op">=</span> <span class="fu">add_level</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">3</span>, time <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span>, U_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, nest <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
    unit_periods <span class="op">=</span> <span class="fu">cross_levels</span><span class="op">(</span>
      by <span class="op">=</span> <span class="fu">join</span><span class="op">(</span><span class="va">units</span>, <span class="va">periods</span><span class="op">)</span>, 
      U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>,
      <span class="fu">potential_outcomes</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">time_trend</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">time</span> <span class="op">+</span> <span class="va">time_specific_effect</span> <span class="op">*</span> <span class="va">U_time</span> <span class="op">+</span> 
          <span class="va">unit_specific_effect</span> <span class="op">*</span> <span class="va">U_unit</span> <span class="op">+</span> 
            <span class="fl">1.25</span> <span class="op">*</span> <span class="va">Z</span> <span class="op">+</span> <span class="va">X</span> <span class="op">+</span> <span class="va">U</span><span class="op">)</span>,
      Y <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">time</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="va">Y_Z_0</span>, <span class="va">Y_Z_1</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_estimand</span><span class="op">(</span>ATT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y_Z_1</span> <span class="op">-</span> <span class="va">Y_Z_0</span><span class="op">)</span>, subset <span class="op">=</span> <span class="va">time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_measurement</span><span class="op">(</span>predictors <span class="op">=</span> <span class="st">"X"</span>,
                    time.predictors.prior <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">0</span>,
                    dependent <span class="op">=</span> <span class="st">"Y"</span>,
                    unit.variable <span class="op">=</span> <span class="st">"unit_ID"</span>,
                    time.variable <span class="op">=</span> <span class="st">"time"</span>,
                    treatment.identifier <span class="op">=</span> <span class="fl">1</span>,
                    controls.identifier <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>, 
                    handler <span class="op">=</span> <span class="va">synth_weights_tidy</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimator</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Z</span>, subset <span class="op">=</span> <span class="va">time</span> <span class="op">==</span> <span class="fl">1</span>, weights <span class="op">=</span> <span class="va">synth_weights</span>, 
                    model <span class="op">=</span> <span class="va">lm_robust</span>, label <span class="op">=</span> <span class="st">"synth"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">designs</span> <span class="op">&lt;-</span> <span class="fu">redesign</span><span class="op">(</span><span class="va">design</span>, 
                    time_trend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>, 
                    time_specific_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, 
                    unit_specific_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu">diagnose_design</span><span class="op">(</span><span class="va">designs</span>, sims <span class="op">=</span> <span class="fl">5000</span>, diagnosands <span class="op">=</span> <span class="fu">declare_diagnosands</span><span class="op">(</span>bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">estimate</span> <span class="op">-</span> <span class="va">estimand</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu">get_diagnosands</span><span class="op">(</span><span class="va">diagnosis</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">time_trend</span>, <span class="va">time_specific_effect</span>, <span class="va">unit_specific_effect</span>, <span class="va">bias</span>, <span class="va">`se(bias)`</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></code></pre></div>

<!-- note do_bookdown is set in index.rmd, so we know if you're running just this .Rmd or compiling the book-->
<!-- start post here, do not edit above -->
<!-- make sure to rename the section title below -->
</div>
</div>
<div id="observational-causal-inference-for-multiple-units" class="section level2">
<h2>
<span class="header-section-number">15.2</span> Observational causal inference for multiple units<a class="anchor" aria-label="anchor" href="#observational-causal-inference-for-multiple-units"><i class="fas fa-link"></i></a>
</h2>
<div id="over-time-change-within-units" class="section level3">
<h3>
<span class="header-section-number">15.2.1</span> Over-time change within units<a class="anchor" aria-label="anchor" href="#over-time-change-within-units"><i class="fas fa-link"></i></a>
</h3>
<!-- no time trend -->
</div>
<div id="posttreatment-differences" class="section level3">
<h3>
<span class="header-section-number">15.2.2</span> Posttreatment differences<a class="anchor" aria-label="anchor" href="#posttreatment-differences"><i class="fas fa-link"></i></a>
</h3>
<!-- SOO -->
</div>
<div id="difference-in-differences-2" class="section level3">
<h3>
<span class="header-section-number">15.2.3</span> Difference-in-differences<a class="anchor" aria-label="anchor" href="#difference-in-differences-2"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="synthetic-control" class="section level3">
<h3>
<span class="header-section-number">15.2.4</span> Synthetic control<a class="anchor" aria-label="anchor" href="#synthetic-control"><i class="fas fa-link"></i></a>
</h3>

<!-- note do_bookdown is set in index.rmd, so we know if you're running just this .Rmd or compiling the book-->
<!-- start post here, do not edit above -->
<!-- make sure to rename the section title below -->
</div>
</div>
<div id="p3iv" class="section level2">
<h2>
<span class="header-section-number">15.3</span> Instrumental variables<a class="anchor" aria-label="anchor" href="#p3iv"><i class="fas fa-link"></i></a>
</h2>
<p>When we are unwilling or unable to credibly assert that we have blocked all back-door paths between a treatment <span class="math inline">\(D\)</span> and the outcome <span class="math inline">\(Y\)</span> – that is, when the selection-on-observables assumption fails – we might have to give up on our goal of drawing causal inferences.</p>
<p>But occasionally, the world yields an opportunity to sidestep unobserved confounding by generating as-if random variation in a variable that itself affects the treatment variable. We call the variable that is as-if randomly assigned by the world an “instrument.”</p>
<p>Before we delve into the intricacies of the instrumental variables design – and there are many – it’s worth considering what a special thing an instrument is. Instruments are variables that are randomly assigned by nature, the government, or other powers-that-be. Usually, genuine random assignments have to be crafted by researchers as part of a deliberate data strategy. Experimenters go to great lengths to randomly expose some units but not others to treatments. When the world provides bonafide random variation in something, it’s a rare and valuable opportunity. By virtue of as-if random assignment, we can learn about the average causal effects of the instrument itself without any further consternation. Conditional on geography and season, weather conditions are as-if randomly assigned, so we can learn about the average effects of rainfall on many outcomes, like crop yields, voter turnout, and attendance at sporting events. Conditional on gender and birth year, draft numbers are randomly assigned by the government, so we can learn about the average effects of being drafted on educational attainment, future earnings, or public policy preferences. In the argot of instrument variables, the effect of the instrument is called the “reduced form” or the “intention-to-treat” (ITT) effect. If it’s really true that the instrument is randomly assigned by the world, estimation of the reduced form effect is straightforward.</p>
<p>The trouble comes when we want to leverage the random assignment of the instrument (<span class="math inline">\(Z\)</span>) to learn about the average causal effects of a treatment variable (<span class="math inline">\(D\)</span>) on the outcome (<span class="math inline">\(Y\)</span>). To do so, we first need to change the inquiry from the average treatment effect of <span class="math inline">\(D\)</span> on <span class="math inline">\(Y\)</span> to the “local” average treatment effect, or LATE. The name of the inquiry reflects the idea that the effect applies only to the specific group of units whose treatment status changes as a result of the instrument. This group is often called the “compliers.” The LATE is <span class="math inline">\(\mathbb{E}[Y_i(D_i = 1) - Y_i(D_i = 0) | D_i(Z_i = 1) &gt; D_i(Z_i = 0)]\)</span> – the average treatment effect among the group of people whose value of the treatment is higher as a result of the treatment. The LATE is different from the ATE because it does not average over those units whose value of the treatment does not depend on the instrument. Secondly, we need to assure ourselves of the five (5) instrumental variables assumptions. In the case of a binary instrument and a binary treatment, these are:</p>
<ol style="list-style-type: decimal">
<li><p>Exogeneity of the instrument: <span class="math inline">\(Y_i(D_i = 1), Y_i(D_i = 0), D_i(Z_i = 1), D_i(Z_i = 0) \perp \!\!\! \perp Z_i | X_i\)</span>. Substantively, this assumption requires that (possibly conditional on observed covariates in <span class="math inline">\(X\)</span>) the instrument is as-if randomly, so it is jointly independent of the treated and untreated potential outcomes as well as the potential values the treatment variable <span class="math inline">\(D\)</span> would take on depending on the values of the instrument <span class="math inline">\(Z\)</span>. Exogeneity is usually justified on the basis of qualitative knowledge of why as-if random assignment is a reasonable assumption to make. The assumption can be bolstered with design checks like the balance on pre-treatment values of the covariates according to the levels of the instrument.</p></li>
<li><p>Excludability of the instrument: <span class="math inline">\(Y_i(D_i(Z_i), Z_i) = Y_i(D_i(Z_i))\)</span>. We can “exclude” the instrument from the potential outcomes function <span class="math inline">\(Y_i()\)</span> – the only relevant argument is the value of the treatment variable. Another way of thinking about this exclusion restriction is to conceive of it as the “total mediation assumption,” by which we mean that <span class="math inline">\(Z\)</span> has exactly no effect on <span class="math inline">\(Y\)</span> except by changing the value of <span class="math inline">\(D\)</span>. Under the exclusion restriction, the effect of the instrumental variable is wholly mediated by the treatment variable. The exclusion restriction cannot be demonstrated empirically and typically must be asserted on qualitative grounds. Since the reduced form of the instrument can be estimated for many different outcome variables, one piece of evidence that can bolster the exclusion restition is to show how the instrument does not affect other plausible causal precedents of the outcome variable. If it does affect other variables that might, in turn, affect the outcome, doubt may be cast on the exclusion restriction.</p></li>
<li><p>Non-interference: <span class="math inline">\(Y(D_i(Z_i), D_{-i}, Z_{-i}) = Y(D_i(Z_i))\)</span>. Like any non-interference assumption, here we assert that for any particular unit, other units’ values of the instrument or the treatment do not affect the outcome.</p></li>
<li><p>Monotonicity: <span class="math inline">\(D_i(Z_i = 1) \geq D_i(Z_i = 0), \forall_i\)</span>. This assumption states that the effect of the instrument on the treatment is either zero or is positive for all units. Monotonicity rules odd types (called “defiers”) who would have <span class="math inline">\(D = 1\)</span> if <span class="math inline">\(Z = 0\)</span> but would have <span class="math inline">\(D = 0\)</span> if <span class="math inline">\(Z = 1\)</span>. Monotonicity is usually quite plausible (it’s tough to imagine a person who would serve in the military if not drafted but <em>would</em> serve if drafted!), but it’s not possible to affirm empirically. An empirical test that demonstrates a positive effect of the instrument on the treatment for one group but a negative effect for a different group could, however, falsify the monotonicity assumption.</p></li>
<li><p>Non-zero effect of the instrument on the treatment. If the instrument does not affect the treatment, then it is useless for learning about the effects of the treatment on the outcome, simply because it generates no compliers. If there are no compliers, the LATE itself is undefined.</p></li>
</ol>
<p>If all five of these assumptions are met, it can be shown that <span class="math inline">\(LATE = \frac{\text{Reduced Form}}{\text{First Stage}}\)</span>. This expression underlines the importance of assumption 5 – if the instrument doesn’t affect the treatment, the first stage is equal to zero and the ratio is undefined. A plug-in estimator of the LATE is the difference-in-means of the outcome according to the instrument divided by the difference-in-means of the treatment according to the instrument. Equivalently, we can use two-stage least squares, which will yield the identical answer as the ratio of the difference-in-means estimates in the no covariate-adjustment case.</p>
<p>The instrumental variables setup is perfectly analogous to a randomized experiment with noncompliance. The instrument is equivalent to the random <em>assignment</em>. If some units do not comply with their assignment (some in the treatment group don’t take treatment or some in the control group <em>do</em> take treatment), then a comparison of groups according to the treatment variable will be biased by unobserved confounding. The best we can do under noncompliance is to redefine the estimand to be the complier average causal effect (equivalent to the LATE), then estimate it via two-stage least squares. The required excludability assumption is that the assignment to treatment can’t affect the outcome except through the realized treatment variable, which may or may not hold in a given experimental setting.</p>
<div id="declaration-8" class="section level3">
<h3>
<span class="header-section-number">15.3.1</span> Declaration<a class="anchor" aria-label="anchor" href="#declaration-8"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span>
  <span class="fu">declare_population</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100</span>, U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_potential_outcomes</span><span class="op">(</span><span class="va">D</span> <span class="op">~</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">Z</span> <span class="op">+</span> <span class="va">U</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, 
                             assignment_variables <span class="op">=</span> <span class="va">Z</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_potential_outcomes</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">D</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">+</span> <span class="va">U</span>, 
                             assignment_variables <span class="op">=</span> <span class="va">D</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimand</span><span class="op">(</span>LATE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y_D_1</span><span class="op">[</span><span class="va">D_Z_1</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">D_Z_0</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">-</span> 
                                 <span class="va">Y_D_0</span><span class="op">[</span><span class="va">D_Z_1</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">D_Z_0</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_assignment</span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">reveal_outcomes</span><span class="op">(</span><span class="va">D</span>, <span class="va">Z</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">reveal_outcomes</span><span class="op">(</span><span class="va">Y</span>, <span class="va">D</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">declare_estimator</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">D</span> <span class="op">|</span> <span class="va">Z</span>, model <span class="op">=</span> <span class="va">iv_robust</span>, estimand <span class="op">=</span> <span class="st">"LATE"</span><span class="op">)</span> </code></pre></div>
</div>
<div id="dag-8" class="section level3">
<h3>
<span class="header-section-number">15.3.2</span> DAG<a class="anchor" aria-label="anchor" href="#dag-8"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-figure"><img src="book_files/figure-html/unnamed-chunk-259-1.svg" width="100%"></div>
</div>
<div id="redesign-3" class="section level3">
<h3>
<span class="header-section-number">15.3.3</span> Redesign<a class="anchor" aria-label="anchor" href="#redesign-3"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>excludability violations</li>
<li>if you do, go <span class="math inline">\(ITT_d\)</span> and <span class="math inline">\(ITT_y\)</span>
</li>
</ul>
</div>
<div id="example-5" class="section level3">
<h3>
<span class="header-section-number">15.3.4</span> Example<a class="anchor" aria-label="anchor" href="#example-5"><i class="fas fa-link"></i></a>
</h3>
<p>Instrument is the gender match of the second child with the first child
treatment is family size
outcome variable is labor force participation.</p>
<p>The treatment causes decreases in labor for participation for women parents but not men parents.</p>
</div>
<div id="further-reading-9" class="section level3">
<h3>
<span class="header-section-number">15.3.5</span> Further reading<a class="anchor" aria-label="anchor" href="#further-reading-9"><i class="fas fa-link"></i></a>
</h3>
<p>– discussion of Deaton and Cartwright’s critique of IV (our reiterpretation is they are saying IV is biased for ATE; response is that IV targets LATE and is unbiased for late; if we are clear about inquiry and data+answer strategy we can be more clear about the debate)</p>
<p>Applications</p>
<ul>
<li>Mo, Cecilia Hyunjung, Katherine Conn, Georgia Anderson-Nilsson. 2019. “Can National Service Activism Activate Women’s Political Ambition? Evidence from Teach For America.” Politics, Groups, and Identities 7(4): 864-877.</li>
</ul>
<p>Methodological literature</p>
<ul>
<li>
<span class="citation">Angrist and Pischke (<a href="references.html#ref-angrist2008mostly" role="doc-biblioref">2008</a>)</span> ch. 4 on instrumental variables estimation</li>
<li>
<span class="citation">Alan S. Gerber and Green (<a href="references.html#ref-Gerber2012" role="doc-biblioref">2012</a>)</span> ch. 5 and ch. 6 on the connection between IV and noncompliance in an experiment
<!-- - @heckman2006understanding -->
</li>
<li>
<span class="citation">Deaton (<a href="references.html#ref-deaton2009instruments" role="doc-biblioref">2010</a>)</span> for a critique of the LATE as an estimand and <span class="citation">Imbens (<a href="references.html#ref-imbens2010better" role="doc-biblioref">2010</a>)</span> for a rejoinder.</li>
</ul>
<!-- note do_bookdown is set in index.rmd, so we know if you're running just this .Rmd or compiling the book--><!-- start post here, do not edit above -->
</div>
</div>
<div id="RDD" class="section level2">
<h2>
<span class="header-section-number">15.4</span> Regression Discontinuity<a class="anchor" aria-label="anchor" href="#RDD"><i class="fas fa-link"></i></a>
</h2>
<div id="declaration-9" class="section level3">
<h3>
<span class="header-section-number">15.4.1</span> Declaration<a class="anchor" aria-label="anchor" href="#declaration-9"><i class="fas fa-link"></i></a>
</h3>
<p>Regression discontinuity designs exploit substantive knowledge that treatment is assigned in a particular way: everyone above a threshold is assigned to treatment and everyone below it is not. Even though researchers do not control the assignment, substantive knowledge about the threshold serves as a basis for a strong identification claim.</p>
<p>Thistlewhite and Campbell introduced the regression discontinuity design in the 1960s to study the impact of scholarships on academic success. Their insight was that students with a test score just above a scholarship cutoff were plausibly comparable to students whose scores were just below the cutoff, so any differences in future academic success could be attributed to the scholarship itself.</p>
<p>Regression discontinuity designs identify a <em>local</em> average treatment effect: the average effect of treatment <em>exactly at the cutoff</em>. The main trouble with the design is that there is vanishingly little data exactly at the cutoff, so any answer strategy needs to use data that is some distance away from the cutoff. The further away from the cutoff we move, the larger the threat of bias.</p>
<p>We’ll consider an application of the regression discontinuity design that examines party incumbency advantage – the effect of a party winning an election on its vote margin in the next election.</p>
<div id="declaration-10" class="section level4">
<h4>
<span class="header-section-number">15.4.1.1</span> Declaration<a class="anchor" aria-label="anchor" href="#declaration-10"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<p><strong>M</strong>odel: Regression discontinuity designs have four components: A running variable, a cutoff, a treatment variable, and an outcome. The cutoff determines which units are treated depending on the value of the running variable.</p>
<p>In our example, the running variable <span class="math inline">\(X\)</span> is the Democratic party’s margin of victory at time <span class="math inline">\(t-1\)</span>; and the treatment, <span class="math inline">\(D\)</span>, is whether the Democratic party won the election in time <span class="math inline">\(t-1\)</span>. The outcome, <span class="math inline">\(Y\)</span>, is the Democratic vote margin at time <span class="math inline">\(t\)</span>. We’ll consider a population of 1,000 of these pairs of elections.</p>
<p>A major assumption required for regression discontinuity is that the conditional expectation functions for both treatment and control potential outcomes are continuous at the cutoff.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;An alternative motivation for some designs that do not rely on continuity at the cutoff is “local randomization”.&lt;/p&gt;"><sup>23</sup></a> To satisfy this assumption, we specify two smooth conditional expectation functions, one for each potential outcome. The figure plots <span class="math inline">\(Y\)</span> (the Democratic vote margin at time <span class="math inline">\(t\)</span>) against <span class="math inline">\(X\)</span> (the margin at time <span class="math inline">\(t-1\)</span>). We’ve also plotted the true conditional expectation functions for the treated and control potential outcomes. The solid lines correspond to the observed data and the dashed lines correspond to the unobserved data.</p>
</li>
</ul>
<div class="inline-figure"><img src="book_files/figure-html/unnamed-chunk-266-1.svg" width="100%"></div>
<ul>
<li><p><strong>I</strong>nquiry: Our estimand is the effect of a Democratic win in an election on the Democratic vote margin of the next election, when the Democratic vote margin of the first election is zero. Formally, it is the difference in the conditional expectation functions of the control and treatment potential outcomes when the running variable is exactly zero. The black vertical line in the plot shows this difference.</p></li>
<li><p><strong>D</strong>ata strategy: We collect data on the Democratic vote share at time <span class="math inline">\(t-1\)</span> and time <span class="math inline">\(t\)</span> for all 1,000 pairs of elections. There is no sampling or random assignment.</p></li>
<li><p><strong>A</strong>nswer strategy: We will approximate the treated and untreated conditional expectation functions to the left and right of the cutoff using a flexible regression specification estimated via OLS. In particular, we fit each regression using a fourth-order polynomial. Much of the literature on regression discontinuity designs focuses on the tradeoffs among answer strategies, with many analysts recommending against higher-order polynomial regression specifications. We use one here to highlight how well such an answer strategy does when it matches the functional form in the model. We discuss alternative estimators in the exercises.</p></li>
</ul>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">control</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">4</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.7</span>, <span class="op">-</span><span class="fl">.8</span>, <span class="fl">.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>
<span class="va">treatment</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">4</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="fl">.5</span>, <span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">.15</span><span class="op">}</span>

<span class="va">design</span> <span class="op">&lt;-</span>
  <span class="fu">declare_population</span><span class="op">(</span>
    N <span class="op">=</span> <span class="fl">1000</span>,
    U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span>,
    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="va">U</span> <span class="op">-</span> <span class="va">cutoff</span>,
    D <span class="op">=</span> <span class="fl">1</span> <span class="op">*</span> <span class="op">(</span><span class="va">X</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_potential_outcomes</span><span class="op">(</span>
    <span class="va">Y</span> <span class="op">~</span> <span class="va">D</span> <span class="op">*</span> <span class="fu">treatment</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">D</span><span class="op">)</span> <span class="op">*</span> <span class="fu">control</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="va">U</span>, 
    assignment_variable <span class="op">=</span> <span class="va">D</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimand</span><span class="op">(</span>LATE <span class="op">=</span> <span class="fu">treatment</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">-</span> <span class="fu">control</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">reveal_outcomes</span><span class="op">(</span><span class="va">Y</span>, <span class="va">D</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">declare_estimator</span><span class="op">(</span>
    <span class="va">Y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">*</span> <span class="va">D</span>, 
    model <span class="op">=</span> <span class="va">lm_robust</span>, 
    estimand <span class="op">=</span> <span class="st">"LATE"</span>
  <span class="op">)</span></code></pre></div>
</div>
</div>
<div id="dag-9" class="section level3">
<h3>
<span class="header-section-number">15.4.2</span> DAG<a class="anchor" aria-label="anchor" href="#dag-9"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-figure"><img src="book_files/figure-html/unnamed-chunk-268-1.svg" width="100%"></div>
</div>
<div id="example-6" class="section level3">
<h3>
<span class="header-section-number">15.4.3</span> Example<a class="anchor" aria-label="anchor" href="#example-6"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="exercises-5" class="section level3">
<h3>
<span class="header-section-number">15.4.4</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-5"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><span class="citation">Gelman and Imbens (<a href="references.html#ref-gelman2017high" role="doc-biblioref">2017</a>)</span> point out that higher order polynomial regression specifications lead to extreme regression weights. One approach to obtaining better estimates is to select a bandwidth, <span class="math inline">\(h\)</span>, around the cutoff, and run a linear regression. Declare a sampling procedure that subsets the data to a bandwidth around the threshold, as well as a first order linear regression specification, and analyze how the power, bias, RMSE, and coverage of the design vary as a function of the bandwidth.</p></li>
<li><p>The <code>rdrobust</code> estimator in the <code>rdrobust</code> package implements a local polynomial estimator that automatically selects a bandwidth for the RD analysis and bias-corrected confidence intervals. Declare another estimator using the <code>rdrobust</code> function and add it to the design. How does the coverage and bias of this estimator compare to the regression approaches declared above?</p></li>
<li><p>Reduce the number of polynomial terms of the <code>treatment()</code> and <code>control()</code> functions and assess how the bias of the design changes as the potential outcomes become increasingly linear as a function of the running variable.</p></li>
<li><p>Redefine the population function so that units with higher potential outcome are more likely to locate just above the cutoff than below it. Assess whether and how this affects the bias of the design.</p></li>
</ol>
</div>
<div id="further-reading-10" class="section level3">
<h3>
<span class="header-section-number">15.4.5</span> Further Reading<a class="anchor" aria-label="anchor" href="#further-reading-10"><i class="fas fa-link"></i></a>
</h3>
<!-- Since its rediscovery by social scientists in the late 1990s, the regression discontinuity design has been widely used to study diverse causal effects such as: prison on recidivism (@Ojmarrh2017); China's one child policy on human capital (@qin2017); eligibility for World Bank loans on political liberalization (@carnegie2017international); and anti-discrimination laws on minority employment (@hahn1999evaluating). -->
<!-- We've discussed a "sharp" regression discontinuity design in which all units above the threshold were treated and all units below were untreated. In fuzzy regression discontinuity designs, some units above the cutoff remain untreated or some units below take treatment. This setting is analogous to experiments that experience noncompliance and may require instrumental variables approaches to the answer strategy. -->
<!-- Geographic regression discontinuity designs use distance to a border as the running variable: units on one side of the border are treated and units on the other are untreated. @keele2016natural use such a design to study whether voters are more likely to turn out when they have the opportunity to vote directly on legislation on so-called ballot initiatives. A complication of this design is how to measure distance to the border in two dimensions. -->
<!-- - @sekhon2016understanding -->
<!-- - @delacuesta2016 -->

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="observational-designs-for-descriptive-inference.html"><span class="header-section-number">14</span> Observational designs for descriptive inference</a></div>
<div class="next"><a href="experimental-designs-for-causal-inference.html"><span class="header-section-number">16</span> Experimental designs for causal inference</a></div>
</div></main><div id="on-this-page-nav" class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#observational-designs-for-causal-inference"><span class="header-section-number">15</span> Observational designs for causal inference</a></li>
<li>
<a class="nav-link" href="#causal-inquiries-about-a-single-unit"><span class="header-section-number">15.1</span> Causal inquiries about a single unit</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#process-tracing"><span class="header-section-number">15.1.1</span> Process tracing</a></li>
<li><a class="nav-link" href="#before-after-comparison"><span class="header-section-number">15.1.2</span> Before-after comparison</a></li>
<li><a class="nav-link" href="#posttreatment-comparison-to-an-untreated-case"><span class="header-section-number">15.1.3</span> Posttreatment comparison to an untreated case</a></li>
<li><a class="nav-link" href="#difference-in-differences-1"><span class="header-section-number">15.1.4</span> Difference-in-differences</a></li>
<li><a class="nav-link" href="#synthetic-controls-1"><span class="header-section-number">15.1.5</span> Synthetic controls</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#observational-causal-inference-for-multiple-units"><span class="header-section-number">15.2</span> Observational causal inference for multiple units</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#over-time-change-within-units"><span class="header-section-number">15.2.1</span> Over-time change within units</a></li>
<li><a class="nav-link" href="#posttreatment-differences"><span class="header-section-number">15.2.2</span> Posttreatment differences</a></li>
<li><a class="nav-link" href="#difference-in-differences-2"><span class="header-section-number">15.2.3</span> Difference-in-differences</a></li>
<li><a class="nav-link" href="#synthetic-control"><span class="header-section-number">15.2.4</span> Synthetic control</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#p3iv"><span class="header-section-number">15.3</span> Instrumental variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#declaration-8"><span class="header-section-number">15.3.1</span> Declaration</a></li>
<li><a class="nav-link" href="#dag-8"><span class="header-section-number">15.3.2</span> DAG</a></li>
<li><a class="nav-link" href="#redesign-3"><span class="header-section-number">15.3.3</span> Redesign</a></li>
<li><a class="nav-link" href="#example-5"><span class="header-section-number">15.3.4</span> Example</a></li>
<li><a class="nav-link" href="#further-reading-9"><span class="header-section-number">15.3.5</span> Further reading</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#RDD"><span class="header-section-number">15.4</span> Regression Discontinuity</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#declaration-9"><span class="header-section-number">15.4.1</span> Declaration</a></li>
<li><a class="nav-link" href="#dag-9"><span class="header-section-number">15.4.2</span> DAG</a></li>
<li><a class="nav-link" href="#example-6"><span class="header-section-number">15.4.3</span> Example</a></li>
<li><a class="nav-link" href="#exercises-5"><span class="header-section-number">15.4.4</span> Exercises</a></li>
<li><a class="nav-link" href="#further-reading-10"><span class="header-section-number">15.4.5</span> Further Reading</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="download-code" href="./observational-designs-for-causal-inference.R"><i class="far fa-file-code"></i> Download R code</a></li>
          
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Research Design: Declare, Diagnose, Redesign</strong>" was written by Graeme Blair, Alexander Coppock, and Macartan Humphreys. </p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
