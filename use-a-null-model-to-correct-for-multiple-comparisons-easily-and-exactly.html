<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>18.5 Use a null model to correct for multiple comparisons easily and exactly | Research Design: Declare, Diagnose, Redesign</title>
  <meta name="description" content="describe the book" />
  <meta name="generator" content="bookdown 0.12.1 and GitBook 2.6.7" />

  <meta property="og:title" content="18.5 Use a null model to correct for multiple comparisons easily and exactly | Research Design: Declare, Diagnose, Redesign" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="describe the book" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="18.5 Use a null model to correct for multiple comparisons easily and exactly | Research Design: Declare, Diagnose, Redesign" />
  
  <meta name="twitter:description" content="describe the book" />
  

<meta name="author" content="Graeme Blair, Jasper Cooper, Alexander Coppock, and Macartan Humphreys" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="assign-over-vectors.html"/>
<link rel="next" href="inquiry-principles.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="https://hypothes.is/embed.js" async></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="headers/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Declaring and Diagnosing Research Designs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="part-a-introduction-to-design-declaration-and-diagnosis.html"><a href="part-a-introduction-to-design-declaration-and-diagnosis.html"><i class="fa fa-check"></i><b>2</b> Part A: Introduction to Design Declaration and Diagnosis</a></li>
<li class="chapter" data-level="3" data-path="part-b-a-guide-to-declaration-and-diagnosis-in-practice.html"><a href="part-b-a-guide-to-declaration-and-diagnosis-in-practice.html"><i class="fa fa-check"></i><b>3</b> Part B: A Guide to Declaration and Diagnosis in Practice</a><ul>
<li class="chapter" data-level="3.1" data-path="what-is-your-research-question-ac.html"><a href="what-is-your-research-question-ac.html"><i class="fa fa-check"></i><b>3.1</b> What is your research question [AC]</a></li>
<li class="chapter" data-level="3.2" data-path="types-of-steps-not-components-jc-1p.html"><a href="types-of-steps-not-components-jc-1p.html"><i class="fa fa-check"></i><b>3.2</b> Types of steps, not components [JC 1p]</a></li>
<li class="chapter" data-level="3.3" data-path="is-your-research-question-good-gb.html"><a href="is-your-research-question-good-gb.html"><i class="fa fa-check"></i><b>3.3</b> Is your research question good? [GB]</a></li>
<li class="chapter" data-level="3.4" data-path="specifying-the-model-jc-10p.html"><a href="specifying-the-model-jc-10p.html"><i class="fa fa-check"></i><b>3.4</b> Specifying the model [JC 10p]</a></li>
<li class="chapter" data-level="3.5" data-path="defining-the-inquiry-mh.html"><a href="defining-the-inquiry-mh.html"><i class="fa fa-check"></i><b>3.5</b> Defining the Inquiry [MH]</a></li>
<li class="chapter" data-level="3.6" data-path="crafting-a-data-strategy-ac.html"><a href="crafting-a-data-strategy-ac.html"><i class="fa fa-check"></i><b>3.6</b> Crafting a Data Strategy [AC]</a></li>
<li class="chapter" data-level="3.7" data-path="choosing-an-answer-strategy-gb.html"><a href="choosing-an-answer-strategy-gb.html"><i class="fa fa-check"></i><b>3.7</b> Choosing an Answer Strategy [GB]</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="part-c-diagnosis.html"><a href="part-c-diagnosis.html"><i class="fa fa-check"></i><b>4</b> Part C: Diagnosis</a><ul>
<li class="chapter" data-level="4.1" data-path="diagnosing-a-single-design-single-design-single-diagnosand.html"><a href="diagnosing-a-single-design-single-design-single-diagnosand.html"><i class="fa fa-check"></i><b>4.1</b> Diagnosing a single design (single design, single diagnosand)</a></li>
<li class="chapter" data-level="4.2" data-path="kinds-of-diagnosands-that-there-are-jc-8p.html"><a href="kinds-of-diagnosands-that-there-are-jc-8p.html"><i class="fa fa-check"></i><b>4.2</b> Kinds of diagnosands that there are [JC 8p]</a></li>
<li class="chapter" data-level="4.3" data-path="what-parameters-should-you-vary-to-learn-about-designs-gb.html"><a href="what-parameters-should-you-vary-to-learn-about-designs-gb.html"><i class="fa fa-check"></i><b>4.3</b> What parameters should you vary to learn about designs [GB]</a></li>
<li class="chapter" data-level="4.4" data-path="redesign-mh.html"><a href="redesign-mh.html"><i class="fa fa-check"></i><b>4.4</b> Redesign [MH]</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="part-d-putting-designs-to-use.html"><a href="part-d-putting-designs-to-use.html"><i class="fa fa-check"></i><b>5</b> Part D: Putting Designs to Use</a><ul>
<li class="chapter" data-level="5.1" data-path="before-the-study.html"><a href="before-the-study.html"><i class="fa fa-check"></i><b>5.1</b> Before the study</a></li>
<li class="chapter" data-level="5.2" data-path="after-the-study.html"><a href="after-the-study.html"><i class="fa fa-check"></i><b>5.2</b> After the study</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="part-e-design-library.html"><a href="part-e-design-library.html"><i class="fa fa-check"></i><b>6</b> Part E: Design Library</a><ul>
<li class="chapter" data-level="6.1" data-path="observational-designs-for-descriptive-inference.html"><a href="observational-designs-for-descriptive-inference.html"><i class="fa fa-check"></i><b>6.1</b> Observational designs for descriptive inference</a></li>
<li class="chapter" data-level="6.2" data-path="experimental-designs-for-descriptive-inference.html"><a href="experimental-designs-for-descriptive-inference.html"><i class="fa fa-check"></i><b>6.2</b> Experimental designs for descriptive inference</a></li>
<li class="chapter" data-level="6.3" data-path="experimental-designs-for-causal-inference.html"><a href="experimental-designs-for-causal-inference.html"><i class="fa fa-check"></i><b>6.3</b> Experimental designs for causal inference</a></li>
<li class="chapter" data-level="6.4" data-path="observational-designs-for-causal-inference.html"><a href="observational-designs-for-causal-inference.html"><i class="fa fa-check"></i><b>6.4</b> Observational designs for causal inference</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="designs-brainstorm.html"><a href="designs-brainstorm.html"><i class="fa fa-check"></i><b>7</b> Designs brainstorm</a></li>
<li class="part"><span><b>I Declaring and Diagnosing Research Designs</b></span></li>
<li class="chapter" data-level="8" data-path="preface-1.html"><a href="preface-1.html"><i class="fa fa-check"></i><b>8</b> Preface</a></li>
<li class="chapter" data-level="9" data-path="mida.html"><a href="mida.html"><i class="fa fa-check"></i><b>9</b> MIDA</a><ul>
<li class="chapter" data-level="9.1" data-path="elements-of-a-research-design.html"><a href="elements-of-a-research-design.html"><i class="fa fa-check"></i><b>9.1</b> Elements of a Research Design</a></li>
<li class="chapter" data-level="9.2" data-path="using-diagnosands-to-evaluate-a-design.html"><a href="using-diagnosands-to-evaluate-a-design.html"><i class="fa fa-check"></i><b>9.2</b> Using diagnosands to evaluate a design</a></li>
<li class="chapter" data-level="9.3" data-path="what-is-a-complete-design-declaration.html"><a href="what-is-a-complete-design-declaration.html"><i class="fa fa-check"></i><b>9.3</b> What is a <em>Complete</em> Design Declaration?</a></li>
<li class="chapter" data-level="9.4" data-path="designs-as-concatenations-of-steps.html"><a href="designs-as-concatenations-of-steps.html"><i class="fa fa-check"></i><b>9.4</b> Designs as concatenations of steps</a></li>
<li class="chapter" data-level="9.5" data-path="designs-as-strategies.html"><a href="designs-as-strategies.html"><i class="fa fa-check"></i><b>9.5</b> Designs as <em>strategies</em></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-inquiry-data-strategy-answer-strategy.html"><a href="model-inquiry-data-strategy-answer-strategy.html"><i class="fa fa-check"></i><b>10</b> Model-Inquiry-Data-Strategy-Answer Strategy</a><ul>
<li class="chapter" data-level="10.1" data-path="model-steps.html"><a href="model-steps.html"><i class="fa fa-check"></i><b>10.1</b> Model steps</a><ul>
<li class="chapter" data-level="10.1.1" data-path="model-steps.html"><a href="model-steps.html#simple-data"><i class="fa fa-check"></i><b>10.1.1</b> Simple data</a></li>
<li class="chapter" data-level="10.1.2" data-path="model-steps.html"><a href="model-steps.html#hierarchical-data"><i class="fa fa-check"></i><b>10.1.2</b> Hierarchical data</a></li>
<li class="chapter" data-level="10.1.3" data-path="model-steps.html"><a href="model-steps.html#time-series-data"><i class="fa fa-check"></i><b>10.1.3</b> Time series data</a></li>
<li class="chapter" data-level="10.1.4" data-path="model-steps.html"><a href="model-steps.html#panel-data"><i class="fa fa-check"></i><b>10.1.4</b> Panel data</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="inquiry-steps.html"><a href="inquiry-steps.html"><i class="fa fa-check"></i><b>10.2</b> Inquiry steps</a><ul>
<li class="chapter" data-level="10.2.1" data-path="inquiry-steps.html"><a href="inquiry-steps.html#potential-outcomes-metadata"><i class="fa fa-check"></i><b>10.2.1</b> Potential outcomes metadata</a></li>
<li class="chapter" data-level="10.2.2" data-path="inquiry-steps.html"><a href="inquiry-steps.html#potential-outcomes-functions"><i class="fa fa-check"></i><b>10.2.2</b> Potential outcomes functions</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="data-steps.html"><a href="data-steps.html"><i class="fa fa-check"></i><b>10.3</b> Data steps</a><ul>
<li class="chapter" data-level="10.3.1" data-path="data-steps.html"><a href="data-steps.html#simple-random-sampling"><i class="fa fa-check"></i><b>10.3.1</b> Simple random sampling</a></li>
<li class="chapter" data-level="10.3.2" data-path="data-steps.html"><a href="data-steps.html#stratified-clustered-random-sampling"><i class="fa fa-check"></i><b>10.3.2</b> Stratified, clustered random sampling</a></li>
<li class="chapter" data-level="10.3.3" data-path="data-steps.html"><a href="data-steps.html#arbitrary-sampling"><i class="fa fa-check"></i><b>10.3.3</b> Arbitrary sampling</a></li>
<li class="chapter" data-level="10.3.4" data-path="data-steps.html"><a href="data-steps.html#simple-assignments"><i class="fa fa-check"></i><b>10.3.4</b> Simple assignments</a></li>
<li class="chapter" data-level="10.3.5" data-path="data-steps.html"><a href="data-steps.html#block-clustered-assignments"><i class="fa fa-check"></i><b>10.3.5</b> Block clustered assignments</a></li>
<li class="chapter" data-level="10.3.6" data-path="data-steps.html"><a href="data-steps.html#randomization-workflow"><i class="fa fa-check"></i><b>10.3.6</b> Randomization workflow</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="answer-steps.html"><a href="answer-steps.html"><i class="fa fa-check"></i><b>10.4</b> Answer steps</a></li>
<li class="chapter" data-level="10.5" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html"><i class="fa fa-check"></i><b>10.5</b> Putting it all together</a></li>
<li class="chapter" data-level="10.6" data-path="diagnsosis.html"><a href="diagnsosis.html"><i class="fa fa-check"></i><b>10.6</b> Diagnsosis</a><ul>
<li class="chapter" data-level="10.6.1" data-path="diagnsosis.html"><a href="diagnsosis.html#standard-diagnosands"><i class="fa fa-check"></i><b>10.6.1</b> Standard diagnosands</a></li>
<li class="chapter" data-level="10.6.2" data-path="diagnsosis.html"><a href="diagnsosis.html#custom-diagnosands"><i class="fa fa-check"></i><b>10.6.2</b> Custom diagnosands</a></li>
<li class="chapter" data-level="10.6.3" data-path="diagnsosis.html"><a href="diagnsosis.html#is-a-diagnosand-part-of-a-design"><i class="fa fa-check"></i><b>10.6.3</b> Is a diagnosand part of a design?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Design Library</b></span></li>
<li class="chapter" data-level="11" data-path="design-library.html"><a href="design-library.html"><i class="fa fa-check"></i><b>11</b> Design Library</a></li>
<li class="chapter" data-level="12" data-path="observational-designs-for-descriptive-inference-1.html"><a href="observational-designs-for-descriptive-inference-1.html"><i class="fa fa-check"></i><b>12</b> Observational Designs for Descriptive Inference</a><ul>
<li class="chapter" data-level="12.1" data-path="simple-random-sampling-1.html"><a href="simple-random-sampling-1.html"><i class="fa fa-check"></i><b>12.1</b> Simple Random Sampling</a><ul>
<li class="chapter" data-level="12.1.1" data-path="simple-random-sampling-1.html"><a href="simple-random-sampling-1.html#design-declaration"><i class="fa fa-check"></i><b>12.1.1</b> Design Declaration</a></li>
<li class="chapter" data-level="12.1.2" data-path="simple-random-sampling-1.html"><a href="simple-random-sampling-1.html#takeaways"><i class="fa fa-check"></i><b>12.1.2</b> Takeaways</a></li>
<li class="chapter" data-level="12.1.3" data-path="simple-random-sampling-1.html"><a href="simple-random-sampling-1.html#exercises"><i class="fa fa-check"></i><b>12.1.3</b> Exercises</a></li>
<li class="chapter" data-level="12.1.4" data-path="simple-random-sampling-1.html"><a href="simple-random-sampling-1.html#design-inspector"><i class="fa fa-check"></i><b>12.1.4</b> Design Inspector</a></li>
<li class="chapter" data-level="12.1.5" data-path="simple-random-sampling-1.html"><a href="simple-random-sampling-1.html#references"><i class="fa fa-check"></i><b>12.1.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="stratified-clustered-random-sampling-1.html"><a href="stratified-clustered-random-sampling-1.html"><i class="fa fa-check"></i><b>12.2</b> Stratified clustered random sampling</a><ul>
<li class="chapter" data-level="12.2.1" data-path="stratified-clustered-random-sampling-1.html"><a href="stratified-clustered-random-sampling-1.html#design-declaration-1"><i class="fa fa-check"></i><b>12.2.1</b> Design Declaration</a></li>
<li class="chapter" data-level="12.2.2" data-path="stratified-clustered-random-sampling-1.html"><a href="stratified-clustered-random-sampling-1.html#takeaways-1"><i class="fa fa-check"></i><b>12.2.2</b> Takeaways</a></li>
<li class="chapter" data-level="12.2.3" data-path="stratified-clustered-random-sampling-1.html"><a href="stratified-clustered-random-sampling-1.html#references-1"><i class="fa fa-check"></i><b>12.2.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="respondent-driven-sampling.html"><a href="respondent-driven-sampling.html"><i class="fa fa-check"></i><b>12.3</b> Respondent driven sampling</a></li>
<li class="chapter" data-level="12.4" data-path="sample-re-sample.html"><a href="sample-re-sample.html"><i class="fa fa-check"></i><b>12.4</b> Sample re-sample</a></li>
<li class="chapter" data-level="12.5" data-path="measuring-latent-variables.html"><a href="measuring-latent-variables.html"><i class="fa fa-check"></i><b>12.5</b> Measuring latent variables</a></li>
<li class="chapter" data-level="12.6" data-path="topic-analysis.html"><a href="topic-analysis.html"><i class="fa fa-check"></i><b>12.6</b> Topic analysis</a><ul>
<li class="chapter" data-level="12.6.1" data-path="topic-analysis.html"><a href="topic-analysis.html#references-2"><i class="fa fa-check"></i><b>12.6.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="multilevel-regression-and-poststratification.html"><a href="multilevel-regression-and-poststratification.html"><i class="fa fa-check"></i><b>12.7</b> Multilevel regression and poststratification</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="references-3.html"><a href="references-3.html"><i class="fa fa-check"></i><b>13</b> References</a><ul>
<li class="chapter" data-level="13.1" data-path="section-title-in-sentence-case.html"><a href="section-title-in-sentence-case.html"><i class="fa fa-check"></i><b>13.1</b> Section title in sentence case</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="references-4.html"><a href="references-4.html"><i class="fa fa-check"></i><b>14</b> References</a></li>
<li class="chapter" data-level="15" data-path="experimental-designs-for-descriptive-inference-1.html"><a href="experimental-designs-for-descriptive-inference-1.html"><i class="fa fa-check"></i><b>15</b> Experimental Designs for Descriptive Inference</a><ul>
<li class="chapter" data-level="15.1" data-path="audit-experiments.html"><a href="audit-experiments.html"><i class="fa fa-check"></i><b>15.1</b> Audit experiments</a></li>
<li class="chapter" data-level="15.2" data-path="experiments-for-sensitive-questions.html"><a href="experiments-for-sensitive-questions.html"><i class="fa fa-check"></i><b>15.2</b> Experiments for sensitive questions</a><ul>
<li class="chapter" data-level="15.2.1" data-path="experiments-for-sensitive-questions.html"><a href="experiments-for-sensitive-questions.html#list-experiments"><i class="fa fa-check"></i><b>15.2.1</b> List experiments</a></li>
<li class="chapter" data-level="15.2.2" data-path="experiments-for-sensitive-questions.html"><a href="experiments-for-sensitive-questions.html#randomized-response-technique"><i class="fa fa-check"></i><b>15.2.2</b> Randomized response technique</a></li>
<li class="chapter" data-level="15.2.3" data-path="experiments-for-sensitive-questions.html"><a href="experiments-for-sensitive-questions.html#references-5"><i class="fa fa-check"></i><b>15.2.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="conjoint-experiments.html"><a href="conjoint-experiments.html"><i class="fa fa-check"></i><b>15.3</b> Conjoint experiments</a></li>
<li class="chapter" data-level="15.4" data-path="experimental-games.html"><a href="experimental-games.html"><i class="fa fa-check"></i><b>15.4</b> Experimental games</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="observational-designs-for-causal-inference-1.html"><a href="observational-designs-for-causal-inference-1.html"><i class="fa fa-check"></i><b>16</b> Observational Designs for causal inference</a><ul>
<li class="chapter" data-level="16.1" data-path="difference-in-differences.html"><a href="difference-in-differences.html"><i class="fa fa-check"></i><b>16.1</b> Difference in differences</a></li>
<li class="chapter" data-level="16.2" data-path="matching.html"><a href="matching.html"><i class="fa fa-check"></i><b>16.2</b> Matching</a></li>
<li class="chapter" data-level="16.3" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html"><i class="fa fa-check"></i><b>16.3</b> Regression Discontinuity</a><ul>
<li class="chapter" data-level="16.3.1" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#design-declaration-2"><i class="fa fa-check"></i><b>16.3.1</b> Design Declaration</a></li>
<li class="chapter" data-level="16.3.2" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#takeaways-2"><i class="fa fa-check"></i><b>16.3.2</b> Takeaways</a></li>
<li class="chapter" data-level="16.3.3" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#further-reading"><i class="fa fa-check"></i><b>16.3.3</b> Further Reading</a></li>
<li class="chapter" data-level="16.3.4" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#exercises-1"><i class="fa fa-check"></i><b>16.3.4</b> Exercises</a></li>
<li class="chapter" data-level="16.3.5" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html#references-6"><i class="fa fa-check"></i><b>16.3.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="synthetic-controls.html"><a href="synthetic-controls.html"><i class="fa fa-check"></i><b>16.4</b> Synthetic controls</a><ul>
<li class="chapter" data-level="16.4.1" data-path="synthetic-controls.html"><a href="synthetic-controls.html#references-7"><i class="fa fa-check"></i><b>16.4.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="cross-national-time-series.html"><a href="cross-national-time-series.html"><i class="fa fa-check"></i><b>16.5</b> Cross national time series</a></li>
<li class="chapter" data-level="16.6" data-path="qualtitative-comparative-analysis.html"><a href="qualtitative-comparative-analysis.html"><i class="fa fa-check"></i><b>16.6</b> Qualtitative Comparative Analysis</a></li>
<li class="chapter" data-level="16.7" data-path="process-tracing.html"><a href="process-tracing.html"><i class="fa fa-check"></i><b>16.7</b> Process tracing</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="experimental-designs-for-causal-inference-1.html"><a href="experimental-designs-for-causal-inference-1.html"><i class="fa fa-check"></i><b>17</b> Experimental Designs for Causal Inference</a><ul>
<li class="chapter" data-level="17.1" data-path="multiarm-designs.html"><a href="multiarm-designs.html"><i class="fa fa-check"></i><b>17.1</b> Multiarm designs</a></li>
<li class="chapter" data-level="17.2" data-path="experiments-with-blocks-and-clusters.html"><a href="experiments-with-blocks-and-clusters.html"><i class="fa fa-check"></i><b>17.2</b> Experiments with blocks and clusters</a></li>
<li class="chapter" data-level="17.3" data-path="factorial-designs.html"><a href="factorial-designs.html"><i class="fa fa-check"></i><b>17.3</b> Factorial designs</a></li>
<li class="chapter" data-level="17.4" data-path="encouragement-designs.html"><a href="encouragement-designs.html"><i class="fa fa-check"></i><b>17.4</b> Encouragement designs</a><ul>
<li class="chapter" data-level="17.4.1" data-path="encouragement-designs.html"><a href="encouragement-designs.html#references-8"><i class="fa fa-check"></i><b>17.4.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="stepped-wedge-designs.html"><a href="stepped-wedge-designs.html"><i class="fa fa-check"></i><b>17.5</b> Stepped wedge designs</a></li>
<li class="chapter" data-level="17.6" data-path="crossover-designs.html"><a href="crossover-designs.html"><i class="fa fa-check"></i><b>17.6</b> Crossover designs</a></li>
<li class="chapter" data-level="17.7" data-path="parallel-design-for-mediation-effects.html"><a href="parallel-design-for-mediation-effects.html"><i class="fa fa-check"></i><b>17.7</b> Parallel design for mediation effects</a></li>
<li class="chapter" data-level="17.8" data-path="partial-population-design-for-spillover-analysis.html"><a href="partial-population-design-for-spillover-analysis.html"><i class="fa fa-check"></i><b>17.8</b> Partial population design for spillover analysis</a></li>
<li class="chapter" data-level="17.9" data-path="selective-trials.html"><a href="selective-trials.html"><i class="fa fa-check"></i><b>17.9</b> Selective trials</a></li>
<li class="chapter" data-level="17.10" data-path="adaptive-trials.html"><a href="adaptive-trials.html"><i class="fa fa-check"></i><b>17.10</b> Adaptive trials</a></li>
<li class="chapter" data-level="17.11" data-path="selective-trials-1.html"><a href="selective-trials-1.html"><i class="fa fa-check"></i><b>17.11</b> Selective trials</a><ul>
<li class="chapter" data-level="17.11.1" data-path="selective-trials-1.html"><a href="selective-trials-1.html#design-declaration-3"><i class="fa fa-check"></i><b>17.11.1</b> Design Declaration</a></li>
<li class="chapter" data-level="17.11.2" data-path="selective-trials-1.html"><a href="selective-trials-1.html#references-9"><i class="fa fa-check"></i><b>17.11.2</b> References</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Principles of Research Designs</b></span></li>
<li class="chapter" data-level="18" data-path="model-principles.html"><a href="model-principles.html"><i class="fa fa-check"></i><b>18</b> Model principles</a><ul>
<li class="chapter" data-level="18.1" data-path="generate-null-models.html"><a href="generate-null-models.html"><i class="fa fa-check"></i><b>18.1</b> Generate null models</a></li>
<li class="chapter" data-level="18.2" data-path="generality-makes-models-vulnerable.html"><a href="generality-makes-models-vulnerable.html"><i class="fa fa-check"></i><b>18.2</b> Generality makes models vulnerable</a></li>
<li class="chapter" data-level="18.3" data-path="specify-which-variables-are-manipulable.html"><a href="specify-which-variables-are-manipulable.html"><i class="fa fa-check"></i><b>18.3</b> Specify which variables are manipulable</a></li>
<li class="chapter" data-level="18.4" data-path="assign-over-vectors.html"><a href="assign-over-vectors.html"><i class="fa fa-check"></i><b>18.4</b> Assign over vectors</a></li>
<li class="chapter" data-level="18.5" data-path="use-a-null-model-to-correct-for-multiple-comparisons-easily-and-exactly.html"><a href="use-a-null-model-to-correct-for-multiple-comparisons-easily-and-exactly.html"><i class="fa fa-check"></i><b>18.5</b> Use a null model to correct for multiple comparisons easily and exactly</a><ul>
<li class="chapter" data-level="18.5.1" data-path="use-a-null-model-to-correct-for-multiple-comparisons-easily-and-exactly.html"><a href="use-a-null-model-to-correct-for-multiple-comparisons-easily-and-exactly.html#the-problem-of-confidence-in-multiple-tests"><i class="fa fa-check"></i><b>18.5.1</b> The problem of confidence in multiple tests</a></li>
<li class="chapter" data-level="18.5.2" data-path="use-a-null-model-to-correct-for-multiple-comparisons-easily-and-exactly.html"><a href="use-a-null-model-to-correct-for-multiple-comparisons-easily-and-exactly.html#independence-makes-things-worse-dependence-makes-things-better"><i class="fa fa-check"></i><b>18.5.2</b> Independence makes things worse, dependence makes things better</a></li>
<li class="chapter" data-level="18.5.3" data-path="use-a-null-model-to-correct-for-multiple-comparisons-easily-and-exactly.html"><a href="use-a-null-model-to-correct-for-multiple-comparisons-easily-and-exactly.html#correcting-for-multiple-comparisons"><i class="fa fa-check"></i><b>18.5.3</b> Correcting for multiple comparisons</a></li>
<li class="chapter" data-level="18.5.4" data-path="use-a-null-model-to-correct-for-multiple-comparisons-easily-and-exactly.html"><a href="use-a-null-model-to-correct-for-multiple-comparisons-easily-and-exactly.html#references-10"><i class="fa fa-check"></i><b>18.5.4</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="inquiry-principles.html"><a href="inquiry-principles.html"><i class="fa fa-check"></i><b>19</b> Inquiry principles</a><ul>
<li class="chapter" data-level="19.1" data-path="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html"><a href="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html"><i class="fa fa-check"></i><b>19.1</b> Some designs have badly posed questions but design diagnosis can alert you to the problem</a><ul>
<li class="chapter" data-level="19.1.1" data-path="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html"><a href="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html#a-design-with-sometimes-undefined-outcomes"><i class="fa fa-check"></i><b>19.1.1</b> A design with sometimes undefined outcomes</a></li>
<li class="chapter" data-level="19.1.2" data-path="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html"><a href="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html#what-we-find-from-diagnosis"><i class="fa fa-check"></i><b>19.1.2</b> What we find from diagnosis</a></li>
<li class="chapter" data-level="19.1.3" data-path="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html"><a href="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html#other-instances-of-this-problem"><i class="fa fa-check"></i><b>19.1.3</b> Other instances of this problem</a></li>
<li class="chapter" data-level="19.1.4" data-path="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html"><a href="some-designs-have-badly-posed-questions-but-design-diagnosis-can-alert-you-to-the-problem.html#keep-thinking"><i class="fa fa-check"></i><b>19.1.4</b> Keep thinking</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="there-is-no-causation-without-manipulation.html"><a href="there-is-no-causation-without-manipulation.html"><i class="fa fa-check"></i><b>19.2</b> There is no causation without manipulation</a></li>
<li class="chapter" data-level="19.3" data-path="know-what-ate-averages-over.html"><a href="know-what-ate-averages-over.html"><i class="fa fa-check"></i><b>19.3</b> Know what ATE averages over</a></li>
<li class="chapter" data-level="19.4" data-path="know-what-is-local-in-a-late.html"><a href="know-what-is-local-in-a-late.html"><i class="fa fa-check"></i><b>19.4</b> Know what is local in a LATE</a></li>
<li class="chapter" data-level="19.5" data-path="know-when-sates-are-informative-for-pates.html"><a href="know-when-sates-are-informative-for-pates.html"><i class="fa fa-check"></i><b>19.5</b> Know when SATEs are informative for PATEs</a></li>
<li class="chapter" data-level="19.6" data-path="inquiry-strategies-before-inquiries-are-defined.html"><a href="inquiry-strategies-before-inquiries-are-defined.html"><i class="fa fa-check"></i><b>19.6</b> Inquiry strategies before inquiries are defined</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="data-principles.html"><a href="data-principles.html"><i class="fa fa-check"></i><b>20</b> Data Principles</a><ul>
<li class="chapter" data-level="20.1" data-path="why-systematic-data-collection-is-not-random-sampling.html"><a href="why-systematic-data-collection-is-not-random-sampling.html"><i class="fa fa-check"></i><b>20.1</b> Why systematic data collection is not random sampling</a></li>
<li class="chapter" data-level="20.2" data-path="keep-treatment-and-control-groups-parallel.html"><a href="keep-treatment-and-control-groups-parallel.html"><i class="fa fa-check"></i><b>20.2</b> Keep treatment and control groups parallel</a></li>
<li class="chapter" data-level="20.3" data-path="how-blocking-improves-precision.html"><a href="how-blocking-improves-precision.html"><i class="fa fa-check"></i><b>20.3</b> How blocking improves precision</a></li>
<li class="chapter" data-level="20.4" data-path="how-clusters-reduce-precision.html"><a href="how-clusters-reduce-precision.html"><i class="fa fa-check"></i><b>20.4</b> How clusters reduce precision</a></li>
<li class="chapter" data-level="20.5" data-path="answer-strategies-matter-for-power.html"><a href="answer-strategies-matter-for-power.html"><i class="fa fa-check"></i><b>20.5</b> Answer strategies matter for power</a></li>
<li class="chapter" data-level="20.6" data-path="allocating-treatments-at-extremes-can-improve-precision.html"><a href="allocating-treatments-at-extremes-can-improve-precision.html"><i class="fa fa-check"></i><b>20.6</b> Allocating treatments at extremes can improve precision</a></li>
<li class="chapter" data-level="20.7" data-path="gains-from-multiple-measurements.html"><a href="gains-from-multiple-measurements.html"><i class="fa fa-check"></i><b>20.7</b> Gains from multiple measurements</a></li>
<li class="chapter" data-level="20.8" data-path="gains-from-continuous-measures.html"><a href="gains-from-continuous-measures.html"><i class="fa fa-check"></i><b>20.8</b> Gains from continuous measures</a></li>
<li class="chapter" data-level="20.9" data-path="factorial-designs-can-be-more-powerful-than-multiarm-designs.html"><a href="factorial-designs-can-be-more-powerful-than-multiarm-designs.html"><i class="fa fa-check"></i><b>20.9</b> Factorial designs can be more powerful than multiarm designs</a></li>
<li class="chapter" data-level="20.10" data-path="allocating-treatments-at-extremes-can-improve-precision-1.html"><a href="allocating-treatments-at-extremes-can-improve-precision-1.html"><i class="fa fa-check"></i><b>20.10</b> Allocating treatments at extremes can improve precision</a></li>
<li class="chapter" data-level="20.11" data-path="balance-tests-tests-the-null-of-randomization-not-the-null-of-balance.html"><a href="balance-tests-tests-the-null-of-randomization-not-the-null-of-balance.html"><i class="fa fa-check"></i><b>20.11</b> Balance tests tests the null of randomization, not the null of balance</a></li>
<li class="chapter" data-level="20.12" data-path="assess-imbalance-on-substantive-rather-than-statistical-grounds.html"><a href="assess-imbalance-on-substantive-rather-than-statistical-grounds.html"><i class="fa fa-check"></i><b>20.12</b> Assess imbalance on substantive rather than statistical grounds</a></li>
<li class="chapter" data-level="20.13" data-path="the-dangers-of-the-big-stick.html"><a href="the-dangers-of-the-big-stick.html"><i class="fa fa-check"></i><b>20.13</b> The dangers of the big stick</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="answer-principles.html"><a href="answer-principles.html"><i class="fa fa-check"></i><b>21</b> Answer principles</a><ul>
<li class="chapter" data-level="21.1" data-path="use-controls-for-prognostic-pretreatment-covariates.html"><a href="use-controls-for-prognostic-pretreatment-covariates.html"><i class="fa fa-check"></i><b>21.1</b> Use controls for prognostic pretreatment covariates</a></li>
<li class="chapter" data-level="21.2" data-path="conditioning-on-post-treatment-variables-can-introduce-bias.html"><a href="conditioning-on-post-treatment-variables-can-introduce-bias.html"><i class="fa fa-check"></i><b>21.2</b> Conditioning on post treatment variables can introduce bias</a></li>
<li class="chapter" data-level="21.3" data-path="even-pretreatment-controls-can-introduce-bias-in-observational-analysis.html"><a href="even-pretreatment-controls-can-introduce-bias-in-observational-analysis.html"><i class="fa fa-check"></i><b>21.3</b> Even pretreatment controls can introduce bias in observational analysis</a></li>
<li class="chapter" data-level="21.4" data-path="heterogeneous-treatment-propensities-cannot-be-ignored.html"><a href="heterogeneous-treatment-propensities-cannot-be-ignored.html"><i class="fa fa-check"></i><b>21.4</b> Heterogeneous treatment propensities cannot be ignored</a></li>
<li class="chapter" data-level="21.5" data-path="the-source-of-uncertainty-matters-for-inference.html"><a href="the-source-of-uncertainty-matters-for-inference.html"><i class="fa fa-check"></i><b>21.5</b> The source of uncertainty matters for inference</a></li>
<li class="chapter" data-level="21.6" data-path="neyman-variance-is-conservative-for-sample-variance.html"><a href="neyman-variance-is-conservative-for-sample-variance.html"><i class="fa fa-check"></i><b>21.6</b> Neyman variance is conservative for sample variance</a></li>
<li class="chapter" data-level="21.7" data-path="cluster-standard-errors-at-the-level-of-treatment-assignment-for-the-sate.html"><a href="cluster-standard-errors-at-the-level-of-treatment-assignment-for-the-sate.html"><i class="fa fa-check"></i><b>21.7</b> Cluster standard errors at the level of treatment assignment for the SATE</a></li>
<li class="chapter" data-level="21.8" data-path="test-selection-should-take-account-of-both-validity-and-power.html"><a href="test-selection-should-take-account-of-both-validity-and-power.html"><i class="fa fa-check"></i><b>21.8</b> Test selection should take account of both validity and power</a></li>
<li class="chapter" data-level="21.9" data-path="randomization-does-not-justify-the-t-distribution.html"><a href="randomization-does-not-justify-the-t-distribution.html"><i class="fa fa-check"></i><b>21.9</b> Randomization does not justify the t-distribution</a></li>
<li class="chapter" data-level="21.10" data-path="you-can-check-whether-confidence-intervals-are-correct-given-the-model.html"><a href="you-can-check-whether-confidence-intervals-are-correct-given-the-model.html"><i class="fa fa-check"></i><b>21.10</b> You can check whether confidence intervals are correct, given the model</a></li>
<li class="chapter" data-level="21.11" data-path="no-evidence-of-an-effect-is-not-evidence-of-no-effect-except-for-bayesians.html"><a href="no-evidence-of-an-effect-is-not-evidence-of-no-effect-except-for-bayesians.html"><i class="fa fa-check"></i><b>21.11</b> No evidence of an effect is not evidence of no effect, except for Bayesians</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="cross-mida-principles.html"><a href="cross-mida-principles.html"><i class="fa fa-check"></i><b>22</b> Cross MIDA principles</a><ul>
<li class="chapter" data-level="22.1" data-path="as-ye-randomize-so-shall-ye-analyze.html"><a href="as-ye-randomize-so-shall-ye-analyze.html"><i class="fa fa-check"></i><b>22.1</b> As ye randomize so shall ye analyze</a></li>
<li class="chapter" data-level="22.2" data-path="selective-reporting-introduces-bias.html"><a href="selective-reporting-introduces-bias.html"><i class="fa fa-check"></i><b>22.2</b> Selective reporting introduces bias</a></li>
<li class="chapter" data-level="22.3" data-path="there-is-often-a-bias-variance-tradeoff.html"><a href="there-is-often-a-bias-variance-tradeoff.html"><i class="fa fa-check"></i><b>22.3</b> There is often a bias-variance tradeoff</a></li>
<li class="chapter" data-level="22.4" data-path="spillovers-are-a-design-challenge.html"><a href="spillovers-are-a-design-challenge.html"><i class="fa fa-check"></i><b>22.4</b> Spillovers are a design challenge</a></li>
<li class="chapter" data-level="22.5" data-path="identify-primary-questions.html"><a href="identify-primary-questions.html"><i class="fa fa-check"></i><b>22.5</b> Identify primary questions</a></li>
<li class="chapter" data-level="22.6" data-path="check-your-models.html"><a href="check-your-models.html"><i class="fa fa-check"></i><b>22.6</b> Check your models</a></li>
</ul></li>
<li class="part"><span><b>IV Putting Declared Designs to Use</b></span></li>
<li class="chapter" data-level="23" data-path="workflows.html"><a href="workflows.html"><i class="fa fa-check"></i><b>23</b> Workflows</a><ul>
<li class="chapter" data-level="23.1" data-path="design-development.html"><a href="design-development.html"><i class="fa fa-check"></i><b>23.1</b> Design development</a></li>
<li class="chapter" data-level="23.2" data-path="design-registration-and-reconciliation.html"><a href="design-registration-and-reconciliation.html"><i class="fa fa-check"></i><b>23.2</b> Design Registration and Reconciliation</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="critique.html"><a href="critique.html"><i class="fa fa-check"></i><b>24</b> Critique</a><ul>
<li class="chapter" data-level="24.1" data-path="new-principles-for-replication-and-critique.html"><a href="new-principles-for-replication-and-critique.html"><i class="fa fa-check"></i><b>24.1</b> New principles for replication and critique</a></li>
<li class="chapter" data-level="24.2" data-path="polemics.html"><a href="polemics.html"><i class="fa fa-check"></i><b>24.2</b> Polemics</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="community.html"><a href="community.html"><i class="fa fa-check"></i><b>25</b> Community</a><ul>
<li class="chapter" data-level="25.1" data-path="evaluating-and-supporting-research.html"><a href="evaluating-and-supporting-research.html"><i class="fa fa-check"></i><b>25.1</b> Evaluating and supporting research</a></li>
<li class="chapter" data-level="25.2" data-path="a-library-of-designs.html"><a href="a-library-of-designs.html"><i class="fa fa-check"></i><b>25.2</b> A library of designs</a></li>
<li class="chapter" data-level="25.3" data-path="ajr-example.html"><a href="ajr-example.html"><i class="fa fa-check"></i><b>25.3</b> AJR example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-11.html"><a href="references-11.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://declaredesign.org" target="blank">DeclareDesign</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Research Design: Declare, Diagnose, Redesign</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="use-a-null-model-to-correct-for-multiple-comparisons-easily-and-exactly" class="section level2">
<h2><span class="header-section-number">18.5</span> Use a null model to correct for multiple comparisons easily and exactly</h2>
<div id="the-problem-of-confidence-in-multiple-tests" class="section level3">
<h3><span class="header-section-number">18.5.1</span> The problem of confidence in multiple tests</h3>
<p>Using <span class="math inline">\(p\)</span>-values to make inferences about effects is essentially an exercise in risk management: when we stipulate a “confidence level” below which we consider a <span class="math inline">\(p\)</span>-value statistically significant – often referred to as <span class="math inline">\(\alpha\)</span> (alpha) – we are saying how comfortable we are inferring that there’s an effect when there actually isn’t one. A researcher who tells you that her confidence level is .05 is telling you that, in a world where there’s no effect, she’s willing to accept a 5% chance of wrongly inferring that there is one. The problem is that, often, the level of risk we say we’re willing to take on in principle doesn’t actually correspond to the level of risk we take on in practice. We’re often at a higher risk of false positives than we realize.</p>
<p>To see this point, let’s a design based on a null model with two variables that are possibly correlated by <code>rho</code>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">rho &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb42-2" title="2">design &lt;-<span class="st"> </span><span class="kw">declare_population</span>(<span class="dt">N =</span> <span class="dv">200</span>, </a>
<a class="sourceLine" id="cb42-3" title="3">                             <span class="dt">Y1 =</span> <span class="kw">rnorm</span>(N), </a>
<a class="sourceLine" id="cb42-4" title="4">                             <span class="dt">Y2 =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> N,<span class="dt">mean =</span> Y1 <span class="op">*</span><span class="st"> </span>rho, </a>
<a class="sourceLine" id="cb42-5" title="5">                                        <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>rho <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-6" title="6"><span class="st">  </span><span class="kw">declare_assignment</span>(<span class="dt">prob =</span> <span class="fl">.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-7" title="7"><span class="st">  </span><span class="kw">declare_estimator</span>(Y1 <span class="op">~</span><span class="st"> </span>Z, <span class="dt">label =</span> <span class="st">&quot;Y1&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-8" title="8"><span class="st">  </span><span class="kw">declare_estimator</span>(Y2 <span class="op">~</span><span class="st"> </span>Z, <span class="dt">label =</span> <span class="st">&quot;Y2&quot;</span>) </a></code></pre></div>
<p>We specify that we’re willing to falsely infer that there’s an effect 5% of the time.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">test_alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a></code></pre></div>
<p>Then, we simulate the design hundreds of times. Every time we see that the <span class="math inline">\(p\)</span>-value from one of our tests falls below <span class="math inline">\(\alpha\)</span>, we infer (falsely) that there’s an effect. This happens due to random chance.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">simulations &lt;-<span class="st"> </span><span class="kw">simulate_design</span>(design) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb44-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">test_rejection =</span> p.value <span class="op">&lt;=</span><span class="st"> </span>test_alpha) </a></code></pre></div>
<p>And guess what, we do that about 5% of the time!</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">with</span>(simulations,<span class="kw">mean</span>(test_rejection))  </a></code></pre></div>
<pre><code>## [1] 0.051</code></pre>
<p>So far so good, right? Not so fast. While the probability that any test in our study falsely rejects the null corresponds to the <span class="math inline">\(\alpha\)</span> we specified, the probability that our study rejects <em>a</em> null might not. Let’s take a look at how often the design rejects any null among the two tests:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">simulations <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-2" title="2"><span class="st">    </span><span class="kw">group_by</span>(sim_ID) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">family_rejection =</span> <span class="kw">any</span>(test_rejection)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="st">    </span><span class="kw">with</span>(., <span class="kw">mean</span>(family_rejection))</a></code></pre></div>
<pre><code>## [1] 0.102</code></pre>
<p>Whoa – we’re finding erroneous significant effects at twice the rate we said we were comfortable with! That’s because we took two independent shots at finding a significant effect, each of which had a 5% chance of success. This is what we call the “family-wise error rate:” it’s the probability that we find any significant effects in a family of tests, given that the “global null” of no effects for any units on any outcome is true.</p>
</div>
<div id="independence-makes-things-worse-dependence-makes-things-better" class="section level3">
<h3><span class="header-section-number">18.5.2</span> Independence makes things worse, dependence makes things better</h3>
<p>It’s not hard to see that the problem gets worse when you add more tests. If you run ten independent tests when the global null is true, then the probability that they all fail to reject the null at <span class="math inline">\(\alpha = .05\)</span> is <span class="math inline">\(95\%^{10} \approx 60\%\)</span>. In other words, you’re falsely inferring there’s at least one significant effect 40% of the time!</p>
<p>More subtley, the problem is less bad when tests are correlated, in the sense that if one comes up null the other is also more likely to come up null. This happens, for example, when tests are very similar: say, one test is the bivariate correlation between <span class="math inline">\(Z\)</span> and <span class="math inline">\(Y\)</span>, and another test is the correlation between <span class="math inline">\(Z\)</span> and <span class="math inline">\(Y\)</span>, holding <span class="math inline">\(X\)</span> constant. It also happens if the outcomes themselves are correlated. Let’s see how the true family error rate changes as the correlation in our two outcomes in our null design varies from -1 to 1.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">designs &lt;-<span class="st"> </span><span class="kw">redesign</span>(design, <span class="dt">rho =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="fl">-.8</span>, <span class="fl">-.25</span>, <span class="dv">0</span>,.<span class="dv">25</span>, <span class="fl">.8</span>, <span class="dv">1</span>))</a></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-201-1.png" width="672" /></p>
<p>The risk of at least one false positive is highest when the tests are independent, and lowest when it is dependent. For some intuition, think about the case when the tests are effectively equivalent (<span class="math inline">\(\rho = 1\)</span>). In that case, it’s as though you only ran one test, so you’re only taking one bite at the apple.</p>
</div>
<div id="correcting-for-multiple-comparisons" class="section level3">
<h3><span class="header-section-number">18.5.3</span> Correcting for multiple comparisons</h3>
<p>The problem we’ve described — that the risk of a false positive in a group of tests is often higher than the nominal risk of false positives being used at the test-level – is well-known and is often dealt with through “multiple comparisons correction.”</p>
<p>Most infamous of these methods is the Bonferroni correction, which is often applied to <span class="math inline">\(p\)</span>-values, under the assumption of independence in the tests. But, due to concerns that the method is overly conservative, various others have been developed.</p>
<p>In our next set of simulations, we’ll declare a design in which we estimates effects, adjust our <span class="math inline">\(p\)</span>-values or test-wise <span class="math inline">\(\alpha\)</span>, and then report whether we found at least one significant effect. We’ll use two kinds of approaches to looking for significant effects.</p>
<p>In the first, we’ll imploy one of the four main “analytic” methods for p-value adjustment available through the <code>p.adjust</code> function in <code>R</code>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">analytic_correction &lt;-<span class="st"> </span><span class="cf">function</span>(data,method){</a>
<a class="sourceLine" id="cb50-2" title="2">  <span class="kw">get_estimates</span>(<span class="dt">design =</span> design, <span class="dt">data =</span> data) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-3" title="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">reject =</span> <span class="kw">p.adjust</span>(<span class="dt">p =</span> p.value,<span class="dt">method =</span> method) <span class="op">&lt;</span><span class="st"> </span><span class="fl">.05</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-4" title="4"><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">any_reject =</span> <span class="kw">any</span>(reject))</a>
<a class="sourceLine" id="cb50-5" title="5">}</a></code></pre></div>
<p>Our design is going to draw data from the design above, at a level of rho we set below, then it is going to estimate effects, adjust for multiple comparisons, and reject hypotheses with an aim to get a true family-wise error rate of .05.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">new_rho &lt;-<span class="st"> </span><span class="fl">.95</span></a>
<a class="sourceLine" id="cb51-2" title="2">correction_design &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb51-3" title="3"><span class="st">  </span><span class="kw">declare_population</span>(<span class="dt">data =</span> <span class="kw">draw_data</span>(<span class="kw">redesign</span>(design, <span class="dt">rho =</span> new_rho))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-4" title="4"><span class="st">  </span><span class="kw">declare_estimator</span>(<span class="dt">handler =</span> <span class="kw">tidy_estimator</span>(analytic_correction), <span class="dt">method =</span> <span class="st">&quot;bonferroni&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;bonferroni&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb51-5" title="5"><span class="st">  </span><span class="kw">declare_estimator</span>(<span class="dt">handler =</span> <span class="kw">tidy_estimator</span>(analytic_correction), <span class="dt">method =</span> <span class="st">&quot;holm&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;holm&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb51-6" title="6"><span class="st">  </span><span class="kw">declare_estimator</span>(<span class="dt">handler =</span> <span class="kw">tidy_estimator</span>(analytic_correction), <span class="dt">method =</span> <span class="st">&quot;hochberg&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;hochberg&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb51-7" title="7"><span class="st">  </span><span class="kw">declare_estimator</span>(<span class="dt">handler =</span> <span class="kw">tidy_estimator</span>(analytic_correction), <span class="dt">method =</span> <span class="st">&quot;hommel&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;hommel&quot;</span>) </a></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">get_alpha_per_family &lt;-<span class="st"> </span><span class="cf">function</span>(test_alpha, simulations){</a>
<a class="sourceLine" id="cb52-2" title="2">  simulations <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-3" title="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">test_rejection =</span> p.value <span class="op">&lt;</span><span class="st"> </span>test_alpha) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-4" title="4"><span class="st">    </span><span class="kw">group_by</span>(sim_ID) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-5" title="5"><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">family_rejection =</span> <span class="kw">any</span>(test_rejection)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-6" title="6"><span class="st">    </span><span class="kw">with</span>(., <span class="kw">mean</span>(family_rejection))</a>
<a class="sourceLine" id="cb52-7" title="7">}</a>
<a class="sourceLine" id="cb52-8" title="8"></a>
<a class="sourceLine" id="cb52-9" title="9">get_testwise_alpha &lt;-<span class="st"> </span><span class="cf">function</span>(data, <span class="dt">target_alpha =</span> <span class="fl">.05</span>, <span class="dt">sims =</span> <span class="dv">100</span>){</a>
<a class="sourceLine" id="cb52-10" title="10">  design &lt;-<span class="st"> </span><span class="kw">declare_population</span>(<span class="dt">data =</span> data) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-11" title="11"><span class="st">    </span><span class="kw">declare_assignment</span>(<span class="dt">prob =</span> <span class="fl">.50</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-12" title="12"><span class="st">    </span><span class="kw">declare_estimator</span>(Y1 <span class="op">~</span><span class="st"> </span>Z,<span class="dt">label =</span> <span class="st">&quot;Y1&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-13" title="13"><span class="st">    </span><span class="kw">declare_estimator</span>(Y2 <span class="op">~</span><span class="st"> </span>Z,<span class="dt">label =</span> <span class="st">&quot;Y2&quot;</span>)</a>
<a class="sourceLine" id="cb52-14" title="14">  </a>
<a class="sourceLine" id="cb52-15" title="15">  simulations &lt;-<span class="st"> </span><span class="kw">simulate_design</span>(design, <span class="dt">sims =</span> sims)</a>
<a class="sourceLine" id="cb52-16" title="16">  alpha_per_tests &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">001</span>,.<span class="dv">10</span>,.<span class="dv">001</span>)</a>
<a class="sourceLine" id="cb52-17" title="17">  alpha_per_familys &lt;-<span class="st"> </span><span class="kw">sapply</span>(alpha_per_tests, get_alpha_per_family,<span class="dt">simulations =</span> simulations)</a>
<a class="sourceLine" id="cb52-18" title="18">  dist_from_goal &lt;-<span class="st"> </span>(alpha_per_familys <span class="op">-</span><span class="st"> </span>target_alpha)<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb52-19" title="19">  </a>
<a class="sourceLine" id="cb52-20" title="20">  <span class="kw">return</span>(<span class="kw">max</span>(alpha_per_tests[<span class="kw">which.min</span>(dist_from_goal)]))</a>
<a class="sourceLine" id="cb52-21" title="21">}</a>
<a class="sourceLine" id="cb52-22" title="22"></a>
<a class="sourceLine" id="cb52-23" title="23">simulation_correction &lt;-<span class="st"> </span><span class="cf">function</span>(data){</a>
<a class="sourceLine" id="cb52-24" title="24">  simulated_alpha &lt;-<span class="st"> </span><span class="kw">get_testwise_alpha</span>(data)</a>
<a class="sourceLine" id="cb52-25" title="25">  <span class="kw">get_estimates</span>(<span class="dt">design =</span> design, <span class="dt">data =</span> data) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-26" title="26"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">reject =</span> p.value <span class="op">&lt;</span><span class="st"> </span>simulated_alpha) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-27" title="27"><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">any_reject =</span> <span class="kw">any</span>(reject))</a>
<a class="sourceLine" id="cb52-28" title="28">}</a>
<a class="sourceLine" id="cb52-29" title="29"></a>
<a class="sourceLine" id="cb52-30" title="30">correction_design &lt;-<span class="st"> </span>correction_design <span class="op">+</span></a>
<a class="sourceLine" id="cb52-31" title="31"><span class="st">  </span><span class="kw">declare_estimator</span>(<span class="dt">handler =</span> <span class="kw">tidy_estimator</span>(simulation_correction), <span class="dt">label =</span> <span class="st">&quot;simulation&quot;</span>) </a></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">correction_sims &lt;-<span class="st"> </span><span class="kw">simulate_design</span>(correction_design, <span class="dt">sims =</span> <span class="dv">1000</span>)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Design Label
</th>
<th style="text-align:left;">
Estimator Label
</th>
<th style="text-align:left;">
N Sims
</th>
<th style="text-align:left;">
Family Error Rate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
correction_design
</td>
<td style="text-align:left;">
bonferroni
</td>
<td style="text-align:left;">
1000
</td>
<td style="text-align:left;">
3.50
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.61)
</td>
</tr>
<tr>
<td style="text-align:left;">
correction_design
</td>
<td style="text-align:left;">
hochberg
</td>
<td style="text-align:left;">
1000
</td>
<td style="text-align:left;">
4.10
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.65)
</td>
</tr>
<tr>
<td style="text-align:left;">
correction_design
</td>
<td style="text-align:left;">
holm
</td>
<td style="text-align:left;">
1000
</td>
<td style="text-align:left;">
3.50
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.61)
</td>
</tr>
<tr>
<td style="text-align:left;">
correction_design
</td>
<td style="text-align:left;">
hommel
</td>
<td style="text-align:left;">
1000
</td>
<td style="text-align:left;">
4.10
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.65)
</td>
</tr>
<tr>
<td style="text-align:left;">
correction_design
</td>
<td style="text-align:left;">
simulation
</td>
<td style="text-align:left;">
1000
</td>
<td style="text-align:left;">
5.20
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.69)
</td>
</tr>
</tbody>
</table>
</div>
<div id="references-10" class="section level3">
<h3><span class="header-section-number">18.5.4</span> References</h3>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="assign-over-vectors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inquiry-principles.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
