---
title: "Specifying the model"
output:
  html_document:
    toc: true
    toc_depth: 2
---

<!-- note do_bookdown is set in index.rmd, so we know if you are running just this .Rmd or compiling the book-->
```{r, eval = !exists("do_bookdown"), echo = FALSE, include = FALSE, purl = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, cache = FALSE)
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file()) # files are all relative to RStudio project home
```

```{r, eval = !exists("do_bookdown"), echo = FALSE, include = FALSE, purl = FALSE}
# load common packages, set ggplot ddtheme, etc.
source("scripts/before_chapter_script.R")
```

<!-- start post here, do not edit above -->

# Specifying the model

<!-- make sure to rename the section title below -->

```{r specifying_the_model, echo = FALSE, output = FALSE, purl = FALSE}
# run the diagnosis (set to TRUE) on your computer for this section only before pushing to Github. no diagnosis will ever take place on github.
do_diagnosis <- FALSE
sims <- 100
b_sims <- 20
```

```{r, echo = FALSE}
# load packages for this section here. note many (DD, tidyverse) are already available, see scripts/package-list.R
library(dagitty)
library(dddag)
library(ggraph)
```


intro 

## Two languages for defining causal models

### Directed acyclic graphs (nonparameteric structural causal models)

- a set of functionals that relate causal variables to each other
- graphical representation of NSCM is a DAG

useful for:
- defining how variables relate (and do not)
- clarifying what estimands can (and cannot) be identified using research

### Potential outcomes (parametric structural causal models)

we get a ton from nonparametric causal models, but in order to assess many properties of a research design we need to parameterize them. we need to specify the scales and probability distribution of exogenous variables and the functional forms of the endogenous variables (how they relate to parent variables). this will include definining expectations about effect sizes but also correlations between variables, intra-class correlations (ICCs), and interactions.

useful for:
- simulating data as it will actually be collected
- diagnosing properties of a research design such as bias and power

## What variables belong in the causal model?

- infinite variables out there in the world, we don't have time (or need) to specify them all
- we are going to select those that are relevant to defining I, D, and A
- for I, we will need the outcomes or potential outcomes that define average effects or average treatment effects
- for D, we will need all the variables that we use to stratify, block, cluster, and measure
- for A, we will need all the variables that we control for, use to calculate clustered standard errors, for poststratification and calculation of weights, and visualize our data
- there will be many factors that affect our outcomes and independent variables that we do not specify explicitly, and these will be included as "unknown heterogeneity" -- and we will have to specify the importance of these unknown factors
- some of these variables will be exogenous and endogenous, in Pearl's terms. by exogenous variables, he means variables without parents, no antecendent causes. by endogenous variables, he means those with parents, that are determined in part by earlier variables. endogenous variables are distinct from the problem of endogeneity, which comes from a single variable being a parent of both the treatment variable of interest and the outcome we wish to measure the causal effect of the treatment on. we will use it in Pearl's sense.

## What do we need to specify about these variables?



